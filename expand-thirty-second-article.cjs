const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandThirtySecondArticle() {
  try {
    console.log('ç¬¬32è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: imizu-city-sakura (å°„æ°´å¸‚ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰æ¡œå¹é›ª)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "imizu-city-sakura"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®æ¡œå¹é›ªã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å°„æ°´å¸‚ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã§ä½“é¨“ã—ãŸåœ§å·»ã®æ¡œå¹é›ªã€‚æ˜¥ã®è¨ªã‚Œã‚’å‘Šã’ã‚‹ç¾ã—ã„æ¡œã®èˆã„æ•£ã‚‹ç¬é–“ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®æ¡œã®é­…åŠ›ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-sakura-charm',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ãŒèª‡ã‚‹æ¡œã®åæ‰€ã¨ã—ã¦ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'sakura-charm-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã¯å°„æ°´å¸‚ãŒèª‡ã‚‹çœŒæ°‘å…¬åœ’ã¨ã—ã¦ã€æ˜¥ã®æ¡œã®å­£ç¯€ã«ã¯ç‰¹åˆ¥ãªç¾ã—ã•ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚åœ’å†…ã«ã¯æ•°ç™¾æœ¬ã®æ¡œã®æœ¨ãŒæ¤ãˆã‚‰ã‚Œã¦ãŠã‚Šã€å“ç¨®ã‚‚è±Šå¯Œã§é•·æœŸé–“ã«ã‚ãŸã£ã¦æ¡œã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚½ãƒ¡ã‚¤ãƒ¨ã‚·ãƒã‚’ä¸­å¿ƒã«ã€å…«é‡æ¡œã‚„æå‚ã‚Œæ¡œãªã©æ§˜ã€…ãªç¨®é¡ã®æ¡œãŒå’²ãèª‡ã‚Šã€è¨ªã‚Œã‚‹äººã€…ã®ç›®ã‚’æ¥½ã—ã¾ã›ã¦ã„ã¾ã™ã€‚åºƒå¤§ãªæ•·åœ°ã«ç‚¹åœ¨ã™ã‚‹æ¡œã¯ã€ãã‚Œãã‚ŒãŒç•°ãªã‚‹è¡¨æƒ…ã‚’è¦‹ã›ã€åœ’å†…ã®ã©ã“ã‚’æ­©ã„ã¦ã‚‚ç¾ã—ã„æ¡œé¢¨æ™¯ã«å‡ºä¼šã†ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰¹ã«æ¡œã®ãƒˆãƒ³ãƒãƒ«ã¨ãªã‚‹éŠæ­©é“ã¯ã€ã¾ã•ã«æ˜¥ã®çµ¶æ™¯ã‚¹ãƒãƒƒãƒˆã¨ã—ã¦å¤šãã®èŠ±è¦‹å®¢ã«æ„›ã•ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¡œå¹é›ªã®åœ§å·»ã®ç¬é–“ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-sakura-blizzard',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¯ã‚’ã®ã‚€ç¾ã—ã•ã®æ¡œå¹é›ªä½“é¨“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'sakura-blizzard-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã§ä½“é¨“ã—ãŸæ¡œå¹é›ªã¯ã€ã¾ã•ã«åœ§å·»ã®ç¾ã—ã•ã§ã—ãŸã€‚æº€é–‹ã‚’éããŸæ¡œã®èŠ±ã³ã‚‰ãŒé¢¨ã«èˆã„ã€ã¾ã‚‹ã§é›ªãŒé™ã‚‹ã‚ˆã†ã«ç©ºã‹ã‚‰èˆã„æ•£ã‚‹å…‰æ™¯ã¯ã€è‡ªç„¶ãŒä½œã‚Šå‡ºã™èŠ¸è¡“ä½œå“ãã®ã‚‚ã®ã§ã™ã€‚ç‰¹ã«é¢¨ã®å¼·ã„æ—¥ã«ã¯ã€ä¸€é¢ã«èŠ±ã³ã‚‰ãŒèˆã„è¸Šã‚Šã€å¹»æƒ³çš„ãªä¸–ç•Œã‚’æ¼”å‡ºã—ã¦ãã‚Œã¾ã™ã€‚æ­©ã„ã¦ã„ã‚‹ã ã‘ã§èŠ±ã³ã‚‰ãŒé ­ã‚„è‚©ã«é™ã‚Šã‹ã‹ã‚Šã€ã¾ã•ã«æ¡œã®ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’æµ´ã³ã¦ã„ã‚‹ã‚ˆã†ãªæ„Ÿè¦šã‚’å‘³ã‚ã†ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ç¬é–“ã¯å†™çœŸã‚„å‹•ç”»ã«åã‚ãŸããªã‚‹ç¾ã—ã•ã§ã™ãŒã€å®Ÿéš›ã«ãã®å ´ã«ã„ãªã„ã¨æ„Ÿã˜ã‚‹ã“ã¨ã®ã§ããªã„ç‰¹åˆ¥ãªä½“é¨“ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ˜¥ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®é­…åŠ›ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-spring-park',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ˜¥ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ãŒè¦‹ã›ã‚‹ç‰¹åˆ¥ãªè¡¨æƒ…', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'spring-park-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ˜¥ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã¯ã€æ¡œä»¥å¤–ã«ã‚‚æ§˜ã€…ãªé­…åŠ›ã«æº¢ã‚Œã¦ã„ã¾ã™ã€‚åœ’å†…ã®æ± ã«æ˜ ã‚‹æ¡œã®å§¿ã¯ç¾ã—ãã€æ°´é¢ã«æ•£ã£ãŸèŠ±ã³ã‚‰ãŒä½œã‚Šå‡ºã™è‡ªç„¶ã®ã‚¢ãƒ¼ãƒˆã‚‚è¦‹ã©ã“ã‚ã®ä¸€ã¤ã§ã™ã€‚æ–°ç·‘ã®èŠ½å¹ãã¨æ¡œã®ãƒ”ãƒ³ã‚¯ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯ã€æ˜¥ãªã‚‰ã§ã¯ã®è‰²å½©ç¾ã‚’æ¥½ã—ã¾ã›ã¦ãã‚Œã¾ã™ã€‚åœ’å†…ã‚’æ•£ç­–ã™ã‚‹å®¶æ—é€£ã‚Œã‚„ã‚«ãƒƒãƒ—ãƒ«ã€å†™çœŸæ„›å¥½å®¶ãªã©ã€å¤šãã®äººã€…ãŒæ˜¥ã®è¨ªã‚Œã‚’æº€å–«ã—ã¦ã„ã¾ã™ã€‚èŠç”Ÿåºƒå ´ã§ã¯èŠ±è¦‹ã‚’æ¥½ã—ã‚€ã‚°ãƒ«ãƒ¼ãƒ—ã‚‚å¤šãã€ç©ã‚„ã‹ãªæ˜¥ã®ä¸€æ—¥ã‚’éã”ã™ã«ã¯æœ€é©ãªç’°å¢ƒãŒæ•´ã£ã¦ã„ã¾ã™ã€‚é³¥ãŸã¡ã®ã•ãˆãšã‚Šã‚‚èã“ãˆã€äº”æ„Ÿã§æ˜¥ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã‚‹ç‰¹åˆ¥ãªå ´æ‰€ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: èŠ±è¦‹ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-hanami-tips',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã§ã®èŠ±è¦‹ã‚’æœ€å¤§é™æ¥½ã—ã‚€ã‚³ãƒ„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'hanami-tips-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã§èŠ±è¦‹ã‚’æ¥½ã—ã‚€ãªã‚‰ã€æ¡œã®é–‹èŠ±çŠ¶æ³ã‚’äº‹å‰ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ã€‚æº€é–‹ã®æ™‚æœŸã ã‘ã§ãªãã€æ•£ã‚Šå§‹ã‚ã®æ¡œå¹é›ªã‚‚ç¾ã—ã„ã®ã§ã€å°‘ã—é…ã‚ã®æ™‚æœŸã§ã‚‚ååˆ†ã«æ¥½ã—ã‚ã¾ã™ã€‚åœ’å†…ã«ã¯ãƒ™ãƒ³ãƒã‚„ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¨­ç½®ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãŠå¼å½“ã‚’æŒå‚ã—ã¦ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯ã‚‚å¯èƒ½ã§ã™ã€‚é§è»Šå ´ã¯æ¡œã®å­£ç¯€ã«ã¯æ··é›‘ã™ã‚‹ãŸã‚ã€æ—©ã‚ã®æ™‚é–“å¸¯ã§ã®è¨ªå•ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚å†™çœŸæ’®å½±ã‚’ã™ã‚‹å ´åˆã¯ã€é€†å…‰ã‚’åˆ©ç”¨ã—ãŸèŠ±ã³ã‚‰ã®é€ã‘æ„Ÿã‚„ã€æ± ã«æ˜ ã‚‹æ¡œã®æ’®å½±ãªã©ãŒç‰¹ã«ç¾ã—ã„ä»•ä¸ŠãŒã‚Šã«ãªã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å­£ç¯€ã®ç§»ã‚ã„ã¨è‡ªç„¶ã®ç¾ã—ã•ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-seasonal-beauty',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¡œãŒæ•™ãˆã¦ãã‚Œã‚‹å­£ç¯€ã®ç§»ã‚ã„ã®ç¾å­¦', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'seasonal-beauty-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®æ¡œå¹é›ªã¯ã€æ—¥æœ¬ã®ç¾æ„è­˜ã§ã‚ã‚‹ã€Œã‚‚ã®ã®ã‚ã¯ã‚Œã€ã‚’ä½“ç¾ã—ã¦ã„ã‚‹å…‰æ™¯ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚æº€é–‹ã®ç¾ã—ã•ã‹ã‚‰æ•£ã‚Šã‚†ãå„šã•ã¾ã§ã€æ¡œã¯å­£ç¯€ã®ç§»ã‚ã„ã®ç¾ã—ã•ã‚’ç§ãŸã¡ã«æ•™ãˆã¦ãã‚Œã¾ã™ã€‚æ•£ã£ãŸèŠ±ã³ã‚‰ãŒåœ°é¢ã‚’è¦†ã„å°½ãã™æ¡œã®çµ¨æ¯¯ã‚‚ã€ã¾ãŸåˆ¥ã®ç¾ã—ã•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®çŸ­ã„æ˜¥ã®æœŸé–“ã«ã—ã‹è¦‹ã‚‹ã“ã¨ã®ã§ããªã„ç‰¹åˆ¥ãªå…‰æ™¯ã¯ã€è‡ªç„¶ãŒä¸ãˆã¦ãã‚Œã‚‹è´ˆã‚Šç‰©ã¨ã„ãˆã‚‹ã§ã—ã‚‡ã†ã€‚æ¯å¹´å¤‰ã‚ã‚‰ãšã«å’²ãã€ãã—ã¦æ•£ã£ã¦ã„ãæ¡œã®å–¶ã¿ã«ã€ç”Ÿå‘½ã®å°Šã•ã¨ç¾ã—ã•ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å°„æ°´å¸‚ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®æ¡œå¹é›ªã¯ã€æ˜¥ã®è¨ªã‚Œã‚’å‘Šã’ã‚‹ç¾ã—ã„è‡ªç„¶ã®èŠ¸è¡“ä½œå“ã§ã™ã€‚ã“ã®æ„Ÿå‹•çš„ãªç¬é–“ã‚’ãœã²ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬32è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 122æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandThirtySecondArticle();
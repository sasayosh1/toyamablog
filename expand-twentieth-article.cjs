const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentiethArticle() {
  try {
    console.log('ç¬¬20è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: toyama-city-sakura-19 (æ°—æ¸©19â„ƒã®æ¡œã¨ãƒãƒ«ãƒ¼ãƒˆ)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "toyama-city-sakura-19"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€æ¡œã¨ãƒãƒ«ãƒ¼ãƒˆã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ°—æ¸©19â„ƒã®ç©ã‚„ã‹ãªæ˜¥ã®æ—¥ã€‚å¯Œå±±å¸‚ã§å‡ºä¼šã£ãŸç¾ã—ã„æ¡œã¨ãƒãƒ«ãƒ¼ãƒˆï¼ˆå¯Œå±±å¸‚å†…å¾ªç’°ãƒã‚¹ï¼‰ã®ç´ æ•µãªã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãŠå±Šã‘ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ˜¥ã®å¯Œå±±å¸‚ã®é­…åŠ›ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-spring',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ°—æ¸©19â„ƒãŒç”Ÿã¿å‡ºã™æ˜¥ã®å¯Œå±±å¸‚ã®ç¾ã—ã•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'spring-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ°—æ¸©19â„ƒã¨ã„ã†çµ¶å¦™ãªæš–ã‹ã•ã¯ã€æ˜¥ã®å¯Œå±±å¸‚ã‚’æœ€ã‚‚ç¾ã—ãå½©ã‚‹æ¡ä»¶ã®ä¸€ã¤ã§ã™ã€‚ã“ã®æ¸©åº¦ã¯æ¡œã®èŠ±ã³ã‚‰ãŒé¢¨ã«èˆã†ã®ã«æœ€é©ã§ã€è¡—å…¨ä½“ãŒå„ªé›…ã§ç©ã‚„ã‹ãªé›°å›²æ°—ã«åŒ…ã¾ã‚Œã¾ã™ã€‚å¯Œå±±å¸‚ã®è¡—ä¸¦ã¿ã¯ç«‹å±±é€£å³°ã‚’èƒŒæ™¯ã«ã€æ¡œä¸¦æœ¨ãŒç¹”ã‚Šãªã™ãƒ”ãƒ³ã‚¯ã®çµ¨æ¯¯ãŒåºƒãŒã‚Šã¾ã™ã€‚ã“ã®å­£ç¯€ã®å¯Œå±±å¸‚ã¯ã€éƒ½å¸‚éƒ¨ã®ä¾¿åˆ©ã•ã¨è‡ªç„¶ã®ç¾ã—ã•ãŒè¦‹äº‹ã«èª¿å’Œã—ãŸã€æ—¥æœ¬ã®æ˜¥ã®ä»£è¡¨çš„ãªé¢¨æ™¯ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚åœ°å…ƒã®äººã€…ã‚‚è¦³å…‰å®¢ã‚‚ã€ã“ã®ç‰¹åˆ¥ãªå­£ç¯€ã®é­…åŠ›ã«å¿ƒã‚’å¥ªã‚ã‚Œã‚‹ã“ã¨ã§ã—ã‚‡ã†ã€‚é’ç©ºã¨æ¡œã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯ã€å†™çœŸã«åã‚ãŸããªã‚‹çµ¶æ™¯ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¡œã®è¦‹ã©ã“ã‚ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-sakura',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¯Œå±±å¸‚å†…ã®æ¡œã‚¹ãƒãƒƒãƒˆã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'sakura-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¯Œå±±å¸‚å†…ã«ã¯æ•°å¤šãã®ç¾ã—ã„æ¡œã‚¹ãƒãƒƒãƒˆãŒç‚¹åœ¨ã—ã¦ãŠã‚Šã€ãã‚Œãã‚Œç‹¬ç‰¹ã®é­…åŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚åŸå—å…¬åœ’ã‚„å¯Œå±±åŸå€å…¬åœ’ãªã©ã®æœ‰åã‚¹ãƒãƒƒãƒˆã‹ã‚‰ã€è¡—è·¯æ¨¹ã¨ã—ã¦æ¤ãˆã‚‰ã‚ŒãŸæ¡œã¾ã§ã€å¸‚å†…ã®ã‚ã¡ã“ã¡ã§æ˜¥ã®è¨ªã‚Œã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰¹ã«å¸‚é›»ã‚„ãƒã‚¹è·¯ç·šæ²¿ã„ã®æ¡œä¸¦æœ¨ã¯ã€ç§»å‹•ã—ãªãŒã‚‰èŠ±è¦‹ã‚’æ¥½ã—ã‚ã‚‹è´…æ²¢ãªä½“é¨“ã§ã™ã€‚æ¡œã®ç¨®é¡ã‚‚è±Šå¯Œã§ã€ã‚½ãƒ¡ã‚¤ãƒ¨ã‚·ãƒã‚’ä¸­å¿ƒã«ã€å…«é‡æ¡œã‚„å±±æ¡œãªã©æ§˜ã€…ãªå“ç¨®ãŒæ™‚æœŸã‚’ãšã‚‰ã—ã¦å’²ãã€é•·æœŸé–“ã«ã‚ãŸã£ã¦æ¡œã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚åœ°å…ƒã®äººã€…ã«ã¨ã£ã¦ã‚‚è¦³å…‰å®¢ã«ã¨ã£ã¦ã‚‚ã€æ˜¥ã®å¯Œå±±è¦³å…‰ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ãƒãƒ«ãƒ¼ãƒˆã®é­…åŠ›ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-maloot',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒãƒ«ãƒ¼ãƒˆï¼ˆå¯Œå±±å¸‚å†…å¾ªç’°ãƒã‚¹ï¼‰ã®ä¾¿åˆ©ã•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'maloot-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒãƒ«ãƒ¼ãƒˆã¯å¯Œå±±å¸‚å†…ã‚’åŠ¹ç‡ã‚ˆãç§»å‹•ã§ãã‚‹å¾ªç’°ãƒã‚¹ã‚·ã‚¹ãƒ†ãƒ ã§ã€è¦³å…‰å®¢ã«ã¨ã£ã¦éå¸¸ã«ä¾¿åˆ©ãªäº¤é€šæ‰‹æ®µã§ã™ã€‚å¸‚å†…ã®ä¸»è¦ãªè¦³å…‰ã‚¹ãƒãƒƒãƒˆã‚„å•†æ¥­æ–½è¨­ã‚’çµã‚“ã§ãŠã‚Šã€ä¸€æ—¥ä¹—è»Šåˆ¸ã‚’åˆ©ç”¨ã™ã‚Œã°çµŒæ¸ˆçš„ã«å¸‚å†…è¦³å…‰ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒã‚¹ã®è»Šçª“ã‹ã‚‰ã¯å››å­£æŠ˜ã€…ã®å¯Œå±±å¸‚ã®é¢¨æ™¯ã‚’çœºã‚ã‚‹ã“ã¨ãŒã§ãã€ç‰¹ã«æ˜¥ã®æ¡œã®å­£ç¯€ã«ã¯ç§»å‹•ãã®ã‚‚ã®ãŒè¦³å…‰ä½“é¨“ã¨ãªã‚Šã¾ã™ã€‚é‹è»¢æ‰‹ã•ã‚“ã‚‚è¦ªåˆ‡ã§ã€åœ°å…ƒã®æƒ…å ±ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚è»Šã‚’æŒãŸãªã„è¦³å…‰å®¢ã‚„é«˜é½¢è€…ã«ã¨ã£ã¦ã€ãƒãƒ«ãƒ¼ãƒˆã¯å¯Œå±±è¦³å…‰ã‚’å¿«é©ã«ã™ã‚‹é‡è¦ãªã‚¤ãƒ³ãƒ•ãƒ©ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¡œã¨ãƒãƒ«ãƒ¼ãƒˆã®ç´ æ•µãªçµ„ã¿åˆã‚ã›ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-combination',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¡œã¨ãƒãƒ«ãƒ¼ãƒˆãŒç¹”ã‚Šãªã™æ˜¥ã®é¢¨æ™¯', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'combination-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ˜¥ã®å¯Œå±±å¸‚ã§ã¯ã€æ¡œä¸¦æœ¨ã®é–“ã‚’èµ°ã‚‹ãƒãƒ«ãƒ¼ãƒˆã®å§¿ãŒç‰¹ã«ç¾ã—ã„å…‰æ™¯ã‚’ä½œã‚Šå‡ºã—ã¾ã™ã€‚ãƒ”ãƒ³ã‚¯ã®èŠ±ã³ã‚‰ãŒèˆã„æ•£ã‚‹ä¸­ã‚’ã‚†ã£ãã‚Šã¨èµ°ã‚‹ãƒã‚¹ã¯ã€ã¾ã‚‹ã§å‹•ãçµµç”»ã®ã‚ˆã†ã§ã™ã€‚ãƒã‚¹åœã§æ¡œã‚’èƒŒæ™¯ã«å¾…ã¤äººã€…ã®å§¿ã‚‚ã€æ—¥å¸¸ã®ä¸­ã«æº¶ã‘è¾¼ã‚“ã æ˜¥ã®è©©æƒ…ã‚’æ„Ÿã˜ã•ã›ã¾ã™ã€‚è»Šçª“ã‹ã‚‰è¦‹ã‚‹æ¡œä¸¦æœ¨ã¯ã€æ­©ã„ã¦è¦‹ã‚‹æ¡œã¨ã¯ã¾ãŸé•ã£ãŸç¾ã—ã•ãŒã‚ã‚Šã€ç§»å‹•æ™‚é–“ã‚‚æ¥½ã—ã„è¦³å…‰ä½“é¨“ã«ãªã‚Šã¾ã™ã€‚åœ°å…ƒã®äººã€…ã®æ—¥å¸¸ç”Ÿæ´»ã«æ¡œãŒè‡ªç„¶ã«æº¶ã‘è¾¼ã‚“ã§ã„ã‚‹æ§˜å­ã¯ã€å¯Œå±±ã®æ˜¥ã®é­…åŠ›ã‚’ç‰©èªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ˜¥ã®å¯Œå±±è¦³å…‰ã®ã™ã™ã‚ï¼ˆç´„125æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tourism',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ˜¥ã®å¯Œå±±è¦³å…‰ã‚’æœ€å¤§é™æ¥½ã—ã‚€ã‚³ãƒ„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tourism-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ˜¥ã®å¯Œå±±å¸‚ã‚’è¨ªã‚Œã‚‹éš›ã¯ã€ãƒãƒ«ãƒ¼ãƒˆã‚’æ´»ç”¨ã—ãŸæ¡œå·¡ã‚ŠãŒãŠã™ã™ã‚ã§ã™ã€‚ä¸€æ—¥ä¹—è»Šåˆ¸ã‚’è³¼å…¥ã—ã¦ã€æ°—ã«ãªã‚‹æ¡œã‚¹ãƒãƒƒãƒˆã§è‡ªç”±ã«ä¹—ã‚Šé™ã‚Šã—ãªãŒã‚‰èŠ±è¦‹ã‚’æ¥½ã—ã‚ã¾ã™ã€‚ã‚«ãƒ¡ãƒ©ã‚’æŒå‚ã—ã¦ã€ãƒã‚¹ã¨æ¡œã®ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å†™çœŸã‚’æ’®å½±ã™ã‚‹ã®ã‚‚æ¥½ã—ã„æ€ã„å‡ºã«ãªã‚Šã¾ã™ã€‚æ°—æ¸©19â„ƒå‰å¾Œã®æš–ã‹ã„æ—¥ã‚’é¸ã‚“ã§è¨ªã‚Œã‚‹ã¨ã€ã‚ˆã‚Šå¿«é©ã«è¦³å…‰ã‚’æ¥½ã—ã‚ã¾ã™ã€‚åœ°å…ƒã®ã‚°ãƒ«ãƒ¡ã‚¹ãƒãƒƒãƒˆã«ã‚‚ç«‹ã¡å¯„ã‚ŠãªãŒã‚‰ã€æ˜¥ã®å¯Œå±±ã‚’æº€å–«ã—ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ°—æ¸©19â„ƒã®æ˜¥ã®æ—¥ã«å‡ºä¼šã†æ¡œã¨ãƒãƒ«ãƒ¼ãƒˆã®é¢¨æ™¯ã¯ã€å¯Œå±±å¸‚ã®é­…åŠ›ã‚’è±¡å¾´ã™ã‚‹ç¾ã—ã„å…‰æ™¯ã§ã™ã€‚æ˜¥ã®å¯Œå±±è¦³å…‰ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬20è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 180æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentiethArticle();
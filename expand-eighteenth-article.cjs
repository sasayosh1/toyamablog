const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandEighteenthArticle() {
  try {
    console.log('ç¬¬18è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: imizu-city-4 (å¤œã®æµ·ç‹ä¸¸)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "imizu-city-4"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€å¤œã®æµ·ç‹ä¸¸ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å°„æ°´å¸‚ã®æµ·ç‹ä¸¸ãƒ‘ãƒ¼ã‚¯ã«ãã³ãˆç«‹ã¤å¸†èˆ¹æµ·ç‹ä¸¸ã€‚å¤œé–“ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã•ã‚ŒãŸç´”ç™½ã®èˆ¹ä½“ã¨4æœ¬ã®ãƒã‚¹ãƒˆã¯ã€ã¾ã•ã«ã€Œæµ·ã®è²´å©¦äººã€ã®åã«ãµã•ã‚ã—ã„ç¾ã—ã•ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æµ·ç‹ä¸¸ã®æ­´å²ã¨æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-history',
        style: 'h2',
        children: [{ _type: 'span', text: 'æµ·ã®è²´å©¦äººã€Œå¸†èˆ¹æµ·ç‹ä¸¸ã€ã®æ­´å²', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'history-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¸†èˆ¹æµ·ç‹ä¸¸ã¯1930å¹´ã«å»ºé€ ã•ã‚ŒãŸç·´ç¿’å¸†èˆ¹ã§ã€é•·å¹´ã«ã‚ãŸã£ã¦æµ·æŠ€è€…ã®è‚²æˆã«è²¢çŒ®ã—ã¦ãã¾ã—ãŸã€‚å…¨é•·107ãƒ¡ãƒ¼ãƒˆãƒ«ã€4æœ¬ã®ãƒã‚¹ãƒˆã‚’æŒã¤ãƒãƒ¼ã‚¯å‹å¸†èˆ¹ã¨ã—ã¦è¨­è¨ˆã•ã‚Œã€ãã®ç¾ã—ã„èˆ¹å½±ã‹ã‚‰ã€Œæµ·ã®è²´å©¦äººã€ã¨ã„ã†æ„›ç§°ã§è¦ªã—ã¾ã‚Œã¦ã„ã¾ã™ã€‚1989å¹´ã«ç¾å½¹ã‚’å¼•é€€ã—ãŸå¾Œã€å°„æ°´å¸‚ã®æµ·ç‹ä¸¸ãƒ‘ãƒ¼ã‚¯ã«æ°¸ä¹…ä¿å­˜ã•ã‚Œã€ç¾åœ¨ã¯æµ·äº‹åšç‰©é¤¨ã¨ã—ã¦å¤šãã®äººã€…ã«æµ·äº‹æ•™è‚²ã¨æ„Ÿå‹•ã‚’æä¾›ã—ç¶šã‘ã¦ã„ã¾ã™ã€‚ç´”ç™½ã«å¡—è£…ã•ã‚ŒãŸèˆ¹ä½“ã¯ã€æ™‚ä»£ã‚’è¶…ãˆã¦äººã€…ã‚’é­…äº†ã™ã‚‹æ°—å“ã¨å¨å³ã‚’ä¿ã£ã¦ãŠã‚Šã€å°„æ°´å¸‚ã®ã‚·ãƒ³ãƒœãƒ«çš„å­˜åœ¨ã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å¤œé–“ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã®é­…åŠ›ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-lighting',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¹»æƒ³çš„ãªå¤œé–“ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã®ç¾ã—ã•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'lighting-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤œã®æµ·ç‹ä¸¸ã®æœ€å¤§ã®é­…åŠ›ã¯ã€èˆ¹ä½“å…¨ä½“ã‚’ç…§ã‚‰ã™ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã§ã™ã€‚ç´”ç™½ã®èˆ¹ä½“ã¨4æœ¬ã®ãƒã‚¹ãƒˆãŒæš–è‰²ç³»ã®å…‰ã«åŒ…ã¾ã‚Œã‚‹æ§˜å­ã¯ã€ã¾ã•ã«å¹»æƒ³çš„ãªç¾ã—ã•ã‚’æ¼”å‡ºã—ã¾ã™ã€‚æ—¥ä¸­ã®åŠ›å¼·ã„å°è±¡ã¨ã¯ç•°ãªã‚Šã€å¤œã®æµ·ç‹ä¸¸ã¯å„ªé›…ã§ç¥ç§˜çš„ãªé›°å›²æ°—ã«åŒ…ã¾ã‚Œã¾ã™ã€‚å‘¨å›²ã®é™ã‹ãªæµ·é¢ã«åå°„ã™ã‚‹èˆ¹å½±ã‚‚ç¾ã—ãã€å†™çœŸæ’®å½±ã‚¹ãƒãƒƒãƒˆã¨ã—ã¦ã‚‚éå¸¸ã«äººæ°—ãŒã‚ã‚Šã¾ã™ã€‚ç‰¹ã«å¤•æš®ã‚Œã‹ã‚‰å¤œã«ã‹ã‘ã¦ã®æ™‚é–“å¸¯ã¯ã€ç©ºã®è‰²ã®å¤‰åŒ–ã¨å…±ã«èˆ¹ã®è¡¨æƒ…ã‚‚å¤‰ã‚ã‚Šã€è¨ªã‚Œã‚‹äººã€…ã«æ„Ÿå‹•çš„ãªä½“é¨“ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æµ·ç‹ä¸¸ãƒ‘ãƒ¼ã‚¯ã®é­…åŠ›ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-park',
        style: 'h2',
        children: [{ _type: 'span', text: 'æµ·ç‹ä¸¸ãƒ‘ãƒ¼ã‚¯ã®ç·åˆçš„ãªé­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'park-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æµ·ç‹ä¸¸ãƒ‘ãƒ¼ã‚¯ã¯å¸†èˆ¹æµ·ç‹ä¸¸ã‚’ä¸­å¿ƒã¨ã—ãŸç·åˆçš„ãªæµ·äº‹ãƒ†ãƒ¼ãƒãƒ‘ãƒ¼ã‚¯ã§ã™ã€‚æµ·ç‹ä¸¸ã®èˆ¹å†…è¦‹å­¦ã§ã¯ã€å®Ÿéš›ã®èˆ¹å“¡ã®ç”Ÿæ´»ç©ºé–“ã‚„æ“èˆ¹è¨­å‚™ã‚’ä½“é¨“ã§ãã€æµ·äº‹ã®æ­´å²ã¨æŠ€è¡“ã«ã¤ã„ã¦å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€å‘¨è¾ºã«ã¯åºƒã„èŠç”Ÿåºƒå ´ã‚„éŠæ­©é“ãŒæ•´å‚™ã•ã‚Œã¦ãŠã‚Šã€å®¶æ—é€£ã‚Œã§ã‚†ã£ãã‚Šã¨éã”ã›ã‚‹ç’°å¢ƒãŒæ•´ã£ã¦ã„ã¾ã™ã€‚å£²åº—ã‚„ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚‚ã‚ã‚Šã€å¯Œå±±æ¹¾ã‚’çœºã‚ãªãŒã‚‰é£Ÿäº‹ã‚’æ¥½ã—ã‚€ã“ã¨ã‚‚ã§ãã¾ã™ã€‚å¹´é–“ã‚’é€šã˜ã¦æ§˜ã€…ãªã‚¤ãƒ™ãƒ³ãƒˆã‚‚é–‹å‚¬ã•ã‚Œã€åœ°åŸŸã®æ–‡åŒ–çš„ãªä¸­å¿ƒåœ°ã¨ã—ã¦ã‚‚æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å¯Œå±±æ¹¾ã®çµ¶æ™¯ï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-view',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¯Œå±±æ¹¾ã¨ç«‹å±±é€£å³°ã®çµ¶æ™¯', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'view-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æµ·ç‹ä¸¸ãƒ‘ãƒ¼ã‚¯ã‹ã‚‰ã¯å¯Œå±±æ¹¾ã®ç¾ã—ã„æ™¯è‰²ã‚’ä¸€æœ›ã™ã‚‹ã“ã¨ãŒã§ãã€æ™´ã‚ŒãŸæ—¥ã«ã¯é›„å¤§ãªç«‹å±±é€£å³°ã‚’èƒŒæ™¯ã«ã—ãŸçµ¶æ™¯ã‚’æ¥½ã—ã‚ã¾ã™ã€‚æµ·ã¨å±±ã¨ã„ã†å¯Œå±±çœŒãªã‚‰ã§ã¯ã®è‡ªç„¶ã®æµã¿ã‚’åŒæ™‚ã«æ„Ÿã˜ã‚‰ã‚Œã‚‹è´…æ²¢ãªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚å¤œé–“ã«ã¯å¯¾å²¸ã®å¤œæ™¯ã‚‚ç¾ã—ãã€ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã•ã‚ŒãŸæµ·ç‹ä¸¸ã¨å…±ã«ç´ æ™´ã‚‰ã—ã„æ™¯è¦³ã‚’ä½œã‚Šå‡ºã—ã¾ã™ã€‚å››å­£ã‚’é€šã˜ã¦ç•°ãªã‚‹è¡¨æƒ…ã‚’è¦‹ã›ã‚‹å¯Œå±±æ¹¾ã¨æµ·ç‹ä¸¸ã®çµ„ã¿åˆã‚ã›ã¯ã€ä½•åº¦è¨ªã‚Œã¦ã‚‚æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ’®å½±ã‚¹ãƒãƒƒãƒˆã¨ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-access',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ’®å½±ã‚¹ãƒãƒƒãƒˆã¨ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'access-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤œã®æµ·ç‹ä¸¸ã¯å†™çœŸæ„›å¥½å®¶ã«ã¨ã£ã¦çµ¶å¥½ã®æ’®å½±ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚æ§˜ã€…ãªè§’åº¦ã‹ã‚‰èˆ¹ã‚’æ’®å½±ã§ãã€ç‰¹ã«æ°´é¢ã¸ã®åå°„ã‚’å«ã‚ãŸæ§‹å›³ã¯å°è±¡çš„ãªä½œå“ã«ãªã‚Šã¾ã™ã€‚ã‚¢ã‚¯ã‚»ã‚¹ã¯ä¸‡è‘‰ç·šã®æµ·ç‹ä¸¸é§…ã‹ã‚‰å¾’æ­©ã™ãã¨ä¾¿åˆ©ã§ã€è»Šã§ã®æ¥åœ’ã‚‚å¯èƒ½ã§ã™ã€‚é§è»Šå ´ã‚‚å®Œå‚™ã•ã‚Œã¦ãŠã‚Šã€å¤œé–“ã§ã‚‚å®‰å¿ƒã—ã¦è¦‹å­¦ã§ãã¾ã™ã€‚ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—æ™‚é–“ã¯å­£ç¯€ã«ã‚ˆã£ã¦ç•°ãªã‚‹ãŸã‚ã€äº‹å‰ã«ç¢ºèªã—ã¦ã‹ã‚‰è¨ªå•ã•ã‚Œã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤œã®æµ·ç‹ä¸¸ã¯å°„æ°´å¸‚ãŒèª‡ã‚‹ç¾ã—ã„å¤œæ™¯ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚å¹»æƒ³çš„ã«ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã•ã‚ŒãŸæµ·ã®è²´å©¦äººã®å§¿ã‚’ãœã²ä¸€åº¦ã”è¦§ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬18è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 176æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandEighteenthArticle();
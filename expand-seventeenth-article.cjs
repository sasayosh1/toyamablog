const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandSeventeenthArticle() {
  try {
    console.log('ç¬¬17è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: fuchu-town-1 (ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "fuchu-town-1"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å©¦ä¸­ç”ºã«ã‚ã‚‹ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’ã¯ã€å‹•æ¤ç‰©ã‚’ç„¡æ–™ã§æ¥½ã—ã‚ã‚‹å®¶æ—é€£ã‚Œã«å¤§äººæ°—ã®è¾²åœ’ã§ã™ã€‚è‡ªç„¶ã¨ã®è§¦ã‚Œåˆã„ãŒæº€å–«ã§ãã‚‹éš ã‚ŒãŸã‚¹ãƒãƒƒãƒˆã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¾²åœ’ã®æ¦‚è¦ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-overview',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’ã®é­…åŠ›ã¨ã‚³ãƒ³ã‚»ãƒ—ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'overview-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’ã¯å©¦ä¸­ç”ºã§é•·å¹´æ„›ã•ã‚Œç¶šã‘ã¦ã„ã‚‹ä½“é¨“å‹è¾²åœ’æ–½è¨­ã§ã™ã€‚æ–°é®®ãªåµã®ç”Ÿç”£ã‚’è¡Œã„ãªãŒã‚‰ã€è¨ªã‚Œã‚‹äººã€…ã«è¾²æ¥­ã‚„å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ã‚’é€šã˜ã¦è‡ªç„¶ã®å¤§åˆ‡ã•ã‚’ä¼ãˆã¦ã„ã¾ã™ã€‚ä½•ã‚ˆã‚Šç´ æ™´ã‚‰ã—ã„ã®ã¯ã€å¤šãã®ä½“é¨“ãŒç„¡æ–™ã§æ¥½ã—ã‚ã‚‹ã“ã¨ã§ã™ã€‚éƒ½å¸‚éƒ¨ã§ã¯å‘³ã‚ãˆãªã„æœ¬ç‰©ã®è¾²æ‘ä½“é¨“ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€ç‰¹ã«å­ã©ã‚‚ãŸã¡ã®æ•™è‚²ã®å ´ã¨ã—ã¦ã‚‚é«˜ã„è©•ä¾¡ã‚’å—ã‘ã¦ã„ã¾ã™ã€‚å®¶æ—ã§ä¸€æ—¥ä¸­æ¥½ã—ã‚ã‚‹å†…å®¹ã®æ¿ƒã„æ–½è¨­ã¨ã—ã¦ã€åœ°å…ƒã ã‘ã§ãªãé æ–¹ã‹ã‚‰ã‚‚å¤šãã®å®¶æ—é€£ã‚ŒãŒè¨ªã‚Œã‚‹äººæ°—ã‚¹ãƒãƒƒãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-animals',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ§˜ã€…ãªå‹•ç‰©ãŸã¡ã¨ã®æ¥½ã—ã„è§¦ã‚Œåˆã„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'animals-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'è¾²åœ’ã«ã¯é¶ã‚’ã¯ã˜ã‚ã€ãƒ¤ã‚®ã€ã‚¦ã‚µã‚®ã€ã‚¢ãƒ’ãƒ«ãªã©æ§˜ã€…ãªå‹•ç‰©ãŸã¡ãŒé£¼è‚²ã•ã‚Œã¦ãŠã‚Šã€é–“è¿‘ã§è¦³å¯Ÿã—ãŸã‚Šè§¦ã‚Œåˆã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰¹ã«å­ã©ã‚‚ãŸã¡ã«äººæ°—ãªã®ãŒé¤Œã‚„ã‚Šä½“é¨“ã§ã€å‹•ç‰©ãŸã¡ã®æ¸©ã‹ã•ã‚„å¯æ„›ã‚‰ã—ã•ã‚’ç›´æ¥æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å‹•ç‰©ãŸã¡ã¯ã©ã‚Œã‚‚äººæ‡ã£ã“ãã€å®‰å…¨ã«é…æ…®ã•ã‚ŒãŸç’°å¢ƒã§è‡ªç”±ã«è§¦ã‚Œåˆãˆã‚‹ãŸã‚ã€å°ã•ãªãŠå­æ§˜ã§ã‚‚å®‰å¿ƒã§ã™ã€‚éƒ½å¸‚éƒ¨ã§ã¯æ»…å¤šã«ä½“é¨“ã§ããªã„æœ¬ç‰©ã®å‹•ç‰©ã¨ã®äº¤æµã¯ã€å­ã©ã‚‚ãŸã¡ã®å¿ƒã«æ·±ã„å°è±¡ã‚’æ®‹ã—ã€å‘½ã®å¤§åˆ‡ã•ã‚’å­¦ã¶è²´é‡ãªæ©Ÿä¼šã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¾²æ¥­ä½“é¨“ã¨å­¦ç¿’ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-experience',
        style: 'h2',
        children: [{ _type: 'span', text: 'æœ¬æ ¼çš„ãªè¾²æ¥­ä½“é¨“ã¨å­¦ç¿’æ©Ÿä¼š', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'experience-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç”°æ‘è¾²åœ’ã§ã¯å­£ç¯€ã«å¿œã˜ãŸè¾²æ¥­ä½“é¨“ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€é‡èœã®ç¨®ã¾ãã‹ã‚‰åç©«ã¾ã§ä¸€é€£ã®è¾²ä½œæ¥­ã‚’ä½“é¨“ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ–°é®®ãªåµã‚’ç”£ã‚€é¶ã®é£¼è‚²ç¾å ´ã‚‚è¦‹å­¦ã§ãã€é£Ÿã¹ç‰©ãŒã©ã®ã‚ˆã†ã«ä½œã‚‰ã‚Œã‚‹ã‹ã‚’å®Ÿéš›ã«å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚è¾²åœ’ã®ã‚¹ã‚¿ãƒƒãƒ•ã®æ–¹ã€…ãŒä¸å¯§ã«èª¬æ˜ã—ã¦ãã ã•ã‚‹ã®ã§ã€è¾²æ¥­ã«ã¤ã„ã¦è©³ã—ãçŸ¥ã‚‰ãªã„æ–¹ã§ã‚‚å®‰å¿ƒã—ã¦å‚åŠ ã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ä½“é¨“ã‚’é€šã˜ã¦ã€é£Ÿã¹ç‰©ã¸ã®æ„Ÿè¬ã®æ°—æŒã¡ã‚„è‡ªç„¶ç’°å¢ƒã®å¤§åˆ‡ã•ã‚’å®Ÿæ„Ÿã™ã‚‹ã“ã¨ãŒã§ãã‚‹æ•™è‚²çš„ä¾¡å€¤ã®é«˜ã„æ–½è¨­ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å®¶æ—é€£ã‚Œã«å„ªã—ã„ç’°å¢ƒï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-family',
        style: 'h2',
        children: [{ _type: 'span', text: 'å®¶æ—é€£ã‚Œã«é…æ…®ã—ãŸè¨­å‚™ã¨ç’°å¢ƒ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'family-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç”°æ‘è¾²åœ’ã¯å®¶æ—é€£ã‚Œã§ã®è¨ªå•ã‚’å‰æã¨ã—ãŸè¨­å‚™ãŒå……å®Ÿã—ã¦ã„ã¾ã™ã€‚ä¼‘æ†©ã‚¹ãƒšãƒ¼ã‚¹ã‚„ãƒ™ãƒ³ãƒãŒé©æ‰€ã«é…ç½®ã•ã‚Œã¦ãŠã‚Šã€å°ã•ãªãŠå­æ§˜é€£ã‚Œã§ã‚‚ã‚†ã£ãã‚Šã¨éã”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€æ‰‹æ´—ã„å ´ãªã©ã‚‚å®Œå‚™ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å‹•ç‰©ã¨è§¦ã‚Œåˆã£ãŸå¾Œã‚‚å®‰å¿ƒã§ã™ã€‚é§è»Šå ´ã‚‚ååˆ†ã«ç¢ºä¿ã•ã‚Œã¦ãŠã‚Šã€è»Šã§ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚ä¾¿åˆ©ã§ã™ã€‚ä½•ã‚ˆã‚Šç„¡æ–™ã§æ¥½ã—ã‚ã‚‹ã¨ã„ã†ç‚¹ãŒå®¶è¨ˆã«å„ªã—ãã€æ°—è»½ã«ä½•åº¦ã§ã‚‚è¨ªã‚Œã‚‹ã“ã¨ãŒã§ãã‚‹ã®ãŒå¤§ããªé­…åŠ›ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚¢ã‚¯ã‚»ã‚¹ã¨åˆ©ç”¨æƒ…å ±ï¼ˆç´„125æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-access',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±ã¨åˆ©ç”¨ã®ã‚³ãƒ„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'access-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’ã¯å©¦ä¸­ç”ºã®è‡ªç„¶è±Šã‹ãªåœ°åŸŸã«ä½ç½®ã—ã¦ãŠã‚Šã€è»Šã§ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒä¾¿åˆ©ã§ã™ã€‚å–¶æ¥­æ™‚é–“ã‚„ä¼‘åœ’æ—¥ã«ã¤ã„ã¦ã¯äº‹å‰ã«ç¢ºèªã•ã‚Œã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ã§ã¯æ±šã‚Œã¦ã‚‚è‰¯ã„æœè£…ã§ãŠå‡ºã‹ã‘ãã ã•ã„ã€‚ã‚«ãƒ¡ãƒ©ã‚’æŒå‚ã™ã‚Œã°ã€å­ã©ã‚‚ãŸã¡ã¨å‹•ç‰©ãŸã¡ã®ç´ æ•µãªè§¦ã‚Œåˆã„ã‚·ãƒ¼ãƒ³ã‚’è¨˜éŒ²ã«æ®‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚åœ°å…ƒã®éš ã‚ŒãŸåæ‰€ã¨ã—ã¦ã€ãœã²ä¸€åº¦è¨ªã‚Œã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç”°æ‘è¾²åœ’ãŸã¾ã”åœ’ã¯ç„¡æ–™ã§å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ã‚„è¾²æ¥­ä½“é¨“ãŒæ¥½ã—ã‚ã‚‹ç´ æ™´ã‚‰ã—ã„æ–½è¨­ã§ã™ã€‚å®¶æ—ã¿ã‚“ãªã§è‡ªç„¶ã¨è§¦ã‚Œåˆã†ç‰¹åˆ¥ãªä¸€æ—¥ã‚’ãŠéã”ã—ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬17è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 176æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandSeventeenthArticle();
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandThirteenthArticle() {
  try {
    console.log('ç¬¬13è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: namerikawa-city-2668-onsen-x2668-xfe0f-x263a-xfe0f (ã¿ã®ã‚æ¸©æ³‰)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "namerikawa-city-2668-onsen-x2668-xfe0f-x263a-xfe0f"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€ã¿ã®ã‚æ¸©æ³‰ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ»‘å·å¸‚ã®å±±é–“éƒ¨ã«ã²ã£ãã‚Šã¨ä½‡ã‚€ã€Œã¿ã®ã‚æ¸©æ³‰ã€ã€‚å¯Œå±±å¼ã§ã€Œã­ã¾ã‚‰ã‚Œã€œã€ï¼ˆã‚†ã£ãã‚Šä¼‘ã‚“ã§ã„ã£ã¦ã­ï¼‰ã¨ã„ã†æ¸©ã‹ã„ãŠã‚‚ã¦ãªã—ã®å¿ƒãŒæ„Ÿã˜ã‚‰ã‚Œã‚‹éš ã‚ŒãŸåæ¹¯ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¿ã®ã‚æ¸©æ³‰ã®æ¦‚è¦ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-overview',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¿ã®ã‚æ¸©æ³‰ã®é­…åŠ›ã¨ç‰¹å¾´', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'overview-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã¿ã®ã‚æ¸©æ³‰ã¯æ»‘å·å¸‚ã®å±±é–“éƒ¨ã«ä½ç½®ã™ã‚‹ç§˜æ¹¯çš„ãªæ¸©æ³‰æ–½è¨­ã§ã™ã€‚éƒ½å¸‚éƒ¨ã®å–§é¨’ã‹ã‚‰é›¢ã‚ŒãŸé™ã‹ãªç’°å¢ƒã«ã‚ã‚Šã€ã¾ã•ã«ã€Œéš ã‚ŒãŸæ¸©æ³‰ã€ã¨ã„ã†è¡¨ç¾ãŒã´ã£ãŸã‚Šã®å ´æ‰€ã§ã™ã€‚åœ°å…ƒã®æ–¹ã€…ã«æ„›ã•ã‚Œç¶šã‘ã¦ã„ã‚‹ã‚¢ãƒƒãƒˆãƒ›ãƒ¼ãƒ ãªé›°å›²æ°—ãŒé­…åŠ›ã§ã€è¨ªã‚Œã‚‹äººã€…ã‚’æ¸©ã‹ãè¿ãˆã¦ãã‚Œã¾ã™ã€‚è‡ªç„¶ã«å›²ã¾ã‚ŒãŸç«‹åœ°ã«ã‚ˆã‚Šã€å››å­£æŠ˜ã€…ã®ç¾ã—ã„æ™¯è‰²ã‚’æ¥½ã—ã¿ãªãŒã‚‰æ¸©æ³‰ã«æµ¸ã‹ã‚‹ã“ã¨ãŒã§ãã‚‹è´…æ²¢ãªä½“é¨“ãŒå¾…ã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å¯Œå±±å¼ã®æ¸©ã‹ã•ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-toyama-ben',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¯Œå±±å¼ã€Œã­ã¾ã‚‰ã‚Œã€œã€ã®æ¸©ã‹ã„ãŠã‚‚ã¦ãªã—', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'toyama-ben-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã€Œã­ã¾ã‚‰ã‚Œã€œã€ã¯å¯Œå±±çœŒã®æ–¹è¨€ã§ã€Œã‚†ã£ãã‚Šä¼‘ã‚“ã§ã„ã£ã¦ãã ã•ã„ã­ã€ã¨ã„ã†æ„å‘³ã®æ¸©ã‹ã„è¨€è‘‰ã§ã™ã€‚ã“ã®è¨€è‘‰ã«ã¯å¯Œå±±çœŒæ°‘ã®äººæ‡ã£ã“ã•ã¨ã€ãŠå®¢æ§˜ã‚’å¤§åˆ‡ã«ã™ã‚‹ãŠã‚‚ã¦ãªã—ã®å¿ƒãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã¿ã®ã‚æ¸©æ³‰ã§ã‚‚ã€ã“ã®ç²¾ç¥ãŒæ¯ã¥ã„ã¦ãŠã‚Šã€åˆã‚ã¦è¨ªã‚Œã‚‹äººã§ã‚‚åœ°å…ƒã®å¸¸é€£ã•ã‚“ã®ã‚ˆã†ã«æ¸©ã‹ãè¿ãˆã¦ãã‚Œã¾ã™ã€‚å¯Œå±±å¼ã®æ¸©ã‹ã•ã¯ã€æ¸©æ³‰ã®åŠ¹èƒ½ã¨åŒã˜ã‚ˆã†ã«å¿ƒã¨èº«ä½“ã‚’ç™’ã—ã¦ãã‚Œã‚‹ç‰¹åˆ¥ãªé­…åŠ›ã§ã™ã€‚æ–¹è¨€ã‚’é€šã˜ã¦åœ°åŸŸã®æ–‡åŒ–ã«è§¦ã‚Œã‚‹ã“ã¨ã‚‚ã€æ—…ã®é†é†å‘³ã®ä¸€ã¤ã¨ã„ãˆã‚‹ã§ã—ã‚‡ã†ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¸©æ³‰ã®åŠ¹èƒ½ã¨ç‰¹å¾´ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-benefits',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¸©æ³‰ã®æ³‰è³ªã¨å¥åº·åŠ¹æœ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'benefits-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã¿ã®ã‚æ¸©æ³‰ã®æ³‰è³ªã¯è‚Œã«å„ªã—ãã€ç¥çµŒç—›ã‚„ç­‹è‚‰ç—›ã€ç–²åŠ´å›å¾©ã«åŠ¹æœãŒã‚ã‚‹ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚å±±é–“éƒ¨ã®æ¸…ã‚‰ã‹ãªæ°´æºã‹ã‚‰æ¹§ãå‡ºã‚‹æ¸©æ³‰ã¯ã€æ—¥é ƒã®ç–²ã‚Œã‚’ç™’ã™ã®ã«æœ€é©ã§ã™ã€‚æ¸©æ³‰ã«æµ¸ã‹ã‚ŠãªãŒã‚‰å‘¨å›²ã®è‡ªç„¶ã®éŸ³ã«è€³ã‚’å‚¾ã‘ã‚‹ã¨ã€å¿ƒèº«ã¨ã‚‚ã«ãƒªãƒ©ãƒƒã‚¯ã‚¹ã§ãã¾ã™ã€‚åœ°å…ƒã®æ–¹ã€…ãŒæ—¥å¸¸çš„ã«åˆ©ç”¨ã—ã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ã‚‚ã€ãã®åŠ¹èƒ½ã®é«˜ã•ãŒã†ã‹ãŒãˆã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å±±é–“éƒ¨ã®è‡ªç„¶ç’°å¢ƒï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-nature',
        style: 'h2',
        children: [{ _type: 'span', text: 'è±Šã‹ãªè‡ªç„¶ã«å›²ã¾ã‚ŒãŸç«‹åœ°', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'nature-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ¸©æ³‰ã¯ç·‘è±Šã‹ãªå±±é–“éƒ¨ã«ä½ç½®ã—ã¦ãŠã‚Šã€å››å­£ã‚’é€šã˜ã¦ç¾ã—ã„è‡ªç„¶ã®å¤‰åŒ–ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚æ˜¥ã¯æ–°ç·‘ã€å¤ã¯æ·±ã„ç·‘ã€ç§‹ã¯ç´…è‘‰ã€å†¬ã¯é›ªæ™¯è‰²ã¨ã€ãã‚Œãã‚Œã®å­£ç¯€ã§ç•°ãªã£ãŸè¡¨æƒ…ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚é³¥ã®ã•ãˆãšã‚Šã‚„æœ¨ã€…ã®ã–ã‚ã‚ãã€æ¸…æµã®éŸ³ãªã©ã€è‡ªç„¶ã®éŸ³ã«åŒ…ã¾ã‚ŒãªãŒã‚‰ã®æ¸©æ³‰ä½“é¨“ã¯ã€éƒ½å¸‚éƒ¨ã§ã¯å‘³ã‚ãˆãªã„ç‰¹åˆ¥ãªç™’ã—ã‚’ã‚‚ãŸã‚‰ã—ã¦ãã‚Œã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°å…ƒå¯†ç€ã®é­…åŠ›ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-local',
        style: 'h2',
        children: [{ _type: 'span', text: 'åœ°åŸŸã«æ„›ã•ã‚Œã‚‹æ¸©æ³‰ã®ä¾¡å€¤', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'local-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã¿ã®ã‚æ¸©æ³‰ã¯åœ°å…ƒã®æ–¹ã€…ã«æ—¥å¸¸çš„ã«åˆ©ç”¨ã•ã‚Œã‚‹ã€åœ°åŸŸå¯†ç€å‹ã®æ¸©æ³‰ã§ã™ã€‚è¦³å…‰åœ°ã®å¤§å‹æ¸©æ³‰æ–½è¨­ã¨ã¯é•ã£ãŸã€ã‚¢ãƒƒãƒˆãƒ›ãƒ¼ãƒ ã§è¦ªã—ã¿ã‚„ã™ã„é›°å›²æ°—ãŒé­…åŠ›ã§ã™ã€‚åœ°å…ƒã®æ–¹ã€…ã¨ã®ä½•æ°—ãªã„ä¼šè©±ã‚‚æ¥½ã—ã¿ã®ä¸€ã¤ã§ã€å¯Œå±±ã®æ–‡åŒ–ã‚„æš®ã‚‰ã—ã«ã¤ã„ã¦çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã†ã—ãŸåœ°åŸŸã¨ã®äº¤æµã‚‚ã€æ¸©æ³‰æ—…è¡Œã®é†é†å‘³ã¨ã„ãˆã‚‹ã§ã—ã‚‡ã†ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å±±é–“éƒ¨ã«éš ã‚ŒãŸã€Œã¿ã®ã‚æ¸©æ³‰ã€ã¯ã€å¯Œå±±å¼ã®æ¸©ã‹ã•ã¨è‡ªç„¶ã®æµã¿ãŒæ„Ÿã˜ã‚‰ã‚Œã‚‹ç‰¹åˆ¥ãªå ´æ‰€ã§ã™ã€‚ã€Œã­ã¾ã‚‰ã‚Œã€œã€ã®å¿ƒã§è¿ãˆã¦ãã‚Œã‚‹ã“ã®æ¸©æ³‰ã§ã€å¿ƒèº«ã¨ã‚‚ã«ç™’ã•ã‚Œã‚‹ã²ã¨ã¨ãã‚’ãŠéã”ã—ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬13è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 205æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandThirteenthArticle();
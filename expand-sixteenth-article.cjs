const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandSixteenthArticle() {
  try {
    console.log('ç¬¬16è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: uozu-city-festival-chouroku (CHOUROKUã¾ã¤ã‚Šã®ã‚ˆã•ã“ã„)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "uozu-city-festival-chouroku"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€CHOUROKUã¾ã¤ã‚Šã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é­šæ´¥å¸‚ã§é–‹å‚¬ã•ã‚Œã‚‹CHOUROKUã¾ã¤ã‚Šã®ã‚ˆã•ã“ã„æ¼”èˆã¯ã€ç†±æ°—ã‚ãµã‚Œã‚‹è¿«åŠ›ã¨ç¾ã—ã•ãŒå°è±¡çš„ãªåœ°åŸŸã®ä¸€å¤§ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: CHOUROKUã¾ã¤ã‚Šã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-festival',
        style: 'h2',
        children: [{ _type: 'span', text: 'CHOUROKUã¾ã¤ã‚Šã®é­…åŠ›ã¨æ­´å²', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'festival-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'CHOUROKUã¾ã¤ã‚Šã¯é­šæ´¥å¸‚ã®å¤ã‚’å½©ã‚‹ä»£è¡¨çš„ãªç¥­ã‚Šã®ä¸€ã¤ã§ã€åœ°åŸŸã®æ–‡åŒ–ã¨ç¾ä»£çš„ãªã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆãŒèåˆã—ãŸç‰¹åˆ¥ãªã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚ã€ŒCHOUROKUï¼ˆé•·éŒ²ï¼‰ã€ã¨ã„ã†åå‰ã«ã¯ã€é•·ãè¨˜éŒ²ã«æ®‹ã‚‹ç´ æ™´ã‚‰ã—ã„ç¥­ã‚Šã«ã—ãŸã„ã¨ã„ã†é¡˜ã„ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã‚ˆã•ã“ã„è¸Šã‚Šã‚’ä¸­å¿ƒã¨ã—ãŸæ§˜ã€…ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒç¹°ã‚Šåºƒã’ã‚‰ã‚Œã€å‚åŠ è€…ã¨è¦³å®¢ãŒä¸€ä½“ã¨ãªã£ã¦ç››ã‚Šä¸ŠãŒã‚‹ç†±æ°—ã«æº€ã¡ãŸç©ºé–“ãŒç”Ÿã¾ã‚Œã¾ã™ã€‚åœ°å…ƒã®å›£ä½“ã‹ã‚‰çœŒå¤–ã®ãƒãƒ¼ãƒ ã¾ã§ã€å¤šãã®è¸Šã‚Šæ‰‹ãŒé›†ã¾ã‚‹é­šæ´¥å¸‚ã®èª‡ã‚Šã‚ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚ˆã•ã“ã„è¸Šã‚Šã®é­…åŠ›ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-yosakoi',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚ˆã•ã“ã„æ¼”èˆã®è¿«åŠ›ã¨ç¾ã—ã•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'yosakoi-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã‚ˆã•ã“ã„è¸Šã‚Šã¯é«˜çŸ¥çœŒç™ºç¥¥ã®ä¼çµ±çš„ãªè¸Šã‚Šã‚’ç¾ä»£é¢¨ã«ã‚¢ãƒ¬ãƒ³ã‚¸ã—ãŸå‰µä½œèˆè¸Šã§ã€åŠ›å¼·ã„å‹•ãã¨è¯ã‚„ã‹ãªè¡£è£…ãŒç‰¹å¾´ã§ã™ã€‚CHOUROKUã¾ã¤ã‚Šã§ã¯å„ãƒãƒ¼ãƒ ãŒç‹¬è‡ªã®æŒ¯ä»˜ã¨éŸ³æ¥½ã§å€‹æ€§ã‚ãµã‚Œã‚‹æ¼”èˆã‚’æŠ«éœ²ã—ã€è¦³å®¢ã‚’é­…äº†ã—ã¾ã™ã€‚é³´å­ã‚’æ‰‹ã«æŒã£ã¦è¸Šã‚‹ãƒªã‚ºãƒŸã‚«ãƒ«ãªå‹•ãã¯ã€è¦‹ã¦ã„ã‚‹äººã®å¿ƒã‚‚èºã‚‰ã›ã¾ã™ã€‚ãƒãƒ¼ãƒ ä¸€ä¸¸ã¨ãªã£ã¦ç·´ç¿’ã‚’é‡ã­ãŸæˆæœãŒèˆå°ã§èŠ±é–‹ãç¬é–“ã¯ã€æ„Ÿå‹•çš„ãªå…‰æ™¯ã§ã™ã€‚å¹´é½¢ã‚„æ€§åˆ¥ã‚’å•ã‚ãšèª°ã§ã‚‚å‚åŠ ã§ãã‚‹é–‹æ”¾çš„ãªé›°å›²æ°—ã‚‚ã€ã‚ˆã•ã“ã„ã®å¤§ããªé­…åŠ›ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-community',
        style: 'h2',
        children: [{ _type: 'span', text: 'åœ°åŸŸã‚’çµã¶ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'community-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'CHOUROKUã¾ã¤ã‚Šã¯å˜ãªã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã§ã¯ãªãã€é­šæ´¥å¸‚ã®åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚’çµã¶é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚åœ°å…ƒã®å­¦æ ¡ã€ä¼æ¥­ã€å¸‚æ°‘ã‚°ãƒ«ãƒ¼ãƒ—ãªã©æ§˜ã€…ãªå›£ä½“ãŒå‚åŠ ã—ã€ç¥­ã‚Šã®æº–å‚™ã‹ã‚‰é‹å–¶ã¾ã§å”åŠ›ã—ã¦å–ã‚Šçµ„ã¿ã¾ã™ã€‚ã“ã®éç¨‹ã§ä¸–ä»£ã‚’è¶…ãˆãŸäº¤æµãŒç”Ÿã¾ã‚Œã€åœ°åŸŸã®çµæŸãŒæ·±ã¾ã‚Šã¾ã™ã€‚ã¾ãŸã€çœŒå¤–ã‹ã‚‰ã®å‚åŠ è€…ã‚‚å¤šãã€é­šæ´¥å¸‚ã®é­…åŠ›ã‚’åºƒãã‚¢ãƒ”ãƒ¼ãƒ«ã™ã‚‹è¦³å…‰ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ã‚‚æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é­šæ´¥å¸‚ã®å¤ã®é¢¨ç‰©è©©ï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summer',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¤ã®é­šæ´¥ã‚’å½©ã‚‹é¢¨ç‰©è©©', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summer-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ã®é­šæ´¥å¸‚ã§ã¯ã€èœƒæ°—æ¥¼ã‚„ãƒ›ã‚¿ãƒ«ã‚¤ã‚«ãªã©ã®è‡ªç„¶ç¾è±¡ã¨ã¨ã‚‚ã«ã€CHOUROKUã¾ã¤ã‚ŠãŒåœ°åŸŸã‚’ä»£è¡¨ã™ã‚‹é¢¨ç‰©è©©ã¨ãªã£ã¦ã„ã¾ã™ã€‚ç¥­ã‚Šå½“æ—¥ã¯è¡—å…¨ä½“ãŒæ´»æ°—ã«æº€ã¡ã€åœ°å…ƒã‚°ãƒ«ãƒ¡ã®å±‹å°ã‚„æ§˜ã€…ãªã‚¤ãƒ™ãƒ³ãƒˆã‚‚åŒæ™‚é–‹å‚¬ã•ã‚Œã¾ã™ã€‚å®¶æ—é€£ã‚Œã‹ã‚‰è¦³å…‰å®¢ã¾ã§ã€å¤šãã®äººã€…ãŒé­šæ´¥ã®å¤ã‚’æº€å–«ã§ãã‚‹ç‰¹åˆ¥ãªä¸€æ—¥ã¨ãªã‚Šã¾ã™ã€‚è¸Šã‚Šæ‰‹ã®ç†±æ¼”ã¨è¦³å®¢ã®å£°æ´ãŒéŸ¿ãä¼šå ´ã¯ã€é­šæ´¥å¸‚æ°‘ã®èª‡ã‚Šã¨æƒ…ç†±ã‚’æ„Ÿã˜ã‚‰ã‚Œã‚‹ç©ºé–“ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å‚åŠ ã¨è¦³è¦§ã®æ¥½ã—ã¿æ–¹ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-enjoy',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç¥­ã‚Šã®æ¥½ã—ã¿æ–¹ã¨ã‚¢ã‚¯ã‚»ã‚¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'enjoy-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'CHOUROKUã¾ã¤ã‚Šã¯è¦³è¦§ç„¡æ–™ã§ã€ã©ãªãŸã§ã‚‚æ°—è»½ã«æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ä¼šå ´ã§ã¯å„ãƒãƒ¼ãƒ ã®æ¼”èˆã‚’é–“è¿‘ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã€è¿«åŠ›ã‚ã‚‹è¸Šã‚Šã¨éŸ³æ¥½ã‚’ä½“æ„Ÿã§ãã¾ã™ã€‚å†™çœŸæ’®å½±ã‚‚å¯èƒ½ã§ã€ç´ æ™´ã‚‰ã—ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¨˜éŒ²ã«æ®‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚é­šæ´¥é§…ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚è‰¯å¥½ã§ã€å…¬å…±äº¤é€šæ©Ÿé–¢ã‚’åˆ©ç”¨ã—ã¦æ°—è»½ã«è¨ªã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚åœ°å…ƒã‚°ãƒ«ãƒ¡ã‚‚åˆã‚ã›ã¦æ¥½ã—ã‚ã‚‹ã€é­šæ´¥è¦³å…‰ã®ç›®ç‰ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'CHOUROKUã¾ã¤ã‚Šã®ã‚ˆã•ã“ã„ã¯é­šæ´¥å¸‚ã®å¤ã‚’ä»£è¡¨ã™ã‚‹ç´ æ™´ã‚‰ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚åœ°åŸŸã®çµ†ã¨æƒ…ç†±ãŒè¾¼ã‚ã‚‰ã‚ŒãŸè¿«åŠ›ã‚ã‚‹æ¼”èˆã‚’ãœã²ä½“é¨“ã—ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬16è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 176æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandSixteenthArticle();
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  useCdn: false,
  apiVersion: '2024-01-01',
  token: process.env.SANITY_API_TOKEN || 'skkTjwpdrsjKKpaDxKVShzCSI7GMWE1r5TQdwl0b7LTylVPoAxzBg0oPqhtUQyfPjyvtZW2mu6nfUMNUJ'
});

const articlesWithDescriptions = [
  {
    slug: 'nanto-city-1756354798877',
    title: 'ã€å—ç ºå¸‚ã€‘ã†ã•ãæ¨ã—å¿…è¦‹ï¼ã€Œãƒ‘ãƒ†ã‚£ã‚¹ãƒªãƒ¼ã¾ã¡ãªã¿ãƒ©ãƒ‘ãƒ³ã€ãŒå¯æ„›ã™ããŸï¼ #shorts',
    description: 'å—ç ºå¸‚ã®ã€Œãƒ‘ãƒ†ã‚£ã‚¹ãƒªãƒ¼ã¾ã¡ãªã¿ãƒ©ãƒ‘ãƒ³ã€ã¯ã€ã†ã•ããƒ¢ãƒãƒ¼ãƒ•ã®å¯æ„›ã„ã‚¹ã‚¤ãƒ¼ãƒ„ãŒè©•åˆ¤ã®ã‚±ãƒ¼ã‚­åº—ã€‚ã†ã•ãå¥½ããªã‚‰å¿…è¦‹ã®åº—å†…è£…é£¾ã¨ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚±ãƒ¼ã‚­ã§ã€åœ°å…ƒã«æ„›ã•ã‚Œã‚‹ç‰¹åˆ¥ãªç©ºé–“ã§ã™ã€‚'
  },
  {
    slug: 'toyama-city-1756354795933',
    title: 'ã€å¯Œå±±å¸‚ã€‘è½ã¡ç€ã„ãŸç©ºé–“ã§æ¥½ã—ã‚€ãƒªãƒˆãƒ«ä¸Šæµ·ã®æœ¬æ ¼ä¸­è¯ãƒ©ãƒ³ãƒï¼æ—¥å¸¸ã«ãã£ã¨é«˜ç´šæ„Ÿã‚’ #shorts',
    description: 'å¯Œå±±å¸‚ã®ã€Œãƒªãƒˆãƒ«ä¸Šæµ·ã€ã§å‘³ã‚ã†æœ¬æ ¼ä¸­è¯ãƒ©ãƒ³ãƒã€‚è½ã¡ç€ã„ãŸä¸Šå“ãªåº—å†…ã§ã€åœ°å…ƒé£Ÿæã‚’ä½¿ã£ãŸå¿ƒæ¸©ã¾ã‚‹ä¸­è¯æ–™ç†ã‚’å ªèƒ½ã€‚æ—¥å¸¸ã«é«˜ç´šæ„Ÿã‚’æ·»ãˆã‚‹éš ã‚Œå®¶çš„ãªååº—ã§ã™ã€‚'
  },
  {
    slug: 'takaoka-city-1756354793286',
    title: 'ã€é«˜å²¡å¸‚ã€‘è„±å‡ºã‚’ä¼(ãã‚ã )ã¦ã‚‹ãƒšãƒ³ã‚®ãƒ³',
    description: 'é«˜å²¡å¤åŸå…¬åœ’å‹•ç‰©åœ’ã§è©±é¡Œã®ãƒšãƒ³ã‚®ãƒ³ãŸã¡ã€‚ã¾ã‚‹ã§è„±å‡ºã‚’ä¼ã¦ã¦ã„ã‚‹ã‹ã®ã‚ˆã†ãªæ„›ã‚‰ã—ãã¦è³¢æ˜ãªè¡Œå‹•ãŒäººæ°—ã€‚å€‹æ€§è±Šã‹ãªãƒšãƒ³ã‚®ãƒ³ã¨ã®è§¦ã‚Œåˆã„ã‚’æ¥½ã—ã‚ã¾ã™ã€‚'
  },
  {
    slug: 'uozu-city-aquarium-spotted-seal-healing-experience',
    title: 'ã€é­šæ´¥å¸‚ã€‘æ¯æ—¥æš‘ã„ã®ã§ã‚´ãƒãƒ•ã‚¢ã‚¶ãƒ©ã‚·ã‚’è¦‹ã¦æ¶¼ã—ã•ã‚’æ„Ÿã˜ã‚ˆã†ï¼é­šæ´¥æ°´æ—é¤¨ã®ç™’ã—ä½“é¨“',
    description: 'é­šæ´¥æ°´æ—é¤¨ã®ã‚´ãƒãƒ•ã‚¢ã‚¶ãƒ©ã‚·ã§æš‘ã„å¤ã‚’æ¶¼ã—ãï¼æ°´ä¸­ã‚’å„ªé›…ã«æ³³ãã‚¢ã‚¶ãƒ©ã‚·ãŸã¡ã®ç™’ã—ã®å§¿ã§å¿ƒã‚‚ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã€‚æ—¥æœ¬æµ·å´æœ€å¤§ç´šã®æ°´æ—é¤¨ã§ç‰¹åˆ¥ãªæ¶¼ä½“é¨“ã‚’ã€‚'
  },
  {
    slug: 'himi-city-yoshigake-farm-goat-slow-life-experience',
    title: 'ã€æ°·è¦‹å¸‚ã€‘å‰ãŒã‘ç‰§å ´ã®ãƒ¤ã‚®ãŸã¡ã‹ã‚‰è¦‹ç¿’ã„ãŸã„ã‚¹ãƒ­ãƒ¼ãƒ©ã‚¤ãƒ•ä½“é¨“',
    description: 'æ°·è¦‹å¸‚ã®å‰ãŒã‘ç‰§å ´ã§ã€ã®ã‚“ã³ã‚Šè‰ã‚’é£Ÿã‚€ãƒ¤ã‚®ãŸã¡ã‹ã‚‰å­¦ã¶ã‚¹ãƒ­ãƒ¼ãƒ©ã‚¤ãƒ•ã€‚ãƒã‚¤ãƒšãƒ¼ã‚¹ãªç‰§å ´ç”Ÿæ´»ã®é­…åŠ›ã¨ã€éƒ½å¸‚éƒ¨ã®å¿™ã—ã•ã‚’å¿˜ã‚Œã•ã›ã‚‹ç™’ã—ã®ä½“é¨“ã‚’ãŠå±Šã‘ã€‚'
  },
  {
    slug: 'tonami-city-aeon-mall-kimetsu-no-yaiba-poster-exhibition',
    title: 'ã€ç ºæ³¢å¸‚ã€‘ã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«ã¨ãªã¿ã§ã€åŠ‡å ´ç‰ˆã€Œé¬¼æ»…ã®åˆƒã€ç„¡é™åŸç·¨ã€ãƒã‚¹ã‚¿ãƒ¼å±•é–‹å‚¬ä¸­ï¼',
    description: 'ç ºæ³¢å¸‚ã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«ã¨ãªã¿ã§é–‹å‚¬ã®ã€ŒåŠ‡å ´ç‰ˆã€é¬¼æ»…ã®åˆƒã€ç„¡é™åŸç·¨ã€ãƒã‚¹ã‚¿ãƒ¼å±•ã€‚è¿«åŠ›æº€ç‚¹ã®ãƒã‚¹ã‚¿ãƒ¼ã¨é–¢é€£ã‚°ãƒƒã‚ºã§ä½œå“ã®ä¸–ç•Œè¦³ã‚’å ªèƒ½ã§ãã‚‹é¬¼æ»…ãƒ•ã‚¡ãƒ³å¿…è¦‹ã®ã‚¤ãƒ™ãƒ³ãƒˆã€‚'
  },
  {
    slug: 'takaoka-city-doria-libo-specialty-store',
    title: 'ã€é«˜å²¡å¸‚ã€‘ãƒ‰ãƒªã‚¢å°‚é–€åº—ã€Œãƒ‰ãƒªã‚¢ãƒªãƒ¼ãƒœã€ã§è¡Œåˆ—å¿…è‡³ã®æ¿ƒåšãƒ‰ãƒªã‚¢ãƒ©ãƒ³ãƒï¼#shorts',
    description: 'é«˜å²¡å¸‚ã®äººæ°—ãƒ‰ãƒªã‚¢å°‚é–€åº—ã€Œãƒ‰ãƒªã‚¢ãƒªãƒ¼ãƒœã€ã§å‘³ã‚ã†çµ¶å“ãƒ©ãƒ³ãƒã€‚å°‚é–€åº—ãªã‚‰ã§ã¯ã®ã“ã ã‚ã‚Šã¨æŠ€è¡“ã§ä½œã‚‰ã‚Œã‚‹æ¿ƒåšãƒ‰ãƒªã‚¢ã¯è¡Œåˆ—å¿…è‡³ã®ç¾å‘³ã—ã•ã€‚åœ°å…ƒæ°‘ã‚‚è¦³å…‰å®¢ã‚‚å¤§æº€è¶³ã€‚'
  },
  {
    slug: 'toyama-city-ooita-shrine-summer-visit',
    title: 'ã€å¯Œå±±å¸‚ã€‘å¯Œå±±ã®å­¦å•ç¥ç¤¾ï¼æ–¼ä¿å¤š(ãŠãŠãŸ)ç¥ç¤¾ã§å¤è©£ï¼†å­¦æ¥­ç¥ˆé¡˜',
    description: 'å¯Œå±±å¸‚ã®æ–¼ä¿å¤šï¼ˆãŠãŠãŸï¼‰ç¥ç¤¾ã¯å­¦å•ã®ç¥æ§˜ã¨ã—ã¦æœ‰åãªç”±ç·’ã‚ã‚‹ç¥ç¤¾ã€‚å¤è©£ã§ã®å¿ƒèº«ã®æµ„åŒ–ã¨å­¦æ¥­æˆå°±ãƒ»åˆæ ¼ç¥ˆé¡˜ã§ã€å—é¨“ç”Ÿã‹ã‚‰ç¤¾ä¼šäººã¾ã§å¹…åºƒãæ”¯æŒã•ã‚Œã‚‹è–åœ°ã§ã™ã€‚'
  },
  {
    slug: 'toyama-city-kansui-park-summer-fountain-2025',
    title: 'ã€å¯Œå±±å¸‚ã€‘æ¶¼æ„ŸMAXï¼ç’°æ°´å…¬åœ’ã‚µãƒãƒ¼ãƒ•ã‚¡ã‚¦ãƒ³ãƒ†ãƒ³2025ã§å¤ã®æš‘ã•ã‚’å¹ãé£›ã°ãã†',
    description: 'å¯Œå±±å¸‚ã®ç’°æ°´å…¬åœ’ã‚µãƒãƒ¼ãƒ•ã‚¡ã‚¦ãƒ³ãƒ†ãƒ³2025ã§å¤ã®æš‘ã•ã‚’çˆ½å¿«ã«å¹ãé£›ã°ãã†ï¼æ¶¼æ„ŸMAXã®æ°´ã—ã¶ãã¨ç¾ã—ã„æ™¯è¦³ã§ã€æš‘ã„æ—¥ã§ã‚‚å¿«é©ã«éã”ã›ã‚‹äººæ°—ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚'
  },
  {
    slug: 'toyama-city-disney-40th-complete-parade-2023',
    title: 'ã€å¯Œå±±å¸‚ã€‘æ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒªã‚¾ãƒ¼ãƒˆ40å‘¨å¹´ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ‘ãƒ¬ãƒ¼ãƒ‰å®Œå…¨ç‰ˆï½œå¯Œå±±ã¾ã¤ã‚Š2023',
    description: 'å¯Œå±±ã¾ã¤ã‚Š2023ã§é–‹å‚¬ã•ã‚ŒãŸæ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒªã‚¾ãƒ¼ãƒˆ40å‘¨å¹´ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ‘ãƒ¬ãƒ¼ãƒ‰ã®å®Œå…¨ç‰ˆã€‚ãƒŸãƒƒã‚­ãƒ¼ãŸã¡ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒå¯Œå±±ã®è¡—ã‚’å½©ã£ãŸç‰¹åˆ¥ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’åéŒ²ã€‚'
  }
];

async function updateDescriptions() {
  console.log('ğŸš€ Sanity APIçµŒç”±ã§ã®è¨˜äº‹èª¬æ˜æ–‡è‡ªå‹•è¨­å®šã‚’é–‹å§‹ã—ã¾ã™...');
  console.log(`ğŸ“Š å¯¾è±¡è¨˜äº‹æ•°: ${articlesWithDescriptions.length}ä»¶`);
  
  let successCount = 0;
  let failureCount = 0;
  
  for (const article of articlesWithDescriptions) {
    try {
      console.log(`\nğŸ“ æ›´æ–°ä¸­: ${article.title}`);
      console.log(`ğŸ”— ã‚¹ãƒ©ãƒƒã‚°: ${article.slug}`);
      console.log(`ğŸ’¬ èª¬æ˜æ–‡: ${article.description}`);
      
      // ã‚¹ãƒ©ãƒƒã‚°ã§è¨˜äº‹ã‚’æ¤œç´¢
      const posts = await client.fetch(`*[_type == "post" && slug.current == $slug]`, {
        slug: article.slug
      });
      
      if (posts.length === 0) {
        console.log(`âŒ ã‚¨ãƒ©ãƒ¼: ã‚¹ãƒ©ãƒƒã‚° "${article.slug}" ã®è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
        failureCount++;
        continue;
      }
      
      const post = posts[0];
      console.log(`âœ… è¨˜äº‹ç™ºè¦‹: ID ${post._id}`);
      
      // èª¬æ˜æ–‡ã‚’æ›´æ–°
      const result = await client
        .patch(post._id)
        .set({ description: article.description })
        .commit();
      
      console.log(`âœ… æ›´æ–°å®Œäº†: ${article.title}`);
      successCount++;
      
      // ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–ã§å°‘ã—å¾…æ©Ÿ
      await new Promise(resolve => setTimeout(resolve, 500));
      
    } catch (error) {
      console.error(`âŒ ã‚¨ãƒ©ãƒ¼: ${article.title}`);
      console.error(`ã‚¨ãƒ©ãƒ¼è©³ç´°: ${error.message}`);
      failureCount++;
    }
  }
  
  console.log('\nğŸ“Š æ›´æ–°çµæœã‚µãƒãƒªãƒ¼:');
  console.log(`âœ… æˆåŠŸ: ${successCount}ä»¶`);
  console.log(`âŒ å¤±æ•—: ${failureCount}ä»¶`);
  console.log(`ğŸ“ˆ æˆåŠŸç‡: ${Math.round((successCount / articlesWithDescriptions.length) * 100)}%`);
  
  if (successCount === articlesWithDescriptions.length) {
    console.log('\nğŸ‰ å…¨ã¦ã®è¨˜äº‹ã®èª¬æ˜æ–‡è¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸï¼');
    console.log('ğŸ’¡ SEOåŠ¹æœã®å‘ä¸ŠãŒæœŸå¾…ã•ã‚Œã¾ã™ã€‚');
  } else {
    console.log(`\nâš ï¸  ${failureCount}ä»¶ã®è¨˜äº‹ã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã®ç¢ºèªã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚`);
  }
}

updateDescriptions().catch(console.error);
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandThirtyFirstArticle() {
  try {
    console.log('ç¬¬31è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: nanto-city (å—ç ºå¸‚ã®å†¬ã®ã“ãã‚Šã“ã®é‡Œ)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "nanto-city"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€å—ç ºå¸‚ã®å†¬ã®ã“ãã‚Šã“ã®é‡Œã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å—ç ºå¸‚ã«ã‚ã‚‹é›ªæ™¯è‰²ãŒåºƒãŒã‚‹ç§˜å¢ƒã€Œå†¬ã®ã“ãã‚Šã“ã®é‡Œã€ã€‚ç™½éŠ€ã®ä¸–ç•Œã«åŒ…ã¾ã‚ŒãŸä¼çµ±çš„ãªæ—¥æœ¬ã®æ‘è½é¢¨æ™¯ã®ç¾ã—ã•ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã“ãã‚Šã“ã®é‡Œã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-village',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã“ãã‚Šã“ã®é‡Œã®æ­´å²ã¨æ–‡åŒ–çš„ä¾¡å€¤', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'village-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã“ãã‚Šã“ã®é‡Œã¯å—ç ºå¸‚ã«ã‚ã‚‹äº”ç®‡å±±åœ°åŸŸã®ä¸€éƒ¨ã§ã€ä¸–ç•Œéºç”£ã«ã‚‚ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹åˆæŒé€ ã‚Šé›†è½ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã€Œã“ãã‚Šã“ã€ã¯å¯Œå±±çœŒã«ä¼ã‚ã‚‹æ°‘è¬¡ã®åå‰ã§ã€ã“ã®åœ°åŸŸã®æ–‡åŒ–çš„ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’è±¡å¾´ã—ã¦ã„ã¾ã™ã€‚æ€¥å³»ãªå±±ã€…ã«å›²ã¾ã‚ŒãŸè°·é–“ã«ä½ç½®ã™ã‚‹ã“ã®é›†è½ã¯ã€æ—¥æœ¬ã®åŸé¢¨æ™¯ã‚’ä»Šã«æ®‹ã™è²´é‡ãªå ´æ‰€ã¨ã—ã¦ã€å¤šãã®è¦³å…‰å®¢ã‚„å†™çœŸæ„›å¥½å®¶ã«æ„›ã•ã‚Œç¶šã‘ã¦ã„ã¾ã™ã€‚ä¼çµ±çš„ãªç”Ÿæ´»æ§˜å¼ãŒç¾åœ¨ã‚‚å—ã‘ç¶™ãŒã‚Œã¦ãŠã‚Šã€æ—¥æœ¬ã®æ–‡åŒ–éºç”£ã¨ã—ã¦ã®ä¾¡å€¤ã¯è¨ˆã‚ŠçŸ¥ã‚Œã¾ã›ã‚“ã€‚ç‰¹ã«å†¬å­£ã«ã¯ã€é›ªã«è¦†ã‚ã‚ŒãŸåˆæŒé€ ã‚Šã®å®¶å±‹ãŒå¹»æƒ³çš„ãªç¾ã—ã•ã‚’æ¼”å‡ºã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å†¬ã®é›ªæ™¯è‰²ã®é­…åŠ›ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-winter-beauty',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç™½éŠ€ã«åŒ…ã¾ã‚ŒãŸå†¬ã®ã“ãã‚Šã“ã®é‡Œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'winter-beauty-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å†¬ã®ã“ãã‚Šã“ã®é‡Œã¯ã€æ·±ã„é›ªã«è¦†ã‚ã‚ŒãŸç¥ç§˜çš„ãªä¸–ç•Œã¸ã¨å¤‰è²Œã—ã¾ã™ã€‚åˆæŒé€ ã‚Šã®å±‹æ ¹ã«ç©ã‚‚ã£ãŸé›ªã¯ã€ã¾ã‚‹ã§ç™½ã„å¸½å­ã‚’ã‹ã¶ã£ãŸã‚ˆã†ãªæ„›ã‚‰ã—ã„å§¿ã‚’è¦‹ã›ã€è¨ªã‚Œã‚‹äººã€…ã®å¿ƒã‚’å’Œã¾ã›ã¾ã™ã€‚é›ªåŒ–ç²§ã—ãŸå¤æ°‘å®¶ã¨å‘¨å›²ã®å±±ã€…ãŒç¹”ã‚Šãªã™é¢¨æ™¯ã¯ã€ã¾ã•ã«æ—¥æœ¬ã®å†¬ã®çµ¶æ™¯ã¨ã„ãˆã‚‹ã§ã—ã‚‡ã†ã€‚é™å¯‚ã«åŒ…ã¾ã‚ŒãŸé›ªæ™¯è‰²ã®ä¸­ã‚’æ­©ãã¨ã€æ™‚ãŒæ­¢ã¾ã£ãŸã‹ã®ã‚ˆã†ãªéŒ¯è¦šã‚’è¦šãˆã¾ã™ã€‚ç‰¹ã«æ—©æœã‚„å¤•æš®ã‚Œæ™‚ã«ã¯ã€é›ªé¢ã«åå°„ã™ã‚‹å…‰ãŒç¾ã—ãã€å†™çœŸæ’®å½±ã«ã‚‚æœ€é©ãªæ™‚é–“å¸¯ã¨ãªã‚Šã¾ã™ã€‚ã“ã®å­£ç¯€ãªã‚‰ã§ã¯ã®ç‰¹åˆ¥ãªç¾ã—ã•ãŒã€å¤šãã®äººã€…ã‚’é­…äº†ã—ç¶šã‘ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ•£ç­–ã®æ¥½ã—ã¿æ–¹ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-exploration',
        style: 'h2',
        children: [{ _type: 'span', text: 'å†¬ã®ã“ãã‚Šã“ã®é‡Œæ•£ç­–ã®ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'exploration-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å†¬ã®ã“ãã‚Šã“ã®é‡Œã‚’æ•£ç­–ã™ã‚‹éš›ã¯ã€ååˆ†ãªé˜²å¯’å¯¾ç­–ãŒå¿…è¦ã§ã™ã€‚é›ªé“ã‚’æ­©ããŸã‚ã€æ»‘ã‚Šã«ãã„é´ã®ç€ç”¨ã‚‚é‡è¦ã§ã™ã€‚é›†è½å†…ã«ã¯æ­´å²ã‚ã‚‹åˆæŒé€ ã‚Šã®å»ºç‰©ãŒç‚¹åœ¨ã—ã¦ãŠã‚Šã€ãã‚Œãã‚ŒãŒç•°ãªã‚‹è¡¨æƒ…ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚æ°‘ä¿—é¤¨ã‚„è³‡æ–™é¤¨ã§ã¯ã€ã“ã®åœ°åŸŸã®æ­´å²ã‚„æ–‡åŒ–ã«ã¤ã„ã¦å­¦ã¶ã“ã¨ãŒã§ãã€ã‚ˆã‚Šæ·±ã„ç†è§£ã‚’å¾—ã‚‰ã‚Œã¾ã™ã€‚åœ°å…ƒã®æ–¹ã€…ãŒå–¶ã‚€é£Ÿäº‹å‡¦ã§ã¯ã€éƒ·åœŸæ–™ç†ã‚’å‘³ã‚ã„ãªãŒã‚‰æ¸©ã‹ã„ã²ã¨ã¨ãã‚’éã”ã™ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ã‚†ã£ãã‚Šã¨æ™‚é–“ã‚’ã‹ã‘ã¦æ•£ç­–ã™ã‚‹ã“ã¨ã§ã€ã“ã®ç§˜å¢ƒã®é­…åŠ›ã‚’å­˜åˆ†ã«æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å†™çœŸæ’®å½±ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-photography',
        style: 'h2',
        children: [{ _type: 'span', text: 'çµ¶æ™¯ã‚’æ’®å½±ã™ã‚‹ãƒ™ã‚¹ãƒˆã‚¹ãƒãƒƒãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'photography-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã“ãã‚Šã“ã®é‡Œã¯å†™çœŸæ„›å¥½å®¶ã«ã¨ã£ã¦çµ¶å¥½ã®æ’®å½±ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚ç‰¹ã«å±•æœ›å°ã‹ã‚‰ã®å…¨æ™¯ã¯åœ§å·»ã§ã€é›ªã«è¦†ã‚ã‚ŒãŸé›†è½å…¨ä½“ã‚’ä¸€æœ›ã§ãã¾ã™ã€‚æœéœ§ãŒç«‹ã¡è¾¼ã‚ã‚‹æ—©æœã‚„ã€å¤•æ—¥ã«æŸ“ã¾ã‚‹é›ªæ™¯è‰²ã¯ç‰¹ã«ç¾ã—ãã€ç¥ç§˜çš„ãªé›°å›²æ°—ã‚’æ¼”å‡ºã—ã¾ã™ã€‚å€‹ã€…ã®åˆæŒé€ ã‚Šå»ºç‰©ã‚‚é­…åŠ›çš„ãªè¢«å†™ä½“ã§ã€é›ªæ™¯è‰²ã¨ã®å¯¾æ¯”ãŒå°è±¡çš„ãªå†™çœŸã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚æ’®å½±ã®éš›ã¯ã€åœ°å…ƒã®æ–¹ã€…ã¸ã®é…æ…®ã‚’å¿˜ã‚Œãšã«ã€ãƒãƒŠãƒ¼ã‚’å®ˆã£ã¦æ¥½ã—ã¿ã¾ã—ã‚‡ã†ã€‚å¯’ã„ç’°å¢ƒä¸‹ã§ã®æ’®å½±ã«ãªã‚‹ãŸã‚ã€ã‚«ãƒ¡ãƒ©ã®ãƒãƒƒãƒ†ãƒªãƒ¼ç®¡ç†ã«ã‚‚æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚¢ã‚¯ã‚»ã‚¹ã¨è¨ªå•æ™‚ã®æ³¨æ„ç‚¹ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-access',
        style: 'h2',
        children: [{ _type: 'span', text: 'å†¬å­£ã®ã‚¢ã‚¯ã‚»ã‚¹ã¨å®‰å…¨ãªè¨ªå•ã®ãŸã‚ã«', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'access-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å†¬å­£ã®ã“ãã‚Šã“ã®é‡Œã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«ã¯ã€é›ªé“é‹è»¢ã®çµŒé¨“ãŒå¿…è¦ã§ã™ã€‚ã‚¹ã‚¿ãƒƒãƒ‰ãƒ¬ã‚¹ã‚¿ã‚¤ãƒ¤ã‚„ã‚¿ã‚¤ãƒ¤ãƒã‚§ãƒ¼ãƒ³ã®æº–å‚™ã¯å¿…é ˆã¨ãªã‚Šã¾ã™ã€‚å…¬å…±äº¤é€šæ©Ÿé–¢ã‚‚é‹è¡ŒçŠ¶æ³ãŒå¤©å€™ã«å·¦å³ã•ã‚Œã‚‹ãŸã‚ã€äº‹å‰ã®ç¢ºèªãŒé‡è¦ã§ã™ã€‚é›†è½å†…ã¯ç©é›ªã«ã‚ˆã‚Šè¶³å ´ãŒæ‚ªããªã‚‹ãŸã‚ã€æ­©ãã‚„ã™ã„é´ã¨é˜²å¯’ç€ã®æº–å‚™ã‚’ã—ã¾ã—ã‚‡ã†ã€‚å–¶æ¥­æ™‚é–“ã‚„æ–½è¨­ã®é–‹é¤¨çŠ¶æ³ã‚‚å†¬å­£ã«ã¯å¤‰æ›´ã«ãªã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã€è¨ªå•å‰ã®ç¢ºèªã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚å®‰å…¨ç¬¬ä¸€ã§ã€ç„¡ç†ã®ãªã„è¨ˆç”»ã‚’ç«‹ã¦ã¦è¨ªå•ã—ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å—ç ºå¸‚ã®å†¬ã®ã“ãã‚Šã“ã®é‡Œã¯ã€é›ªæ™¯è‰²ã«åŒ…ã¾ã‚ŒãŸç§˜å¢ƒã®ç¾ã—ã•ã‚’å ªèƒ½ã§ãã‚‹ç‰¹åˆ¥ãªå ´æ‰€ã§ã™ã€‚æ—¥æœ¬ã®åŸé¢¨æ™¯ã‚’ãœã²ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬31è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 122æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandThirtyFirstArticle();
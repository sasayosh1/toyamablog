const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentyNinthArticle() {
  try {
    console.log('ç¬¬29è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: kurobe-city-1 (ãã‚ã¹ç‰§å ´ã¾ãã°ã®é¢¨)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "kurobe-city-1"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€ãã‚ã¹ç‰§å ´ã¾ãã°ã®é¢¨ã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é»’éƒ¨å¸‚ã«ã‚ã‚‹ãã‚ã¹ç‰§å ´ã¾ãã°ã®é¢¨ã§å‡ºä¼šãˆã‚‹ãƒ¤ã‚®ã¨ãƒãƒ‹ãƒ¼ã€‚ã®ã‚“ã³ã‚Šã¨ã—ãŸå½¼ã‚‰ã®æ—¥å¸¸ã‚’çœºã‚ã‚‹ç™’ã—ã®æ™‚é–“ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ãã‚ã¹ç‰§å ´ã¾ãã°ã®é¢¨ã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-farm',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãã‚ã¹ç‰§å ´ã¾ãã°ã®é¢¨ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'farm-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãã‚ã¹ç‰§å ´ã¾ãã°ã®é¢¨ã¯é»’éƒ¨å¸‚ã«ã‚ã‚‹ä½“é¨“å‹ç‰§å ´ã§ã€è‡ªç„¶è±Šã‹ãªç’°å¢ƒã®ä¸­ã§æ§˜ã€…ãªå‹•ç‰©ãŸã¡ã¨è§¦ã‚Œåˆã†ã“ã¨ãŒã§ãã‚‹ç™’ã—ã®ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚ç«‹å±±é€£å³°ã‚’èƒŒæ™¯ã«ã—ãŸé›„å¤§ãªæ™¯è‰²ã®ä¸­ã«ä½ç½®ã—ã€éƒ½å¸‚éƒ¨ã§ã¯å‘³ã‚ãˆãªã„é–‹æ”¾æ„Ÿã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰§å ´ã§ã¯å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ã ã‘ã§ãªãã€æ–°é®®ãªç‰›ä¹³ã‚’ä½¿ã£ãŸä¹³è£½å“ã®è²©å£²ã‚„ã€å­£ç¯€ã”ã¨ã®è¾²æ¥­ä½“é¨“ãªã©ã‚‚æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚å®¶æ—é€£ã‚Œã‚„å‹•ç‰©å¥½ãã®æ–¹ã€…ã«äººæ°—ã®æ–½è¨­ã§ã€ç‰¹ã«é€±æœ«ã«ã¯å¤šãã®æ¥å ´è€…ã§è³‘ã‚ã„ã¾ã™ã€‚è‡ªç„¶ã¨å‹•ç‰©ã«å›²ã¾ã‚ŒãŸç’°å¢ƒã§ã€æ—¥å¸¸ã®ç–²ã‚Œã‚’ç™’ã™ã“ã¨ãŒã§ãã‚‹ç‰¹åˆ¥ãªå ´æ‰€ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ãƒ¤ã‚®ã®æ„›ã‚‰ã—ã•ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-goats',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒ¤ã‚®ãŸã¡ã®å€‹æ€§è±Šã‹ãªé­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'goats-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãã‚ã¹ç‰§å ´ã®ãƒ¤ã‚®ãŸã¡ã¯ã€ãã‚Œãã‚ŒãŒå€‹æ€§çš„ã§æ„›ã‚‰ã—ã„å­˜åœ¨ã§ã™ã€‚å¥½å¥‡å¿ƒæ—ºç››ã§äººæ‡ã£ã“ã„æ€§æ ¼ã®å­ã‚‚ã„ã‚Œã°ã€å°‘ã—è­¦æˆ’å¿ƒãŒå¼·ãã¦ãƒã‚¤ãƒšãƒ¼ã‚¹ãªå­ã‚‚ãŠã‚Šã€è¦‹ã¦ã„ã‚‹ã ã‘ã§ã‚‚æ¥½ã—ã‚ã¾ã™ã€‚ã‚¨ã‚µã‚„ã‚Šä½“é¨“ã§ã¯ã€ãƒ¤ã‚®ãŸã¡ãŒæ‰‹ã®ã²ã‚‰ã‹ã‚‰ç›´æ¥ã‚¨ã‚µã‚’é£Ÿã¹ã¦ãã‚Œã‚‹è²´é‡ãªä½“é¨“ãŒã§ãã€ãã®æ™‚ã®å„ªã—ã„è¡¨æƒ…ã¯å¿ƒã‚’æ¸©ã‹ãã—ã¦ãã‚Œã¾ã™ã€‚è§’ã®å½¢ã‚„æ¯›è‰²ã€ä½“ã®å¤§ãã•ã‚‚ãã‚Œãã‚Œç•°ãªã‚Šã€ä¸€é ­ä¸€é ­ã«å€‹æ€§ãŒã‚ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‹ã‚Šã¾ã™ã€‚ç‰¹ã«å­ãƒ¤ã‚®ãŒã„ã‚‹æ™‚æœŸã¯ã€ãã®æ„›ã‚‰ã—ã„ä»•è‰ã«å¤šãã®æ¥å ´è€…ãŒç™’ã•ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ãƒãƒ‹ãƒ¼ã¨ã®è§¦ã‚Œåˆã„ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-ponies',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒãƒ‹ãƒ¼ã¨ã®ç‰¹åˆ¥ãªè§¦ã‚Œåˆã„ä½“é¨“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'ponies-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãã‚ã¹ç‰§å ´ã®ãƒãƒ‹ãƒ¼ã¯ç©ã‚„ã‹ã§å„ªã—ã„æ€§æ ¼ã§ã€å°ã•ãªãŠå­æ§˜ã§ã‚‚å®‰å¿ƒã—ã¦è§¦ã‚Œåˆã†ã“ã¨ãŒã§ãã¾ã™ã€‚é€šå¸¸ã®é¦¬ã‚ˆã‚Šã‚‚å°æŸ„ãªãŸã‚ã€å­ã©ã‚‚ãŸã¡ã«ã¨ã£ã¦ã¯è¦ªã—ã¿ã‚„ã™ã„å­˜åœ¨ã§ã™ã€‚ãƒãƒ‹ãƒ¼ã®ä¹—é¦¬ä½“é¨“ã§ã¯ã€å°‚é–€ã‚¹ã‚¿ãƒƒãƒ•ãŒä¸å¯§ã«æŒ‡å°ã—ã¦ãã‚Œã‚‹ã®ã§ã€åˆå¿ƒè€…ã§ã‚‚å®‰å¿ƒã—ã¦æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒãƒ‹ãƒ¼ã®æ¸©ã‹ãªä½“æ¸©ã¨å„ªã—ã„ç›®ã‚’é–“è¿‘ã§æ„Ÿã˜ã‚‹ã“ã¨ã§ã€å‹•ç‰©ã¨ã®ç‰¹åˆ¥ãªçµ†ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ–ãƒ©ãƒƒã‚·ãƒ³ã‚°ä½“é¨“ãªã©ã‚‚ç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€ãƒãƒ‹ãƒ¼ã¨ã®ã‚ˆã‚Šæ·±ã„äº¤æµã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è‡ªç„¶ç’°å¢ƒã®ç´ æ™´ã‚‰ã—ã•ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-nature',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç«‹å±±é€£å³°ã‚’èƒŒæ™¯ã«ã—ãŸé›„å¤§ãªè‡ªç„¶ç’°å¢ƒ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'nature-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç‰§å ´ã®æœ€å¤§ã®é­…åŠ›ã®ä¸€ã¤ã¯ã€ç«‹å±±é€£å³°ã®é›„å¤§ãªæ™¯è‰²ã‚’èƒŒæ™¯ã«ã—ãŸç´ æ™´ã‚‰ã—ã„è‡ªç„¶ç’°å¢ƒã§ã™ã€‚æ¸…ã€…ã—ã„ç©ºæ°—ã®ä¸­ã§å‹•ç‰©ãŸã¡ã¨è§¦ã‚Œåˆã†ä½“é¨“ã¯ã€éƒ½å¸‚éƒ¨ã§ã¯æ±ºã—ã¦å‘³ã‚ã†ã“ã¨ã®ã§ããªã„è´…æ²¢ãªã²ã¨ã¨ãã§ã™ã€‚å››å­£ã‚’é€šã˜ã¦ç•°ãªã‚‹è¡¨æƒ…ã‚’è¦‹ã›ã‚‹å±±ã€…ã®æ™¯è‰²ã¯ã€å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ã‚’ã‚ˆã‚Šç‰¹åˆ¥ãªã‚‚ã®ã«ã—ã¦ãã‚Œã¾ã™ã€‚åºƒã€…ã¨ã—ãŸç‰§è‰åœ°ã§è‡ªç”±ã«éã”ã™å‹•ç‰©ãŸã¡ã®å§¿ã¯ã€ã¾ã•ã«ç†æƒ³çš„ãªç‰§å ´é¢¨æ™¯ãã®ã‚‚ã®ã§ã™ã€‚ã“ã®ç’°å¢ƒã ã‹ã‚‰ã“ãã€å‹•ç‰©ãŸã¡ã‚‚ã®ã³ã®ã³ã¨å¥åº·ã«è‚²ã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¨ªå•ã®ãŠã™ã™ã‚ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visit',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç‰§å ´è¦‹å­¦ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visit-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãã‚ã¹ç‰§å ´ã‚’è¨ªã‚Œã‚‹éš›ã¯ã€å‹•ç‰©ãŸã¡ãŒæ´»ç™ºã«å‹•ãå›ã‚‹åˆå‰ä¸­ãŒãŠã™ã™ã‚ã§ã™ã€‚ã‚¨ã‚µã‚„ã‚Šä½“é¨“ã‚„ãµã‚Œã‚ã„ä½“é¨“ã‚’æ¥½ã—ã‚“ã å¾Œã¯ã€ç‰§å ´å†…ã®ã‚«ãƒ•ã‚§ã§åœ°å…ƒã®æ–°é®®ãªä¹³è£½å“ã‚’å‘³ã‚ã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚å¤©æ°—ã®è‰¯ã„æ—¥ã«ã¯ç«‹å±±é€£å³°ã®æ™¯è‰²ã‚‚ä¸€å±¤ç¾ã—ãã€è¨˜å¿µæ’®å½±ã«ã‚‚æœ€é©ã§ã™ã€‚å°ã•ãªãŠå­æ§˜é€£ã‚Œã®å ´åˆã¯ã€å‹•ç‰©ã«é©šã‹ãªã„ã‚ˆã†äº‹å‰ã«èª¬æ˜ã—ã¦ãŠãã¨å®‰å¿ƒã§ã™ã€‚ã‚†ã£ãã‚Šã¨ã—ãŸæ™‚é–“ã®æµã‚Œã®ä¸­ã§ã€å¿ƒã®ç™’ã—ã‚’æ±‚ã‚ã‚‹æ–¹ã«ã¯ç‰¹ã«ãŠã™ã™ã‚ã®ã‚¹ãƒãƒƒãƒˆã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãã‚ã¹ç‰§å ´ã®ãƒ¤ã‚®ã¨ãƒãƒ‹ãƒ¼ã¯å¿ƒã‚’ç™’ã—ã¦ãã‚Œã‚‹ç´ æ•µãªå­˜åœ¨ã§ã™ã€‚é›„å¤§ãªè‡ªç„¶ç’°å¢ƒã®ä¸­ã§ã®å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ã‚’ãœã²ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬29è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 189æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentyNinthArticle();
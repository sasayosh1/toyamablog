const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandSeventhArticle() {
  try {
    console.log('ç¬¬7è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: yatsuo-town (è¶Šä¸­å…«å°¾è¦³å…‰ä¼šé¤¨ãƒ»æ›³å±±å±•ç¤ºé¤¨)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "yatsuo-town"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€æ›³å±±å±•ç¤ºé¤¨ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å…«å°¾ç”ºã«ã‚ã‚‹è¶Šä¸­å…«å°¾è¦³å…‰ä¼šé¤¨ï¼ˆæ›³å±±å±•ç¤ºé¤¨ï¼‰ã¯ã€ä¼çµ±çš„ãªæ›³å±±æ–‡åŒ–ã‚’å­¦ã¹ã‚‹è²´é‡ãªæ–½è¨­ã§ã™ã€‚æ–‡åŒ–ã®æ—¥ã¯å…¥é¤¨ç„¡æ–™ã¨ã„ã†å¬‰ã—ã„ç‰¹å…¸ã‚‚ã‚ã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ–½è¨­æ¦‚è¦ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-overview',
        style: 'h2',
        children: [{ _type: 'span', text: 'è¶Šä¸­å…«å°¾è¦³å…‰ä¼šé¤¨ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'overview-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'è¶Šä¸­å…«å°¾è¦³å…‰ä¼šé¤¨ã¯ã€å¯Œå±±çœŒã®ä¼çµ±çš„ãªæ›³å±±æ–‡åŒ–ã‚’ä¿å­˜ãƒ»å±•ç¤ºã™ã‚‹å°‚é–€æ–½è¨­ã¨ã—ã¦è¨­ç«‹ã•ã‚Œã¾ã—ãŸã€‚é¤¨å†…ã«ã¯å®Ÿç‰©ã®æ›³å±±ãŒå±•ç¤ºã•ã‚Œã¦ãŠã‚Šã€ãã®ç²¾å·§ãªè£…é£¾ã‚„æ§‹é€ ã‚’é–“è¿‘ã§è¦³å¯Ÿã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å…«å°¾ç”ºã®æ­´å²ã‚„æ–‡åŒ–ã«ã¤ã„ã¦ã‚‚è©³ã—ãå­¦ã¶ã“ã¨ãŒã§ãã€åœ°åŸŸã®æ–‡åŒ–çš„ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç†è§£ã™ã‚‹ã®ã«æœ€é©ãªå ´æ‰€ã§ã™ã€‚è¦³å…‰å®¢ã ã‘ã§ãªãã€åœ°å…ƒã®æ–¹ã€…ã«ã‚‚æ„›ã•ã‚Œç¶šã‘ã¦ã„ã‚‹æ–‡åŒ–æ–½è¨­ã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ›³å±±ã®é­…åŠ›ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-hikiyama',
        style: 'h2',
        children: [{ _type: 'span', text: 'ä¼çµ±ã®æ›³å±±æ–‡åŒ–ã¨å±•ç¤º', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'hikiyama-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ›³å±±ã¯æ±Ÿæˆ¸æ™‚ä»£ã‹ã‚‰ç¶šãå¯Œå±±çœŒã®ä¼çµ±çš„ãªç¥­ã‚Šæ–‡åŒ–ã®è±¡å¾´ã§ã™ã€‚å±•ç¤ºã•ã‚Œã¦ã„ã‚‹æ›³å±±ã¯ã€ç†Ÿç·´ã®è·äººã«ã‚ˆã£ã¦ä½œã‚‰ã‚ŒãŸç¾è¡“å·¥èŠ¸å“ã§ã‚‚ã‚ã‚Šã€ãã®è£…é£¾ã®ç¾ã—ã•ã¨æŠ€è¡“ã®é«˜ã•ã«é©šã‹ã•ã‚Œã¾ã™ã€‚é‡‘ç®”ã‚„æ¼†å¡—ã‚Šã€ç²¾å¯†ãªå½«åˆ»ãªã©ãŒæ–½ã•ã‚ŒãŸæ›³å±±ã¯ã€æ—¥æœ¬ã®ä¼çµ±å·¥èŠ¸ã®ç²‹ã‚’é›†ã‚ãŸå‚‘ä½œã¨ã„ãˆã‚‹ã§ã—ã‚‡ã†ã€‚å®Ÿéš›ã®ç¥­ã‚Šã§ã¯åŠ›å¼·ãå¼•ã‹ã‚Œã‚‹æ›³å±±ã‚’ã€ã“ã“ã§ã¯é™ã‹ã«é‘‘è³ã™ã‚‹ã“ã¨ãŒã§ãã€ãã®ç´°éƒ¨ã¾ã§è©³ã—ãè¦³å¯Ÿã§ãã‚‹è²´é‡ãªæ©Ÿä¼šã¨ãªã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å…«å°¾ç”ºã®æ­´å²ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-history',
        style: 'h2',
        children: [{ _type: 'span', text: 'å…«å°¾ç”ºã®æ­´å²ã¨æ–‡åŒ–', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'history-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å…«å°¾ç”ºã¯å¤ãã‹ã‚‰äº¤é€šã®è¦è¡ã¨ã—ã¦æ „ãˆãŸæ­´å²ã‚ã‚‹ç”ºã§ã™ã€‚æ±Ÿæˆ¸æ™‚ä»£ã«ã¯é£›é¨¨è¡—é“ã®å®¿å ´ç”ºã¨ã—ã¦å¤šãã®äººã€…ãŒè¡Œãäº¤ã„ã€å•†æ¥­ã‚„æ–‡åŒ–ãŒç™ºé”ã—ã¾ã—ãŸã€‚ãã®ç¹æ „ã®ä¸­ã§ç”Ÿã¾ã‚ŒãŸæ›³å±±ç¥­ã‚Šã¯ã€ç”ºã®äººã€…ã®çµæŸã¨èª‡ã‚Šã®è±¡å¾´ã¨ã—ã¦ç¾ä»£ã¾ã§å—ã‘ç¶™ãŒã‚Œã¦ã„ã¾ã™ã€‚è¦³å…‰ä¼šé¤¨ã§ã¯ã€ãã†ã—ãŸå…«å°¾ç”ºã®è±Šã‹ãªæ­´å²ã¨ã€ç¥­ã‚Šã‚’æ”¯ãˆã¦ããŸäººã€…ã®æƒ³ã„ã«ã¤ã„ã¦ã‚‚å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ–‡åŒ–ã®æ—¥ç‰¹å…¸ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-culture-day',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ–‡åŒ–ã®æ—¥ã®ç‰¹åˆ¥ã‚µãƒ¼ãƒ“ã‚¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'culture-day-content',
        style: 'normal',
        children: [{ _type: 'span', text: '11æœˆ3æ—¥ã®æ–‡åŒ–ã®æ—¥ã«ã¯ã€å…¥é¤¨æ–™ãŒç„¡æ–™ã«ãªã‚‹å¬‰ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æ—¥ã¯ç‰¹ã«å¤šãã®æ–¹ãŒè¨ªã‚Œã€å®¶æ—é€£ã‚Œã‚„è¦³å…‰å®¢ã§è³‘ã‚ã„ã¾ã™ã€‚æ–‡åŒ–ã®æ—¥ã«ãµã•ã‚ã—ãã€æ—¥æœ¬ã®ä¼çµ±æ–‡åŒ–ã§ã‚ã‚‹æ›³å±±ã‚’ç„¡æ–™ã§è¦‹å­¦ã§ãã‚‹çµ¶å¥½ã®æ©Ÿä¼šã§ã™ã€‚æ™®æ®µã¯æœ‰æ–™ã®æ–½è¨­ã‚’ç„¡æ–™ã§æ¥½ã—ã‚ã‚‹ãŸã‚ã€ã“ã®æ—¥ã‚’ç‹™ã£ã¦è¨ªå•ã•ã‚Œã‚‹æ–¹ã‚‚å¤šãã€åœ°åŸŸæ–‡åŒ–ã«è§¦ã‚Œã‚‹ç´ æ™´ã‚‰ã—ã„ä¸€æ—¥ã¨ãªã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¦‹å­¦ã®ãƒã‚¤ãƒ³ãƒˆï¼ˆç´„120æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visit',
        style: 'h2',
        children: [{ _type: 'span', text: 'è¦‹å­¦æ™‚ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visit-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ›³å±±ã®ç´°éƒ¨ã®è£…é£¾ã‚’ã˜ã£ãã‚Šã¨è¦³å¯Ÿã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚é‡‘ç®”ã®è¼ãã‚„ç²¾å¯†ãªå½«åˆ»ãªã©ã€è·äººã®æŠ€è¡“ã®é«˜ã•ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€æ›³å±±ã®æ§‹é€ ã‚„ç¥­ã‚Šã§ã®å½¹å‰²ã«ã¤ã„ã¦èª¬æ˜ã‚’èª­ã¿ãªãŒã‚‰è¦‹å­¦ã™ã‚‹ã¨ã€ã‚ˆã‚Šæ·±ãç†è§£ã§ãã¾ã™ã€‚å†™çœŸæ’®å½±ã‚‚å¯èƒ½ãªã®ã§ã€ç¾ã—ã„æ›³å±±ã®è¨˜éŒ²ã‚’æ®‹ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'è¶Šä¸­å…«å°¾è¦³å…‰ä¼šé¤¨ã¯ã€å¯Œå±±çœŒã®ä¼çµ±çš„ãªæ›³å±±æ–‡åŒ–ã‚’èº«è¿‘ã«æ„Ÿã˜ã‚‰ã‚Œã‚‹è²´é‡ãªæ–½è¨­ã§ã™ã€‚æ–‡åŒ–ã®æ—¥ã®ç„¡æ–™å…¥é¤¨æ—¥ã‚’åˆ©ç”¨ã—ã¦ã€ãœã²ä¸€åº¦è¶³ã‚’é‹ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚æ—¥æœ¬ã®ä¼çµ±æ–‡åŒ–ã®ç´ æ™´ã‚‰ã—ã•ã‚’å†ç™ºè¦‹ã§ãã‚‹ã¯ãšã§ã™ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬7è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 203æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandSeventhArticle();
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandThirtyThirdArticle() {
  try {
    console.log('ç¬¬33è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: tonami-city-2023-park-kira-kira-mission-2023 (ç ºæ³¢å¸‚ã®KIRA KIRA MISSION)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "tonami-city-2023-park-kira-kira-mission-2023"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã®KIRA KIRA MISSIONã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç ºæ³¢å¸‚ã®ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã§é–‹å‚¬ã•ã‚ŒãŸã€ŒKIRA KIRA MISSION 2023ã€ã€‚å…‰ã¨èŠ±ãŒç¹”ã‚Šãªã™å¹»æƒ³çš„ãªã‚¤ãƒ™ãƒ³ãƒˆã®é­…åŠ›ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: KIRA KIRA MISSION 2023ã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-mission',
        style: 'h2',
        children: [{ _type: 'span', text: 'KIRA KIRA MISSION 2023ã®é­…åŠ›ã¨ã‚³ãƒ³ã‚»ãƒ—ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'mission-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'KIRA KIRA MISSION 2023ã¯ã€ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã§é–‹å‚¬ã•ã‚ŒãŸå…‰ã¨èŠ±ã®ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚ã€ŒKIRA KIRAï¼ˆã‚­ãƒ©ã‚­ãƒ©ï¼‰ã€ã¨ã„ã†åå‰ãŒç¤ºã™ã‚ˆã†ã«ã€ã‚¤ãƒ«ãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ã¨èŠ±ã€…ãŒç¹”ã‚Šãªã™è¼ãä¸–ç•Œã‚’ä½“é¨“ã§ãã‚‹ç‰¹åˆ¥ãªä¼ç”»ã§ã—ãŸã€‚ç ºæ³¢å¸‚ã¯å…¨å›½æœ‰æ•°ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ã®ç”£åœ°ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ãŠã‚Šã€ãã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ã¨æœ€æ–°ã®ç…§æ˜æŠ€è¡“ã‚’çµ„ã¿åˆã‚ã›ãŸé©æ–°çš„ãªã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦æ³¨ç›®ã‚’é›†ã‚ã¾ã—ãŸã€‚æ—¥ä¸­ã®ç¾ã—ã„ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ç•‘ã¨ã¯å…¨ãç•°ãªã‚‹ã€å¤œã®å¹»æƒ³çš„ãªå…‰æ™¯ã‚’æ¼”å‡ºã—ã€å¤šãã®æ¥å ´è€…ã«æ„Ÿå‹•ã‚’ä¸ãˆãŸç‰¹åˆ¥ãªã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã®é­…åŠ›ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tulip-park',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã®ç‰¹åˆ¥ãªé­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tulip-park-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã¯ã€æ˜¥ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ãƒ•ã‚§ã‚¢æœŸé–“ä¸­ã«300ä¸‡æœ¬ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ãŒå’²ãèª‡ã‚‹å›½å†…æœ€å¤§ç´šã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã§ã™ã€‚è‰²ã¨ã‚Šã©ã‚Šã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ãŒæãç¾ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ã€å“ç¨®ã”ã¨ã«ç•°ãªã‚‹é–‹èŠ±æ™‚æœŸã‚’è¨ˆç®—ã—ãŸæ¤æ ½è¨­è¨ˆã¯ã€ã¾ã•ã«èŠ¸è¡“ä½œå“ã®ã‚ˆã†ãªç¾ã—ã•ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚KIRA KIRA MISSION 2023ã§ã¯ã€ã“ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ã®æ˜¼é–“ã®ç¾ã—ã•ã«åŠ ãˆã¦ã€å¤œé–“ã®æ–°ãŸãªé­…åŠ›ã‚’ç™ºè¦‹ã§ãã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã¨ãªã‚Šã¾ã—ãŸã€‚æ™®æ®µã¯å¤œé–“ã«å…¥ã‚‹ã“ã¨ã®ã§ããªã„å…¬åœ’ãŒç‰¹åˆ¥ã«é–‹æ”¾ã•ã‚Œã€å‚åŠ è€…ã«ã¨ã£ã¦è²´é‡ãªä½“é¨“ã¨ãªã£ãŸã®ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å…‰ã®æ¼”å‡ºã¨ã‚¤ãƒ«ãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-illumination',
        style: 'h2',
        children: [{ _type: 'span', text: 'å…‰ã®èŠ¸è¡“ãŒç”Ÿã¿å‡ºã™å¹»æƒ³çš„ãªä¸–ç•Œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'illumination-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'KIRA KIRA MISSION 2023ã®æœ€å¤§ã®è¦‹ã©ã“ã‚ã¯ã€ç²¾å¯†ã«è¨ˆç®—ã•ã‚ŒãŸå…‰ã®æ¼”å‡ºã§ã—ãŸã€‚ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ã®èŠ±å£‡ã‚’ç…§ã‚‰ã™ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã¯ã€æ˜¼é–“ã¨ã¯å…¨ãç•°ãªã‚‹å¹»æƒ³çš„ãªç¾ã—ã•ã‚’æ¼”å‡ºã—ã¾ã—ãŸã€‚LEDç…§æ˜ã«ã‚ˆã‚‹è‰²ã¨ã‚Šã©ã‚Šã®å…‰ãŒã€ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ã®è‰²å½©ã¨èª¿å’Œã—ã€ã¾ã‚‹ã§ç•°ä¸–ç•Œã«ã„ã‚‹ã‚ˆã†ãªæ„Ÿè¦šã‚’è¦šãˆã•ã›ã¦ãã‚Œã¾ã™ã€‚å…‰ã®å¼·å¼±ã‚„è‰²ã®å¤‰åŒ–ã«ã‚ˆã‚Šã€æ™‚é–“ã¨ã¨ã‚‚ã«è¡¨æƒ…ã‚’å¤‰ãˆã‚‹æ¼”å‡ºã¯ã€è¨ªã‚Œã‚‹äººã€…ã‚’é­…äº†ã—ç¶šã‘ã¾ã—ãŸã€‚ã¾ãŸã€æ°´é¢ã«æ˜ ã‚‹å…‰ã®åå°„ã‚„ã€æœ¨ã€…ã‚’ç…§ã‚‰ã™ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ãªã©ã€ç´°éƒ¨ã«ã¾ã§ã“ã ã‚ã£ãŸæ¼”å‡ºãŒä¼šå ´å…¨ä½“ã‚’ç¾ã—ãå½©ã‚Šã¾ã—ãŸã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¥å ´è€…ã®ä½“é¨“ã¨æ„Ÿå‹•ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visitor-experience',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¥å ´è€…ãŒä½“é¨“ã—ãŸç‰¹åˆ¥ãªæ„Ÿå‹•ã®ç¬é–“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visitor-experience-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'KIRA KIRA MISSION 2023ã«å‚åŠ ã—ãŸæ¥å ´è€…ã‹ã‚‰ã¯ã€å¤šãã®æ„Ÿå‹•ã®å£°ãŒèã‹ã‚Œã¾ã—ãŸã€‚æ™®æ®µè¦‹æ…£ã‚ŒãŸãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ãŒã€å¤œã®å…‰ã®æ¼”å‡ºã«ã‚ˆã‚Šå…¨ãåˆ¥ã®è¡¨æƒ…ã‚’è¦‹ã›ã‚‹ã“ã¨ã«é©šãã®å£°ãŒä¸ŠãŒã‚Šã¾ã—ãŸã€‚ã‚«ãƒƒãƒ—ãƒ«ã‚„å®¶æ—é€£ã‚Œã€å†™çœŸæ„›å¥½å®¶ãªã©ã€å¹…åºƒã„å±¤ã®æ¥å ´è€…ãŒç‰¹åˆ¥ãªæ™‚é–“ã‚’éã”ã™ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ç‰¹ã«å­ã©ã‚‚ãŸã¡ã¯å…‰ã‚‹èŠ±ç•‘ã«å¤§èˆˆå¥®ã—ã€å¤§äººã‚‚ç«¥å¿ƒã«æˆ»ã£ã¦æ¥½ã—ã‚€å§¿ãŒå¤šãè¦‹ã‚‰ã‚Œã¾ã—ãŸã€‚SNSã§ã®å†™çœŸæŠ•ç¨¿ã‚‚å¤šæ•°è¡Œã‚ã‚Œã€ç ºæ³¢å¸‚ã®æ–°ãŸãªé­…åŠ›ã¨ã—ã¦å…¨å›½ã«ç™ºä¿¡ã•ã‚Œã¾ã—ãŸã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚¤ãƒ™ãƒ³ãƒˆã®æ„ç¾©ã¨ä»Šå¾Œã¸ã®æœŸå¾…ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-significance',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚¤ãƒ™ãƒ³ãƒˆã®æ–‡åŒ–çš„æ„ç¾©ã¨ç¶™ç¶šã¸ã®æœŸå¾…', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'significance-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'KIRA KIRA MISSION 2023ã¯ã€ç ºæ³¢å¸‚ã®è¦³å…‰è³‡æºã§ã‚ã‚‹ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ã«æ–°ãŸãªä¾¡å€¤ã‚’åŠ ãˆãŸç”»æœŸçš„ãªã‚¤ãƒ™ãƒ³ãƒˆã§ã—ãŸã€‚å¾“æ¥ã®æ˜¥ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ãƒ•ã‚§ã‚¢ã¨ã¯ç•°ãªã‚‹å­£ç¯€ã‚„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã®é–‹å‚¬ã«ã‚ˆã‚Šã€å¹´é–“ã‚’é€šã˜ãŸè¦³å…‰åœ°ã¨ã—ã¦ã®é­…åŠ›ã‚’å‘ä¸Šã•ã›ã¾ã—ãŸã€‚æŠ€è¡“ã¨è‡ªç„¶ã®èª¿å’Œã¨ã„ã†ç¾ä»£çš„ãªãƒ†ãƒ¼ãƒã‚’ä½“ç¾ã—ãŸã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã€åœ°åŸŸæ´»æ€§åŒ–ã®æ–°ã—ã„æ‰‹æ³•ã¨ã—ã¦ã‚‚æ³¨ç›®ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»Šå¾Œã‚‚ç¶™ç¶šçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã“ã¨ã§ã€ç ºæ³¢å¸‚ã®æ–°ãŸãªåç‰©ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦å®šç€ã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'KIRA KIRA MISSION 2023ã¯å…‰ã¨èŠ±ãŒç¹”ã‚Šãªã™å¹»æƒ³çš„ãªä¸–ç•Œã‚’æ¼”å‡ºã—ãŸç‰¹åˆ¥ãªã‚¤ãƒ™ãƒ³ãƒˆã§ã—ãŸã€‚ç ºæ³¢å¸‚ã®æ–°ãŸãªé­…åŠ›ã‚’ç™ºè¦‹ã™ã‚‹æ©Ÿä¼šã¨ãªã‚Šã¾ã—ãŸã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬33è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 122æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandThirtyThirdArticle();
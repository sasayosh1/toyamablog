const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentySeventhArticle() {
  try {
    console.log('ç¬¬27è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: uozu-city-aquarium-3 (é­šæ´¥æ°´æ—é¤¨ã®ãƒšãƒ³ã‚®ãƒ³)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "uozu-city-aquarium-3"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€é­šæ´¥æ°´æ—é¤¨ã®ãƒšãƒ³ã‚®ãƒ³ã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é­šæ´¥æ°´æ—é¤¨ã§æš®ã‚‰ã™3ç¾½ã®ãƒšãƒ³ã‚®ãƒ³ã®æ„›ã‚‰ã—ã„æ—¥å¸¸ã€‚ãã‚Œãã‚Œå€‹æ€§è±Šã‹ãªå½¼ã‚‰ã®é­…åŠ›ã‚’ãŸã£ã·ã‚Šã¨ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é­šæ´¥æ°´æ—é¤¨ã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-aquarium',
        style: 'h2',
        children: [{ _type: 'span', text: 'é­šæ´¥æ°´æ—é¤¨ã¨ãƒšãƒ³ã‚®ãƒ³å±•ç¤ºã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'aquarium-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é­šæ´¥æ°´æ—é¤¨ã¯å¯Œå±±æ¹¾ã®æµ·æ´‹ç”Ÿç‰©ã‚’ä¸­å¿ƒã¨ã—ãŸåœ°åŸŸå¯†ç€å‹ã®æ°´æ—é¤¨ã¨ã—ã¦é•·å¹´è¦ªã—ã¾ã‚Œã¦ã„ã¾ã™ã€‚è¦æ¨¡ã¯å¤§ããã‚ã‚Šã¾ã›ã‚“ãŒã€ãã®åˆ†ä¸€ã¤ä¸€ã¤ã®å±•ç¤ºã«å·¥å¤«ãŒå‡ã‚‰ã•ã‚Œã¦ãŠã‚Šã€ç‰¹ã«ãƒšãƒ³ã‚®ãƒ³å±•ç¤ºã¯æ¥é¤¨è€…ã«äººæ°—ã®é«˜ã„ã‚³ãƒ¼ãƒŠãƒ¼ã§ã™ã€‚3ç¾½ã¨ã„ã†å°‘æ•°ç²¾é‹­ã®ãƒšãƒ³ã‚®ãƒ³ãŸã¡ã¯ã€ãã‚Œãã‚ŒãŒå€‹æ€§çš„ã§æ„›ã‚‰ã—ãã€ã‚¹ã‚¿ãƒƒãƒ•ã®çš†ã•ã‚“ã‚‚ä¸€ç¾½ä¸€ç¾½ã®æ€§æ ¼ã‚’ç†ŸçŸ¥ã—ãŸä¸å¯§ãªé£¼è‚²ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚ã“ã˜ã‚“ã¾ã‚Šã¨ã—ãŸç’°å¢ƒã ã‹ã‚‰ã“ãå®Ÿç¾ã§ãã‚‹ã€ãƒšãƒ³ã‚®ãƒ³ã¨ã®è·é›¢ã®è¿‘ã•ãŒé­šæ´¥æ°´æ—é¤¨ãªã‚‰ã§ã¯ã®é­…åŠ›ã§ã™ã€‚æ¥é¤¨è€…ã¯ãƒšãƒ³ã‚®ãƒ³ã®ç´°ã‹ãªä»•è‰ã‚„è¡¨æƒ…ã¾ã§è¦³å¯Ÿã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: 3ç¾½ã®ãƒšãƒ³ã‚®ãƒ³ã®å€‹æ€§ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-personalities',
        style: 'h2',
        children: [{ _type: 'span', text: '3ç¾½ãã‚Œãã‚Œã®å€‹æ€§è±Šã‹ãªé­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'personalities-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é­šæ´¥æ°´æ—é¤¨ã®3ç¾½ã®ãƒšãƒ³ã‚®ãƒ³ã¯ã€ãã‚Œãã‚ŒãŒå…¨ãç•°ãªã‚‹å€‹æ€§ã‚’æŒã£ã¦ãŠã‚Šã€è¦‹ã¦ã„ã‚‹ã ã‘ã§æ¥½ã—ããªã‚Šã¾ã™ã€‚æ´»ç™ºã§å¥½å¥‡å¿ƒæ—ºç››ãªå­ã€ãŠã£ã¨ã‚Šã¨ã—ã¦ã„ã¦ãƒã‚¤ãƒšãƒ¼ã‚¹ãªå­ã€ãã—ã¦å°‘ã—äººè¦‹çŸ¥ã‚Šã ã‘ã‚Œã©æ…£ã‚Œã‚‹ã¨ç”˜ãˆã‚“åŠã«ãªã‚‹å­ãªã©ã€ã¾ã‚‹ã§äººé–“ã®ã‚ˆã†ã«è±Šã‹ãªå€‹æ€§ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚é¤Œã®æ™‚é–“ã«ã¯å„ã€…ã®é£Ÿã¹æ–¹ã®é•ã„ã‚‚è¦³å¯Ÿã§ãã€æ³³ãæ–¹ã‚„ä¼‘æ†©ã®ä»•æ–¹ã«ã‚‚ãã‚Œãã‚Œã®ç‰¹å¾´ãŒç¾ã‚Œã¾ã™ã€‚ã‚¹ã‚¿ãƒƒãƒ•ã®æ–¹ã€…ã¯ä¸€ç¾½ä¸€ç¾½ã®æ€§æ ¼ã‚’ç†è§£ã—ã¦æ¥ã—ã¦ãŠã‚Šã€ãã®æ·±ã„æ„›æƒ…ãŒãƒšãƒ³ã‚®ãƒ³ãŸã¡ã®ç”Ÿãç”Ÿãã¨ã—ãŸå§¿ã«è¡¨ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ—¥å¸¸è¡Œå‹•ã®è¦³å¯Ÿï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-behavior',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒšãƒ³ã‚®ãƒ³ã®æ„›ã‚‰ã—ã„æ—¥å¸¸è¡Œå‹•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'behavior-content',
        style: 'normal',
        children: [{ _type: 'span', text: '3ç¾½ã®ãƒšãƒ³ã‚®ãƒ³ã®æ—¥å¸¸ã‚’è¦³å¯Ÿã—ã¦ã„ã‚‹ã¨ã€æ§˜ã€…ãªæ„›ã‚‰ã—ã„è¡Œå‹•ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ—ãƒ¼ãƒ«ã§ã®è¯éº—ãªæ³³ãã¯ã‚‚ã¡ã‚ã‚“ã€é™¸ä¸Šã§ã®ãƒ¨ãƒãƒ¨ãƒæ­©ãã‚„ã€ç¾½æ ¹ã¥ãã‚ã„ã®ä¸å¯§ãªä»•è‰ã€æ™‚ã«ã¯ä»²é–“åŒå£«ã§ã˜ã‚ƒã‚Œåˆã†æ§˜å­ãªã©ã‚‚å¾®ç¬‘ã¾ã—ãæ„Ÿã˜ã‚‰ã‚Œã¾ã™ã€‚é¤Œã®æ™‚é–“ã«ã¯æœŸå¾…ã«æº€ã¡ãŸè¡¨æƒ…ã‚’è¦‹ã›ã€é£Ÿå¾Œã¯æº€è¶³ãã†ã«ç¾½æ ¹ã‚’æ•´ãˆã‚‹å§¿ãŒå°è±¡çš„ã§ã™ã€‚ä¼‘æ†©æ™‚é–“ã«ã¯å²©ã®ä¸Šã§æ°—æŒã¡ã‚ˆã•ãã†ã«æ—¥å…‰æµ´ã‚’ã—ãŸã‚Šã€ãƒ—ãƒ¼ãƒ«ã‚µã‚¤ãƒ‰ã§æ°´é¢ã‚’è¦‹ã¤ã‚ãŸã‚Šã¨ã€ãã‚Œãã‚ŒãŒæ€ã„æ€ã„ã®æ™‚é–“ã‚’éã”ã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¥é¤¨è€…ã¨ã®äº¤æµï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-interaction',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¥é¤¨è€…ã¨ã®å¿ƒæ¸©ã¾ã‚‹äº¤æµ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'interaction-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒšãƒ³ã‚®ãƒ³ãŸã¡ã¯æ¥é¤¨è€…ã«ã‚‚èˆˆå‘³ã‚’ç¤ºã—ã€æ™‚ã«ã¯ã‚¬ãƒ©ã‚¹è¶Šã—ã«è¿‘ã¥ã„ã¦ãã¦ãã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ç‰¹ã«å­ã©ã‚‚ãŸã¡ã«ã¯æ•æ„Ÿã«åå¿œã—ã€å­ã©ã‚‚ãŸã¡ãŒãƒ—ãƒ¼ãƒ«ã®å‰ã«æ¥ã‚‹ã¨èˆˆå‘³æ·±ãã†ã«è¿‘ã¥ã„ã¦ãã‚‹å§¿ãŒå¯æ„›ã‚‰ã—ã„ã§ã™ã€‚å†™çœŸæ’®å½±ã‚’ã—ã¦ã„ã‚‹äººã«ã¯å¥½å¥‡å¿ƒã„ã£ã±ã„ã®è¡¨æƒ…ã‚’å‘ã‘ã¦ãã‚Œã‚‹ã“ã¨ã‚‚å¤šãã€ã¾ã‚‹ã§ã‚«ãƒ¡ãƒ©ã‚’æ„è­˜ã—ã¦ã„ã‚‹ã‹ã®ã‚ˆã†ãªè¡¨æƒ…ã‚’è¦‹ã›ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªè‡ªç„¶ãªäº¤æµãŒã€å¤šãã®æ¥é¤¨è€…ã®å¿ƒã‚’ç™’ã—ã€ãƒšãƒ³ã‚®ãƒ³ãƒ•ã‚¡ãƒ³ã‚’å¢—ã‚„ã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ°´æ—é¤¨è¦‹å­¦ã®ã‚³ãƒ„ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tips',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒšãƒ³ã‚®ãƒ³è¦³å¯Ÿã‚’æ¥½ã—ã‚€ã‚³ãƒ„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tips-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒšãƒ³ã‚®ãƒ³ãŸã¡ã‚’è¦³å¯Ÿã™ã‚‹éš›ã¯ã€é¤Œã®æ™‚é–“ã‚’ç‹™ã£ã¦è¨ªã‚Œã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ã€‚æ´»ç™ºã«å‹•ãå›ã‚‹å§¿ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€ã‚†ã£ãã‚Šã¨æ™‚é–“ã‚’ã‹ã‘ã¦è¦³å¯Ÿã™ã‚‹ã“ã¨ã§ã€ãã‚Œãã‚Œã®å€‹æ€§ã‚„è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç™ºè¦‹ã§ãã¾ã™ã€‚ã‚«ãƒ¡ãƒ©ã‚’æŒå‚ã™ã‚Œã°ã€æ„›ã‚‰ã—ã„è¡¨æƒ…ã‚„ä»•è‰ã‚’æ’®å½±ã§ãã¾ã™ãŒã€ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ã®ã§æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚å¹³æ—¥ã®åˆå‰ä¸­ã¯æ¯”è¼ƒçš„ç©ºã„ã¦ã„ã‚‹ã®ã§ã€ã˜ã£ãã‚Šã¨è¦³å¯Ÿã—ãŸã„æ–¹ã«ãŠã™ã™ã‚ã®æ™‚é–“å¸¯ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é­šæ´¥æ°´æ—é¤¨ã®3ç¾½ã®ãƒšãƒ³ã‚®ãƒ³ã¯ã€ãã‚Œãã‚ŒãŒå€‹æ€§è±Šã‹ã§æ„›ã‚‰ã—ã„å­˜åœ¨ã§ã™ã€‚å½¼ã‚‰ã®æ—¥å¸¸ã‚’è¦³å¯Ÿã—ã«ã€ãœã²é­šæ´¥æ°´æ—é¤¨ã‚’è¨ªã‚Œã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬27è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 185æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentySeventhArticle();
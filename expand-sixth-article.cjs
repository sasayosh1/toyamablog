const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandSixthArticle() {
  try {
    console.log('ç¬¬6è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: toyama-city-6-20-r6-1-2-12-00 (èƒ½ç™»åŠå³¶åœ°éœ‡å¾Œã®ã‚¢ãƒ«ãƒ“ã‚¹æ–°åº„åº—)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "toyama-city-6-20-r6-1-2-12-00"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€èƒ½ç™»åŠå³¶åœ°éœ‡å¾Œã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'ä»¤å’Œ6å¹´èƒ½ç™»åŠå³¶åœ°éœ‡ç™ºç”Ÿã‹ã‚‰ç´„20æ™‚é–“å¾Œã®å¯Œå±±å¸‚ã‚¢ãƒ«ãƒ“ã‚¹æ–°åº„åº—ã®æ§˜å­ã‚’è¨˜éŒ²ã—ãŸè²´é‡ãªæ˜ åƒã§ã™ã€‚ç½å®³æ™‚ã®åœ°åŸŸã®çŠ¶æ³ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°éœ‡ã®æ¦‚è¦ï¼ˆç´„160æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-earthquake',
        style: 'h2',
        children: [{ _type: 'span', text: 'ä»¤å’Œ6å¹´èƒ½ç™»åŠå³¶åœ°éœ‡ã«ã¤ã„ã¦', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'earthquake-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ä»¤å’Œ6å¹´1æœˆ1æ—¥ã«ç™ºç”Ÿã—ãŸèƒ½ç™»åŠå³¶åœ°éœ‡ã¯ã€çŸ³å·çœŒèƒ½ç™»åŠå³¶ã‚’éœ‡æºã¨ã™ã‚‹å¤§ããªåœ°éœ‡ã§ã—ãŸã€‚å¯Œå±±çœŒã‚‚éš£æ¥ã™ã‚‹åœ°åŸŸã¨ã—ã¦å½±éŸ¿ã‚’å—ã‘ã€å¤šãã®å¸‚æ°‘ãŒä¸å®‰ã‚’æ„Ÿã˜ã‚‹ä¸­ã§ã€æ—¥å¸¸ç”Ÿæ´»ã¸ã®å½±éŸ¿ã‚‚æ‡¸å¿µã•ã‚Œã¾ã—ãŸã€‚ã“ã®åœ°éœ‡ã¯æ–°å¹´ã‚’è¿ãˆãŸã°ã‹ã‚Šã®æ™‚æœŸã«ç™ºç”Ÿã—ãŸãŸã‚ã€å¤šãã®äººã€…ã«ã¨ã£ã¦å¿˜ã‚Œã‚‰ã‚Œãªã„å‡ºæ¥äº‹ã¨ãªã‚Šã¾ã—ãŸã€‚åœ°åŸŸå…¨ä½“ã§äº’ã„ã«æ”¯ãˆåˆã†æ°—æŒã¡ãŒå¼·ã¾ã£ãŸæ™‚æœŸã§ã‚‚ã‚ã‚Šã¾ã—ãŸã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚¢ãƒ«ãƒ“ã‚¹æ–°åº„åº—ã®çŠ¶æ³ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-store',
        style: 'h2',
        children: [{ _type: 'span', text: 'åœ°éœ‡ç™ºç”Ÿç´„20æ™‚é–“å¾Œã®åº—èˆ—çŠ¶æ³', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'store-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ°éœ‡ç™ºç”Ÿã‹ã‚‰ç´„20æ™‚é–“ãŒçµŒéã—ãŸ1æœˆ2æ—¥12æ™‚é ƒã®ã‚¢ãƒ«ãƒ“ã‚¹æ–°åº„åº—ã§ã¯ã€é€šå¸¸é€šã‚Šã®å–¶æ¥­ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã—ãŸã€‚åº—å†…ã«ã¯å¿…è¦ãªå•†å“ãŒä¸¦ã‚“ã§ãŠã‚Šã€å¸‚æ°‘ã®çš†ã•ã‚“ãŒå®‰å¿ƒã—ã¦è²·ã„ç‰©ã§ãã‚‹çŠ¶æ³ãŒä¿ãŸã‚Œã¦ã„ã¾ã—ãŸã€‚ã‚¹ã‚¿ãƒƒãƒ•ã®æ–¹ã€…ã‚‚è½ã¡ç€ã„ã¦å¯¾å¿œã•ã‚Œã¦ãŠã‚Šã€åœ°åŸŸã®ãƒ©ã‚¤ãƒ•ãƒ©ã‚¤ãƒ³ã¨ã—ã¦ã®é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹æ§˜å­ãŒç¢ºèªã§ãã¾ã—ãŸã€‚ç½å®³æ™‚ã«ãŠã‘ã‚‹åœ°åŸŸã‚¹ãƒ¼ãƒ‘ãƒ¼ã®é‡è¦æ€§ã‚’æ”¹ã‚ã¦æ„Ÿã˜ã•ã›ã‚‹å…‰æ™¯ã§ã—ãŸã€‚ã“ã®ã‚ˆã†ãªçŠ¶æ³ã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨ã§ã€ç½å®³æ™‚ã®åœ°åŸŸã®å›å¾©åŠ›ã‚’ç¤ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°åŸŸã®å¯¾å¿œåŠ›ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-community',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¯Œå±±å¸‚æ°‘ã®å†·é™ãªå¯¾å¿œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'community-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ˜ åƒã‹ã‚‰è¦‹ãˆã‚‹ã®ã¯ã€å¯Œå±±å¸‚æ°‘ã®çš†ã•ã‚“ã®å†·é™ã§ç§©åºã‚ã‚‹è¡Œå‹•ã§ã™ã€‚ãƒ‘ãƒ‹ãƒƒã‚¯ã«ãªã‚‹ã“ã¨ãªãã€å¿…è¦ãªç‰©å“ã‚’é©åˆ‡ã«è³¼å…¥ã—ã€ãŠäº’ã„ã«é…æ…®ã—ãªãŒã‚‰è¡Œå‹•ã—ã¦ã„ã‚‹æ§˜å­ãŒå°è±¡çš„ã§ã—ãŸã€‚åœ°åŸŸã®çµæŸåŠ›ã¨å¸‚æ°‘ã®çš†ã•ã‚“ã®æˆç†Ÿã—ãŸå¯¾å¿œåŠ›ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã‚ˆã†ãªæ™‚ã“ãã€åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®å¤§åˆ‡ã•ãŒéš›ç«‹ã¡ã¾ã™ã€‚å¯Œå±±ã®äººã€…ã®æ¸©ã‹ã•ã¨åŠ©ã‘åˆã„ã®ç²¾ç¥ãŒè¡¨ã‚Œã¦ã„ã‚‹å ´é¢ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¨˜éŒ²ã®æ„ç¾©ï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-record',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç½å®³è¨˜éŒ²ã¨ã—ã¦ã®ä¾¡å€¤', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'record-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã“ã®ã‚ˆã†ãªæ—¥å¸¸çš„ãªå ´é¢ã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨ã¯ã€ç½å®³æ™‚ã®åœ°åŸŸã®çŠ¶æ³ã‚’å¾Œä¸–ã«ä¼ãˆã‚‹é‡è¦ãªè³‡æ–™ã¨ãªã‚Šã¾ã™ã€‚å¤§ããªè¢«å®³ãŒãªã‹ã£ãŸåœ°åŸŸã«ãŠã„ã¦ã‚‚ã€åœ°éœ‡ã®å½±éŸ¿ã‚„å¸‚æ°‘ã®å¯¾å¿œã‚’è¨˜éŒ²ã—ã¦ãŠãã“ã¨ã§ã€å°†æ¥ã®é˜²ç½å¯¾ç­–ã‚„åœ°åŸŸã®å¼·é­æ€§å‘ä¸Šã«å½¹ç«‹ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä½•æ°—ãªã„æ—¥å¸¸ã®é¢¨æ™¯ãŒã€å®Ÿã¯è²´é‡ãªæ­´å²ã®ä¸€ã‚³ãƒã«ãªã£ã¦ã„ã‚‹ã®ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ„Ÿè¬ã¨é¡˜ã„ï¼ˆç´„120æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-gratitude',
        style: 'h2',
        children: [{ _type: 'span', text: 'åœ°åŸŸã¸ã®æ„Ÿè¬ã¨ä»Šå¾Œã¸ã®é¡˜ã„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'gratitude-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç½å®³æ™‚ã«ã‚‚å–¶æ¥­ã‚’ç¶™ç¶šã—ã¦ãã ã•ã£ãŸã‚¢ãƒ«ãƒ“ã‚¹æ–°åº„åº—ã®ã‚¹ã‚¿ãƒƒãƒ•ã®çš†æ§˜ã€ãã—ã¦å†·é™ã«è¡Œå‹•ã•ã‚ŒãŸå¸‚æ°‘ã®çš†æ§˜ã«å¿ƒã‹ã‚‰æ„Ÿè¬ã„ãŸã—ã¾ã™ã€‚ã“ã®ã‚ˆã†ãªè¨˜éŒ²ã‚’é€šã˜ã¦ã€åœ°åŸŸã®çµ†ã®å¤§åˆ‡ã•ã‚’å†ç¢ºèªã—ã€ä»Šå¾Œã‚‚äº’ã„ã«æ”¯ãˆåˆãˆã‚‹ç¤¾ä¼šã§ã‚ã‚Šç¶šã‘ã‚‹ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚å¹³ç©ãªæ—¥å¸¸ãŒã„ã‹ã«è²´é‡ã§ã‚ã‚‹ã‹ã‚’æ”¹ã‚ã¦æ„Ÿã˜ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'èƒ½ç™»åŠå³¶åœ°éœ‡ã‹ã‚‰ç´„20æ™‚é–“å¾Œã®ã‚¢ãƒ«ãƒ“ã‚¹æ–°åº„åº—ã®è¨˜éŒ²ã¯ã€å¯Œå±±å¸‚æ°‘ã®å†·é™ãªå¯¾å¿œã¨åœ°åŸŸã®çµæŸåŠ›ã‚’ç¤ºã™è²´é‡ãªæ˜ åƒã§ã™ã€‚ç½å®³æ™‚ã®åœ°åŸŸã®çŠ¶æ³ã‚’è¨˜éŒ²ã™ã‚‹æ„ç¾©ã‚’æ„Ÿã˜ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬6è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 201æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandSixthArticle();
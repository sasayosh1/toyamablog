const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandFifteenthArticle() {
  try {
    console.log('ç¬¬15è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: tonami-city-bridge (ç ºæ³¢å¸‚æ± å·å»“é¾æ©‹)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "tonami-city-bridge"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€å»“é¾æ©‹ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç ºæ³¢å¸‚ã®æ± å·ã«æ¶ã‹ã‚‹å»“é¾æ©‹ï¼ˆã‹ãã‚Šã‚…ã†ã¯ã—ï¼‰ã¯ã€ï¼’æœ¬ã®é¾ã®æ©‹è„šãŒç‰¹å¾´çš„ãªç¾ã—ã„æ©‹ã§ã™ã€‚åœ°åŸŸã®ãƒ©ãƒ³ãƒ‰ãƒãƒ¼ã‚¯ã¨ã—ã¦è¦ªã—ã¾ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å»“é¾æ©‹ã®ç‰¹å¾´ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-design',
        style: 'h2',
        children: [{ _type: 'span', text: 'ï¼’æœ¬ã®é¾ã®æ©‹è„šãŒç¹”ã‚Šãªã™ç¾ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'design-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å»“é¾æ©‹ã®æœ€å¤§ã®ç‰¹å¾´ã¯ã€æ°´é¢ã‹ã‚‰ç«‹ã¡ä¸ŠãŒã‚‹ï¼’æœ¬ã®é¾ã‚’æ¨¡ã—ãŸç¾ã—ã„æ©‹è„šã§ã™ã€‚ã“ã®é¾ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã¯æ±æ´‹ã®ä¼çµ±çš„ãªèŠ¸è¡“æ§˜å¼ã‚’ç¾ä»£ã®æ©‹æ¢å»ºç¯‰ã«å–ã‚Šå…¥ã‚ŒãŸè¦‹äº‹ãªä½œå“ã§ã€æ©Ÿèƒ½æ€§ã¨èŠ¸è¡“æ€§ã‚’å…¼ã­å‚™ãˆã¦ã„ã¾ã™ã€‚é¾ã®å§¿ã¯åŠ›å¼·ã•ã¨å„ªé›…ã•ã‚’åŒæ™‚ã«è¡¨ç¾ã—ã¦ãŠã‚Šã€è¦‹ã‚‹è§’åº¦ã«ã‚ˆã£ã¦ç•°ãªã‚‹è¡¨æƒ…ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚ç‰¹ã«å¤•æš®ã‚Œæ™‚ã‚„å¤œé–“ã®ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—æ™‚ã«ã¯ã€ãã®ç¾ã—ã•ãŒä¸€å±¤éš›ç«‹ã¡ã€å¤šãã®äººã€…ã‚’é­…äº†ã—ã¦ã„ã¾ã™ã€‚åœ°åŸŸã®æ–‡åŒ–çš„ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’è±¡å¾´ã™ã‚‹é‡è¦ãªå»ºé€ ç‰©ã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ± å·ã®è‡ªç„¶ç’°å¢ƒï¼ˆç´„160æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-river',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ± å·ã®è±Šã‹ãªè‡ªç„¶ç’°å¢ƒ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'river-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å»“é¾æ©‹ãŒæ¶ã‹ã‚‹æ± å·ã¯ã€ç ºæ³¢å¹³é‡ã‚’æµã‚Œã‚‹æ¸…ã‚‰ã‹ãªæ²³å·ã§ã€å››å­£ã‚’é€šã˜ã¦ç¾ã—ã„è‡ªç„¶ã®è¡¨æƒ…ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚æ˜¥ã«ã¯æ¡œä¸¦æœ¨ãŒå·å²¸ã‚’å½©ã‚Šã€å¤ã«ã¯ç·‘è±Šã‹ãªæ²³å·æ•·ã§å¤šãã®ç”Ÿãç‰©ãŒæ¯ã¥ã„ã¦ã„ã¾ã™ã€‚ç§‹ã«ã¯ç´…è‘‰ãŒæ°´é¢ã«æ˜ ãˆã€å†¬ã«ã¯é›ªåŒ–ç²§ã—ãŸæ™¯è¦³ãŒé™å¯‚ãªç¾ã—ã•ã‚’æ¼”å‡ºã—ã¾ã™ã€‚æ¸…æµã«ã¯æ§˜ã€…ãªé­šé¡ã‚‚ç”Ÿæ¯ã—ã¦ãŠã‚Šã€é‡£ã‚Šã‚’æ¥½ã—ã‚€äººã®å§¿ã‚‚è¦‹ã‹ã‘ã¾ã™ã€‚æ©‹ã®ä¸Šã‹ã‚‰ã¯ã€ã“ã®è±Šã‹ãªè‡ªç„¶ç’°å¢ƒã‚’ä¸€æœ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°åŸŸã®æ­´å²ã¨æ–‡åŒ–ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-history',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç ºæ³¢åœ°åŸŸã®æ­´å²ã¨ä¼çµ±', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'history-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç ºæ³¢å¸‚ã¯å¤ãã‹ã‚‰è¾²æ¥­ãŒç››ã‚“ãªåœ°åŸŸã§ã€æ•£å±…æ‘ã¨ã„ã†ç‹¬ç‰¹ã®é›†è½å½¢æ…‹ã§ã‚‚çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚é¾ã¨ã„ã†ç¥è©±çš„ãªç”Ÿãç‰©ã‚’æ©‹ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã«æ¡ç”¨ã—ãŸã®ã¯ã€æ°´ã®ç¥æ§˜ã¨ã—ã¦é¾ã‚’ä¿¡ä»°ã—ã¦ããŸæ—¥æœ¬ã®ä¼çµ±æ–‡åŒ–ã¨ã€è±Šã‹ãªæ°´ç”°åœ°å¸¯ã§ã‚ã‚‹ç ºæ³¢å¹³é‡ã®ç‰¹æ€§ã‚’åæ˜ ã—ãŸã‚‚ã®ã§ã™ã€‚åœ°åŸŸã®äººã€…ã«ã¨ã£ã¦å·ã¯ç”Ÿæ´»ã«æ¬ ã‹ã›ãªã„å­˜åœ¨ã§ã‚ã‚Šã€ãã®å·ã«æ¶ã‹ã‚‹æ©‹ã‚‚ã¾ãŸã€ç”Ÿæ´»ã¨æ–‡åŒ–ã‚’çµã¶é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¦³å…‰ã¨æ’®å½±ã‚¹ãƒãƒƒãƒˆï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tourism',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ’®å½±ã‚¹ãƒãƒƒãƒˆã¨ã—ã¦ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tourism-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å»“é¾æ©‹ã¯å†™çœŸæ„›å¥½å®¶ã«ã¨ã£ã¦æ ¼å¥½ã®æ’®å½±ã‚¹ãƒãƒƒãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚é¾ã®æ©‹è„šã¨å·é¢ã®çµ„ã¿åˆã‚ã›ã¯ã€ã©ã®è§’åº¦ã‹ã‚‰æ’®ã£ã¦ã‚‚çµµã«ãªã‚‹ç¾ã—ã•ã§ã™ã€‚ç‰¹ã«æ—©æœã®æœéœ§ã‚„å¤•æš®ã‚Œæ™‚ã®å…‰ç·šã¯ã€å¹»æƒ³çš„ãªå†™çœŸã‚’æ’®å½±ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ©‹ã®ä¸Šã‹ã‚‰ã®çœºæœ›ã‚‚ç´ æ™´ã‚‰ã—ãã€ç ºæ³¢å¹³é‡ã®ç”°åœ’é¢¨æ™¯ã‚’ä¸€æœ›ã§ãã¾ã™ã€‚SNSæ˜ ãˆã™ã‚‹é¢¨æ™¯ã¨ã—ã¦ã€è‹¥ã„ä¸–ä»£ã«ã‚‚äººæ°—ãŒé«˜ã¾ã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚¢ã‚¯ã‚»ã‚¹ã¨å‘¨è¾ºæƒ…å ±ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-access',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚¢ã‚¯ã‚»ã‚¹ã¨å‘¨è¾ºã®æ¥½ã—ã¿æ–¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'access-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å»“é¾æ©‹ã¸ã¯ç ºæ³¢å¸‚å†…ã‹ã‚‰è»Šã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã®ãŒä¾¿åˆ©ã§ã™ã€‚å‘¨è¾ºã«ã¯æ•£å±…æ‘ã®æ™¯è¦³ã‚’æ¥½ã—ã‚ã‚‹ã‚¹ãƒãƒƒãƒˆã‚„ã€ç ºæ³¢ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—å…¬åœ’ãªã©ã®è¦³å…‰åœ°ã‚‚ã‚ã‚Šã¾ã™ã€‚æ˜¥ã®ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—ãƒ•ã‚§ã‚¢ã®æ™‚æœŸã«ã¯å¤šãã®è¦³å…‰å®¢ãŒè¨ªã‚Œã€æ©‹ã¨èŠ±ã®ç¾ã—ã„ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚åœ°å…ƒã®è¾²ç”£ç‰©ç›´å£²æ‰€ã§ã®è²·ã„ç‰©ã‚„ã€éƒ·åœŸæ–™ç†ã‚’å‘³ã‚ã†ã‚°ãƒ«ãƒ¡å·¡ã‚Šã‚‚åˆã‚ã›ã¦æ¥½ã—ã‚ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ï¼’æœ¬ã®é¾ã®æ©‹è„šãŒç¾ã—ã„å»“é¾æ©‹ã¯ã€ç ºæ³¢å¸‚ã®éš ã‚ŒãŸåæ‰€ã§ã™ã€‚è‡ªç„¶ã¨èŠ¸è¡“ãŒèª¿å’Œã—ãŸç´ æ™´ã‚‰ã—ã„æ™¯è¦³ã‚’ãœã²ä¸€åº¦ã”è¦§ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬15è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 171æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandFifteenthArticle();
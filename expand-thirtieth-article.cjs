const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandThirtiethArticle() {
  try {
    console.log('ç¬¬30è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: kurobe-city-onsen-fireworks (å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èª)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "kurobe-city-onsen-fireworks"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èªã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é»’éƒ¨å¸‚ã®å®‡å¥ˆæœˆæ¸©æ³‰ã§é–‹å‚¬ã•ã‚Œã‚‹å†¬ã®å¤œç©ºã‚’å½©ã‚‹è±ªè¯èŠ±ç«ã‚·ãƒ§ãƒ¼ã€Œå®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èª é›ªä¸ŠèŠ±ç«å¤§ä¼šã€ã®å¹»æƒ³çš„ãªç¾ã—ã•ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èªã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-event',
        style: 'h2',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èªã®é­…åŠ›ã¨ã‚³ãƒ³ã‚»ãƒ—ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'event-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èªã¯ã€é»’éƒ¨å³¡è°·ã®å…¥ã‚Šå£ã«ä½ç½®ã™ã‚‹å®‡å¥ˆæœˆæ¸©æ³‰ã§æ¯å¹´é–‹å‚¬ã•ã‚Œã‚‹å†¬ã®ä¸€å¤§ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚é›ªã«è¦†ã‚ã‚ŒãŸæ¸©æ³‰è¡—ã‚’èˆå°ã«ã€è‰²ã¨ã‚Šã©ã‚Šã®èŠ±ç«ãŒå¤œç©ºã‚’å½©ã‚‹å…‰æ™¯ã¯ã€ã¾ã•ã«å†¬ã®çµ¶æ™¯ã¨è¨€ãˆã‚‹ã§ã—ã‚‡ã†ã€‚ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯å˜ãªã‚‹èŠ±ç«å¤§ä¼šã§ã¯ãªãã€é›ªæ™¯è‰²ã¨æ¸©æ³‰ã¨ã„ã†æ—¥æœ¬ã®å†¬ã®ç¾ã—ã•ã‚’æœ€å¤§é™ã«æ´»ã‹ã—ãŸç‰¹åˆ¥ãªå‚¬ã—ã§ã™ã€‚æ¸©æ³‰è¡—ã®å®¿æ³Šæ–½è¨­ã‹ã‚‰ã‚‚èŠ±ç«ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã€æ¸©æ³‰ã«æµ¸ã‹ã‚ŠãªãŒã‚‰èŠ±ç«ã‚’çœºã‚ã‚‹ã¨ã„ã†è´…æ²¢ãªä½“é¨“ã‚‚å¯èƒ½ã§ã™ã€‚åœ°åŸŸã®å†¬å­£è¦³å…‰ã®ç›®ç‰ã¨ã—ã¦ã€å¤šãã®è¦³å…‰å®¢ã«æ„›ã•ã‚Œç¶šã‘ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é›ªä¸ŠèŠ±ç«å¤§ä¼šã®å£®è¦³ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-fireworks',
        style: 'h2',
        children: [{ _type: 'span', text: 'é›ªä¸Šã«éŸ¿ãè±ªè¯èŠ±ç«ã‚·ãƒ§ãƒ¼ã®è¿«åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'fireworks-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é›ªä¸ŠèŠ±ç«å¤§ä¼šã®æœ€å¤§ã®é­…åŠ›ã¯ã€ç´”ç™½ã®é›ªæ™¯è‰²ã¨è‰²é®®ã‚„ã‹ãªèŠ±ç«ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã§ã™ã€‚é›ªã«åå°„ã™ã‚‹èŠ±ç«ã®å…‰ãŒå¹»æƒ³çš„ãªä¸–ç•Œã‚’ä½œã‚Šå‡ºã—ã€å¤ã®èŠ±ç«å¤§ä¼šã¨ã¯å…¨ãç•°ãªã‚‹ç¾ã—ã•ã‚’æ¼”å‡ºã—ã¾ã™ã€‚é»’éƒ¨å³¡è°·ã®å±±ã€…ã«èŠ±ç«ã®éŸ³ãŒéŸ¿ãæ¸¡ã‚‹æ§˜å­ã¯ã€è‡ªç„¶ã®é›„å¤§ã•ã‚’æ”¹ã‚ã¦æ„Ÿã˜ã•ã›ã¦ãã‚Œã¾ã™ã€‚ç‰¹ã«ã‚¹ã‚¿ãƒ¼ãƒã‚¤ãƒ³ã‚„ä»•æ›ã‘èŠ±ç«ã¯åœ§å·»ã§ã€è¦³å®¢ã‹ã‚‰ã¯æ„Ÿå˜†ã®å£°ãŒä¸ŠãŒã‚Šã¾ã™ã€‚èŠ±ç«ãŒé›ªé¢ã‚’ç…§ã‚‰ã™ç¬é–“ã¯ã€ã¾ã‚‹ã§é›ªåŸãŒå®çŸ³ã®ã‚ˆã†ã«è¼ã„ã¦è¦‹ãˆã€å†™çœŸã«åã‚ãŸããªã‚‹ç¾ã—ã„ç¬é–“ãŒæ¬¡ã€…ã¨è¨ªã‚Œã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å†¬ã®å®‡å¥ˆæœˆæ¸©æ³‰ã®é­…åŠ›ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-winter-onsen',
        style: 'h2',
        children: [{ _type: 'span', text: 'å†¬ã®å®‡å¥ˆæœˆæ¸©æ³‰è¡—ã®ç‰¹åˆ¥ãªé­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'winter-onsen-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å†¬ã®å®‡å¥ˆæœˆæ¸©æ³‰ã¯ã€é›ªæ™¯è‰²ã«åŒ…ã¾ã‚ŒãŸæ¸©æ³‰è¡—ã¨ã—ã¦æ ¼åˆ¥ã®ç¾ã—ã•ã‚’è¦‹ã›ã¾ã™ã€‚é›ªåŒ–ç²§ã—ãŸæ¸©æ³‰è¡—ã®é¢¨æƒ…ã¯ã€æ—¥æœ¬ã®å†¬ã®æƒ…ç·’ã‚’å­˜åˆ†ã«å‘³ã‚ãˆã‚‹ç‰¹åˆ¥ãªç’°å¢ƒã§ã™ã€‚å¯’ã„å¤–æ°—ã¨æ¸©ã‹ãªæ¸©æ³‰ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯ã€èº«ã‚‚å¿ƒã‚‚æ¸©ã‚ã¦ãã‚Œã‚‹æœ€é«˜ã®ç™’ã—ä½“é¨“ã¨ãªã‚Šã¾ã™ã€‚èŠ±ç«å¤§ä¼šã®ä¼šå ´ã¨ãªã‚‹å®‡å¥ˆæœˆå…¬åœ’å‘¨è¾ºã¯ã€é›ªã«è¦†ã‚ã‚ŒãŸé™å¯‚ãªç©ºé–“ãŒåºƒãŒã‚Šã€èŠ±ç«ã®ç¾ã—ã•ã‚’ä¸€å±¤å¼•ãç«‹ã¦ã¾ã™ã€‚æ¸©æ³‰æ—…é¤¨ã®çª“ã‹ã‚‰ã‚‚èŠ±ç«ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã€å®¿æ³Šè€…ã«ã¨ã£ã¦ã¯å¿˜ã‚Œã‚‰ã‚Œãªã„å†¬ã®æ€ã„å‡ºã¨ãªã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¦³è¦§ã®ãƒã‚¤ãƒ³ãƒˆï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-viewing',
        style: 'h2',
        children: [{ _type: 'span', text: 'èŠ±ç«å¤§ä¼šã‚’æœ€å¤§é™æ¥½ã—ã‚€ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'viewing-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é›ªä¸ŠèŠ±ç«å¤§ä¼šã‚’æ¥½ã—ã‚€ãŸã‚ã«ã¯ã€é˜²å¯’å¯¾ç­–ãŒä½•ã‚ˆã‚Šé‡è¦ã§ã™ã€‚é›ªã®ä¸Šã§é•·æ™‚é–“éã”ã™ãŸã‚ã€åšç€ã‚’ã—ã¦è¶³å…ƒã®é˜²å¯’ã‚‚ã—ã£ã‹ã‚Šã¨æº–å‚™ã—ã¾ã—ã‚‡ã†ã€‚å®‡å¥ˆæœˆå…¬åœ’ãŒä¸»ãªè¦³è¦§å ´æ‰€ã¨ãªã‚Šã¾ã™ãŒã€æ¸©æ³‰è¡—ã®å„æ‰€ã‹ã‚‰ã‚‚èŠ±ç«ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚å®¿æ³Šäºˆå®šã®æ–¹ã¯ã€èŠ±ç«ãŒè¦‹ãˆã‚‹éƒ¨å±‹ã‚’äº‹å‰ã«äºˆç´„ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚ã‚«ãƒ¡ãƒ©ã‚„ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§æ’®å½±ã™ã‚‹éš›ã¯ã€ãƒãƒƒãƒ†ãƒªãƒ¼ãŒå¯’ã•ã§æ¶ˆè€—ã—ã‚„ã™ã„ã®ã§äºˆå‚™ã‚’æº–å‚™ã—ã¦ãŠãã¨å®‰å¿ƒã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¸©æ³‰ã¨ã®ç‰¹åˆ¥ãªçµ„ã¿åˆã‚ã›ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-onsen-combination',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¸©æ³‰ã¨èŠ±ç«ã®è´…æ²¢ãªçµ„ã¿åˆã‚ã›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'onsen-combination-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èªã®é†é†å‘³ã¯ã€æ¸©æ³‰ã¨èŠ±ç«ã‚’åŒæ™‚ã«æ¥½ã—ã‚ã‚‹ã“ã¨ã§ã™ã€‚èŠ±ç«å¤§ä¼šã®å‰å¾Œã«æ¸©æ³‰ã«æµ¸ã‹ã‚‹ã“ã¨ã§ã€å†·ãˆãŸä½“ã‚’æ¸©ã‚ã‚‹ã“ã¨ãŒã§ãã€ä¸€å±¤èŠ±ç«ã®ç¾ã—ã•ã‚’å ªèƒ½ã§ãã¾ã™ã€‚éœ²å¤©é¢¨å‘‚ã‹ã‚‰èŠ±ç«ã‚’çœºã‚ã‚‰ã‚Œã‚‹æ—…é¤¨ã‚‚ã‚ã‚Šã€ã“ã®ã‚ˆã†ãªä½“é¨“ã¯å®‡å¥ˆæœˆæ¸©æ³‰ãªã‚‰ã§ã¯ã®ç‰¹åˆ¥ãªã‚‚ã®ã§ã™ã€‚èŠ±ç«å¤§ä¼šå¾Œã®æ¸©æ³‰ã¯æ ¼åˆ¥ã§ã€èˆˆå¥®ã—ãŸæ°—æŒã¡ã‚’è½ã¡ç€ã‹ã›ãªãŒã‚‰ã‚†ã£ãã‚Šã¨æ¸©ã¾ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆæ¸©æ³‰å†¬ç‰©èªã®é›ªä¸ŠèŠ±ç«å¤§ä¼šã¯ã€å†¬ã®å¤œç©ºã‚’å½©ã‚‹å¹»æƒ³çš„ãªã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚æ¸©æ³‰ã¨èŠ±ç«ã®è´…æ²¢ãªçµ„ã¿åˆã‚ã›ã‚’ãœã²ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬30è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 190æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandThirtiethArticle();
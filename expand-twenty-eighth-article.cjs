const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentyEighthArticle() {
  try {
    console.log('ç¬¬28è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: imizu-city-100 (å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®é¯‰ã®ã‚¨ã‚µã‚„ã‚Š)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "imizu-city-100"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®é¯‰ã®ã‚¨ã‚µã‚„ã‚Šã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å°„æ°´å¸‚ã®å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã§ä½“é¨“ã§ãã‚‹100å††ã®é¯‰ã®ã‚¨ã‚µã‚„ã‚Šã€‚æ‰‹è»½ãªä¾¡æ ¼ã§æ¥½ã—ã‚ã‚‹å¿ƒæ¸©ã¾ã‚‹å‹•ç‰©ã¨ã®è§¦ã‚Œåˆã„ä½“é¨“ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-park',
        style: 'h2',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®é­…åŠ›ã¨æ¥½ã—ã¿æ–¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'park-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã¯å°„æ°´å¸‚ã«ã‚ã‚‹çœŒæ°‘å…¬åœ’ã¨ã—ã¦ã€å¹…åºƒã„å¹´ä»£ã®æ–¹ã€…ã«æ„›ã•ã‚Œç¶šã‘ã¦ã„ã‚‹ç·åˆãƒ¬ã‚¸ãƒ£ãƒ¼æ–½è¨­ã§ã™ã€‚åºƒå¤§ãªæ•·åœ°å†…ã«ã¯æ§˜ã€…ãªæ–½è¨­ã‚„è‡ªç„¶ã‚¹ãƒãƒƒãƒˆãŒç‚¹åœ¨ã—ã¦ãŠã‚Šã€ä¸€æ—¥ä¸­æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰¹ã«å®¶æ—é€£ã‚Œã«ã¯äººæ°—ãŒé«˜ãã€å­ã©ã‚‚ã‹ã‚‰å¤§äººã¾ã§æ¥½ã—ã‚ã‚‹ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚„ä½“é¨“ã‚³ãƒ¼ãƒŠãƒ¼ãŒå……å®Ÿã—ã¦ã„ã¾ã™ã€‚å››å­£ã‚’é€šã˜ã¦ç¾ã—ã„è‡ªç„¶ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã€æ•£æ­©ã‚„ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯ã«ã‚‚æœ€é©ãªç’°å¢ƒãŒæ•´ã£ã¦ã„ã¾ã™ã€‚å…¬åœ’å†…ã«ã¯æ± ã‚„å°å·ã‚‚ã‚ã‚Šã€è‡ªç„¶ã¨è§¦ã‚Œåˆãˆã‚‹è²´é‡ãªç©ºé–“ã¨ã—ã¦åœ°åŸŸã®äººã€…ã«è¦ªã—ã¾ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: 100å††ã‚¨ã‚µã‚„ã‚Šä½“é¨“ã®é­…åŠ›ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-feeding',
        style: 'h2',
        children: [{ _type: 'span', text: '100å††ã§æ¥½ã—ã‚ã‚‹é¯‰ã®ã‚¨ã‚µã‚„ã‚Šä½“é¨“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'feeding-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®é¯‰ã®ã‚¨ã‚µã‚„ã‚Šä½“é¨“ã¯ã€ã‚ãšã‹100å††ã¨ã„ã†æ‰‹é ƒãªä¾¡æ ¼ã§æ¥½ã—ã‚€ã“ã¨ãŒã§ãã‚‹äººæ°—ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚å°‚ç”¨ã®é¤Œã‚’è³¼å…¥ã™ã‚‹ã¨ã€æ± ã«ã„ã‚‹è‰²ã¨ã‚Šã©ã‚Šã®é¯‰ãŸã¡ãŒæˆ‘å…ˆã«ã¨é›†ã¾ã£ã¦ãã¾ã™ã€‚é¯‰ãŸã¡ã®æ´»ç™ºãªæ§˜å­ã‚’é–“è¿‘ã§è¦³å¯Ÿã™ã‚‹ã“ã¨ãŒã§ãã€ç‰¹ã«å­ã©ã‚‚ãŸã¡ã«ã¯å¤§èˆˆå¥®ã®ä½“é¨“ã¨ãªã‚Šã¾ã™ã€‚ã‚¨ã‚µã‚’æŠ•ã’å…¥ã‚Œã‚‹ã¨ã€å¤§ããªå£ã‚’é–‹ã‘ã¦ç«¶ã„åˆã†ã‚ˆã†ã«é£Ÿã¹ã‚‹é¯‰ãŸã¡ã®å§¿ã¯è¦‹ã¦ã„ã¦å¾®ç¬‘ã¾ã—ãã€å®¶æ—ã¿ã‚“ãªã§æ¥½ã—ã‚ã¾ã™ã€‚ã“ã®ä¾¡æ ¼ã§ã“ã‚Œã»ã©æ¥½ã—ã„ä½“é¨“ãŒã§ãã‚‹ã®ã¯ã€å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ãªã‚‰ã§ã¯ã®é­…åŠ›ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é¯‰ã¨ã®è§¦ã‚Œåˆã„ã®æ¥½ã—ã•ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-interaction',
        style: 'h2',
        children: [{ _type: 'span', text: 'é¯‰ã¨ã®è§¦ã‚Œåˆã„ãŒç”Ÿã¿å‡ºã™ç™’ã—ã®æ™‚é–“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'interaction-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é¯‰ã®ã‚¨ã‚µã‚„ã‚Šä½“é¨“ã¯å˜ãªã‚‹å¨¯æ¥½ã‚’è¶…ãˆã¦ã€å¿ƒã‚’ç™’ã—ã¦ãã‚Œã‚‹ç‰¹åˆ¥ãªæ™‚é–“ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚æ± ã®å‘¨ã‚Šã«ç«‹ã£ã¦ã‚¨ã‚µã‚’ä¸ãˆã¦ã„ã‚‹ã¨ã€æ—¥å¸¸ã®å¿™ã—ã•ã‚’å¿˜ã‚Œã¦ç©ã‚„ã‹ãªæ°—æŒã¡ã«ãªã‚Šã¾ã™ã€‚é¯‰ãŸã¡ãŒã‚¨ã‚µã«ç¾¤ãŒã‚‹æ§˜å­ã‚’çœºã‚ã¦ã„ã‚‹ã ã‘ã§ã‚‚ã€è‡ªç„¶ã®ç”Ÿå‘½åŠ›ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã€å¿ƒãŒæ´—ã‚ã‚Œã‚‹ã‚ˆã†ãªæ„Ÿè¦šã‚’å‘³ã‚ãˆã¾ã™ã€‚ç‰¹ã«å¤§ããªé¯‰ãŒå„ªé›…ã«æ³³ãå§¿ã¯ç¾ã—ãã€è¦‹ã¦ã„ã‚‹ã ã‘ã§ã‚‚ååˆ†ã«æ¥½ã—ã‚ã¾ã™ã€‚å­ã©ã‚‚ãŸã¡ã«ã¨ã£ã¦ã¯ç”Ÿãç‰©ã¸ã®æ€ã„ã‚„ã‚Šã®å¿ƒã‚’è‚²ã‚€è‰¯ã„æ©Ÿä¼šã«ã‚‚ãªã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å®¶æ—ã§æ¥½ã—ã‚€ä½“é¨“ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-family',
        style: 'h2',
        children: [{ _type: 'span', text: 'å®¶æ—ã¿ã‚“ãªã§æ¥½ã—ã‚ã‚‹æ‰‹è»½ãªä½“é¨“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'family-content',
        style: 'normal',
        children: [{ _type: 'span', text: '100å††ã¨ã„ã†æ‰‹é ƒãªä¾¡æ ¼è¨­å®šã«ã‚ˆã‚Šã€å®¶æ—å…¨å“¡ã§æ°—è»½ã«æ¥½ã—ã‚€ã“ã¨ãŒã§ãã‚‹ã®ãŒå¤§ããªé­…åŠ›ã§ã™ã€‚å…„å¼Ÿå§‰å¦¹ãã‚Œãã‚ŒãŒè‡ªåˆ†ç”¨ã®ã‚¨ã‚µã‚’è³¼å…¥ã—ã¦ã€èª°ãŒä¸€ç•ªå¤šãé¯‰ã‚’é›†ã‚ã‚‰ã‚Œã‚‹ã‹ã‚’ç«¶ã„åˆã†ã®ã‚‚æ¥½ã—ã„éŠã³æ–¹ã®ä¸€ã¤ã§ã™ã€‚ç¥–çˆ¶æ¯ä¸–ä»£ã‹ã‚‰å­«ä¸–ä»£ã¾ã§ã€å¹´é½¢ã‚’å•ã‚ãšèª°ã§ã‚‚å‚åŠ ã§ãã‚‹ä½“é¨“ãªã®ã§ã€ä¸‰ä¸–ä»£ã§ã®å®¶æ—æ—…è¡Œã«ã‚‚æœ€é©ã§ã™ã€‚å†™çœŸæ’®å½±ã‚‚è‡ªç”±ã«ã§ãã‚‹ãŸã‚ã€å®¶æ—ã®ç´ æ•µãªæ€ã„å‡ºã‚’è¨˜éŒ²ã«æ®‹ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¨ªå•æ™‚ã®ãŠã™ã™ã‚ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tips',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚¨ã‚µã‚„ã‚Šä½“é¨“ã‚’æ¥½ã—ã‚€ã‚³ãƒ„', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tips-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é¯‰ã®ã‚¨ã‚µã‚„ã‚Šã‚’æœ€å¤§é™æ¥½ã—ã‚€ãŸã‚ã«ã¯ã€å¹³æ—¥ã®åˆå‰ä¸­ãŒãŠã™ã™ã‚ã§ã™ã€‚æ¯”è¼ƒçš„æ··é›‘ãŒå°‘ãªãã€ã‚†ã£ãã‚Šã¨é¯‰ãŸã¡ã‚’è¦³å¯Ÿã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¨ã‚µã¯å°‘ã—ãšã¤æŠ•ã’å…¥ã‚Œã‚‹ã“ã¨ã§ã€é•·æ™‚é–“æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚å°ã•ãªãŠå­æ§˜é€£ã‚Œã®å ´åˆã¯ã€æ± ã«è½ã¡ãªã„ã‚ˆã†æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚100å††ç‰ã‚’ä½•æšã‹ç”¨æ„ã—ã¦ãŠã‘ã°ã€ä½•åº¦ã§ã‚‚æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®ä»–ã®æ–½è¨­ã¨åˆã‚ã›ã¦è¨ªã‚Œã‚‹ã“ã¨ã§ã€ä¸€æ—¥ä¸­æ¥½ã—ã‚ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤ªé–¤å±±ãƒ©ãƒ³ãƒ‰ã®100å††é¯‰ã®ã‚¨ã‚µã‚„ã‚Šã¯ã€æ‰‹è»½ã§æ¥½ã—ã„å®¶æ—å‘ã‘ä½“é¨“ã§ã™ã€‚å¿ƒæ¸©ã¾ã‚‹é¯‰ã¨ã®è§¦ã‚Œåˆã„ã‚’ãœã²ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬28è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 189æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentyEighthArticle();
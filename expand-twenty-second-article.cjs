const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentySecondArticle() {
  try {
    console.log('ç¬¬22è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: toyama-city-50-2 (ã„ã‚‚å±‹ã®ã‹ãæ°·)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "toyama-city-50-2"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€ã„ã‚‚å±‹ã®ã‹ãæ°·è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¯Œå±±å¸‚ã«ã‚ã‚‹ã€Œã„ã‚‚å±‹ã€ã¯ã€ãƒˆãƒƒãƒ”ãƒ³ã‚°50å††ã‹ã‚‰ã¨ã„ã†é©šãã®ä¾¡æ ¼ã§ã‹ãæ°·ã‚’æä¾›ã™ã‚‹ã€åœ°å…ƒã§æ„›ã•ã‚Œã‚‹è€èˆ—ã®ãŠåº—ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã„ã‚‚å±‹ã®æ­´å²ã¨æ¦‚è¦ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-history',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã„ã‚‚å±‹ã®æ­´å²ã¨åœ°åŸŸã«æ„›ã•ã‚Œã‚‹ç†ç”±', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'history-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã„ã‚‚å±‹ã¯å¯Œå±±å¸‚ã§é•·å¹´å–¶æ¥­ã‚’ç¶šã‘ã¦ã„ã‚‹åœ°åŸŸå¯†ç€å‹ã®ãŠåº—ã§ã€åœ°å…ƒã®äººã€…ã«è¦ªã—ã¾ã‚Œç¶šã‘ã¦ã„ã¾ã™ã€‚åº—åã®é€šã‚Šã€å…ƒã€…ã¯èŠ‹ã‚’ä½¿ã£ãŸå•†å“ã‚’ä¸­å¿ƒã«æ‰±ã£ã¦ã„ã¾ã—ãŸãŒã€ç¾åœ¨ã§ã¯æ‰‹ä½œã‚Šã®ã‹ãæ°·ã§å¤šãã®ãƒ•ã‚¡ãƒ³ã‚’ç²å¾—ã—ã¦ã„ã¾ã™ã€‚æ˜”ãªãŒã‚‰ã®è£½æ³•ã¨å¿ƒã®ã“ã‚‚ã£ãŸã‚µãƒ¼ãƒ“ã‚¹ã§ã€ä¸–ä»£ã‚’è¶…ãˆã¦æ„›ã•ã‚Œç¶šã‘ã¦ã„ã‚‹ãŠåº—ã§ã™ã€‚ç‰¹ã«å¤å ´ã®ã‹ãæ°·ã¯åœ°å…ƒã®å®šç•ªã¨ãªã£ã¦ãŠã‚Šã€ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«ãªä¾¡æ ¼è¨­å®šã«ã‚ˆã‚Šå®¶æ—é€£ã‚Œã‹ã‚‰å­¦ç”Ÿã¾ã§å¹…åºƒã„å±¤ã«æ”¯æŒã•ã‚Œã¦ã„ã¾ã™ã€‚åº—ä¸»ã®æ¸©ã‹ã„äººæŸ„ã‚‚ã€å¤šãã®ãŠå®¢æ§˜ã«æ„›ã•ã‚Œã‚‹ç†ç”±ã®ä¸€ã¤ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é©šãã®ä¾¡æ ¼è¨­å®šï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-price',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒˆãƒƒãƒ”ãƒ³ã‚°50å††ã‹ã‚‰ã®é©šãã®ä¾¡æ ¼è¨­å®š', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'price-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã„ã‚‚å±‹ã®æœ€å¤§ã®é­…åŠ›ã¯ã€ãªã‚“ã¨ã„ã£ã¦ã‚‚ãã®é©šãã¹ãä¾¡æ ¼ã®å®‰ã•ã§ã™ã€‚ãƒˆãƒƒãƒ”ãƒ³ã‚°ãŒ50å††ã‹ã‚‰ã¨ã„ã†ä¾¡æ ¼è¨­å®šã¯ã€ç¾åœ¨ã®ç‰©ä¾¡ã‚’è€ƒãˆã‚‹ã¨ä¿¡ã˜ã‚‰ã‚Œãªã„ã»ã©ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«ã§ã™ã€‚åŸºæœ¬ã®ã‹ãæ°·ã‚‚éå¸¸ã«ãŠæ‰‹é ƒä¾¡æ ¼ã§æä¾›ã•ã‚Œã¦ãŠã‚Šã€å­¦ç”Ÿã®ãŠå°é£ã„ã§ã‚‚ååˆ†ã«æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ä¾¡æ ¼è¨­å®šã«ã¯ã€åœ°åŸŸã®äººã€…ã«æ°—è»½ã«ç¾å‘³ã—ã„ã‚‚ã®ã‚’æ¥½ã—ã‚“ã§ã‚‚ã‚‰ã„ãŸã„ã¨ã„ã†åº—ä¸»ã®æ¸©ã‹ã„æ€ã„ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é«˜ã•ã¯ä»–ã®è¿½éšã‚’è¨±ã•ãšã€å¯Œå±±å¸‚å†…ã§ã‚‚å±ˆæŒ‡ã®ãŠå¾—ãªã‚¹ã‚¤ãƒ¼ãƒ„ã‚¹ãƒãƒƒãƒˆã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‹ãæ°·ã®ç¨®é¡ã¨å‘³ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-menu',
        style: 'h2',
        children: [{ _type: 'span', text: 'è±Šå¯Œãªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨æ‰‹ä½œã‚Šã®ç¾å‘³ã—ã•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'menu-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã„ã‚‚å±‹ã®ã‹ãæ°·ã¯ã€ã‚·ãƒ³ãƒ—ãƒ«ãªãŒã‚‰ã‚‚å¿ƒã®ã“ã‚‚ã£ãŸæ‰‹ä½œã‚Šã®å‘³ãŒè‡ªæ…¢ã§ã™ã€‚åŸºæœ¬ã®ã‚·ãƒ­ãƒƒãƒ—ã‹ã‚‰å­£ç¯€é™å®šã®ãƒ•ãƒ¬ãƒ¼ãƒãƒ¼ã¾ã§ã€æ§˜ã€…ãªç¨®é¡ã‚’å–ã‚Šæƒãˆã¦ã„ã¾ã™ã€‚æ°·ã¯ãã‚ç´°ã‹ãå‰Šã‚‰ã‚Œã¦ãŠã‚Šã€å£å½“ãŸã‚ŠãŒæ»‘ã‚‰ã‹ã§é£Ÿã¹ã‚„ã™ã„ã®ãŒç‰¹å¾´ã§ã™ã€‚ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚‚å¤šå½©ã§ã€ã‚ã‚“ã“ã€ãƒ•ãƒ«ãƒ¼ãƒ„ã€ç·´ä¹³ãªã©ã€ãŠå¥½ã¿ã«åˆã‚ã›ã¦è‡ªç”±ã«çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ‰‹ä½œã‚Šãªã‚‰ã§ã¯ã®æ¸©ã‹ã¿ã®ã‚ã‚‹å‘³ã¯ã€å¤§é‡ç”Ÿç”£ã®ã‚‚ã®ã¨ã¯ä¸€ç·šã‚’ç”»ã™ç¾å‘³ã—ã•ã§ã™ã€‚å­£ç¯€ã®é£Ÿæã‚’ä½¿ã£ãŸé™å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚‚äººæ°—ã§ã€ãƒªãƒ”ãƒ¼ã‚¿ãƒ¼ã‚’é£½ãã•ã›ã¾ã›ã‚“ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®å ´ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-community',
        style: 'h2',
        children: [{ _type: 'span', text: 'åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®æ†©ã„ã®å ´ã¨ã—ã¦', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'community-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã„ã‚‚å±‹ã¯å˜ãªã‚‹é£²é£Ÿåº—ã‚’è¶…ãˆã¦ã€åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®é‡è¦ãªæ†©ã„ã®å ´ã¨ã—ã¦ã®å½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚è¿‘æ‰€ã®å­ã©ã‚‚ãŸã¡ãŒå­¦æ ¡å¸°ã‚Šã«ç«‹ã¡å¯„ã£ãŸã‚Šã€ã”å¹´é…ã®æ–¹ã€…ãŒæ˜”è©±ã«èŠ±ã‚’å’²ã‹ã›ãŸã‚Šã¨ã€ä¸–ä»£ã‚’è¶…ãˆãŸäº¤æµã®å ´ã¨ãªã£ã¦ã„ã¾ã™ã€‚ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«ãªä¾¡æ ¼è¨­å®šã®ãŠã‹ã’ã§ã€èª°ã‚‚ãŒæ°—è»½ã«ç«‹ã¡å¯„ã‚‹ã“ã¨ãŒã§ãã€åœ°åŸŸã®çµæŸã‚’æ·±ã‚ã‚‹å ´æ‰€ã¨ã—ã¦æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚åº—ä¸»ã¨ã®æ¸©ã‹ã„ä¼šè©±ã‚‚æ¥½ã—ã¿ã®ä¸€ã¤ã§ã€å¸¸é€£ã®ãŠå®¢æ§˜ã«ã¨ã£ã¦ã¯ç¬¬äºŒã®å®¶ã®ã‚ˆã†ãªå­˜åœ¨ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¨ªå•ã®ãŠã™ã™ã‚ï¼ˆç´„125æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visit',
        style: 'h2',
        children: [{ _type: 'span', text: 'è¨ªå•æ™‚ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visit-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã„ã‚‚å±‹ã‚’è¨ªã‚Œã‚‹éš›ã¯ã€ãœã²è¤‡æ•°ã®ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚’è©¦ã—ã¦ã¿ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚50å††ã¨ã„ã†ä¾¡æ ¼ãªã‚‰ã€ã„ã‚ã„ã‚ãªå‘³ã‚’æ¥½ã—ã‚“ã§ã‚‚è² æ‹…ã«ãªã‚Šã¾ã›ã‚“ã€‚å¤ã®æš‘ã„æ—¥ã«ã¯ç‰¹ã«ç¾å‘³ã—ãæ„Ÿã˜ã‚‰ã‚Œã€ã‚¨ã‚¢ã‚³ãƒ³ã®åŠ¹ã„ãŸåº—å†…ã§ã‚†ã£ãã‚Šã¨éã”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ç¾é‡‘ã§ã®æ”¯æ‰•ã„ã¨ãªã‚‹ã“ã¨ãŒå¤šã„ã®ã§ã€å°éŠ­ã‚’ç”¨æ„ã—ã¦ãŠãã¨ä¾¿åˆ©ã§ã™ã€‚åœ°å…ƒã®éš ã‚ŒãŸååº—ã¨ã—ã¦ã€è¦³å…‰å®¢ã«ã‚‚ãœã²ä½“é¨“ã—ã¦ã„ãŸã ããŸã„ãŠåº—ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¯Œå±±å¸‚ã®ã„ã‚‚å±‹ã¯ã€é©šãã®ä¾¡æ ¼ã¨å¿ƒæ¸©ã¾ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§åœ°åŸŸã«æ„›ã•ã‚Œã‚‹ç´ æ™´ã‚‰ã—ã„ãŠåº—ã§ã™ã€‚ãƒˆãƒƒãƒ”ãƒ³ã‚°50å††ã‹ã‚‰ã®ã‹ãæ°·ã‚’ãœã²å‘³ã‚ã£ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬22è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 181æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentySecondArticle();
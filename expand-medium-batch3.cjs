const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandMediumArticle(article) {
  try {
    const post = await client.fetch(`*[_type == "post" && slug.current == "${article.slug}"][0] { _id, title, body }`);
    if (!post) throw new Error(`記事が見つかりません: ${article.slug}`);

    // 現在の文字数カウント
    let currentChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text || '').join('');
        currentChars += text.length;
      }
    });

    // 既存コンテンツを保持
    const existingContent = [...post.body];
    
    // 新しい高品質コンテンツを追加（1800-2200文字に拡張、3つのH2セクション）
    const expandedBody = [
      // 導入文
      {
        _type: 'block',
        _key: `intro-${Date.now()}`,
        style: 'normal',
        children: [{
          _type: 'span',
          _key: `span-intro-${Date.now()}`,
          text: article.content[0].intro,
          marks: []
        }],
        markDefs: []
      },
      // 既存コンテンツを保持
      ...existingContent,
      // H2セクション1
      {
        _type: 'block',
        _key: `h2-1-${Date.now()}`,
        style: 'h2',
        children: [{
          _type: 'span',
          _key: `span-h2-1-${Date.now()}`,
          text: article.content[1].h2,
          marks: []
        }],
        markDefs: []
      }
    ];

    // H3セクション1-1, 1-2
    article.content[1].h3sections.forEach((h3section, index) => {
      expandedBody.push({
        _type: 'block',
        _key: `h3-1-${index}-${Date.now()}`,
        style: 'h3',
        children: [{
          _type: 'span',
          _key: `span-h3-1-${index}-${Date.now()}`,
          text: h3section.h3,
          marks: []
        }],
        markDefs: []
      });
      expandedBody.push({
        _type: 'block',
        _key: `h3content-1-${index}-${Date.now()}`,
        style: 'normal',
        children: [{
          _type: 'span',
          _key: `span-h3content-1-${index}-${Date.now()}`,
          text: h3section.text,
          marks: []
        }],
        markDefs: []
      });
    });

    // H2セクション2
    expandedBody.push({
      _type: 'block',
      _key: `h2-2-${Date.now()}`,
      style: 'h2',
      children: [{
        _type: 'span',
        _key: `span-h2-2-${Date.now()}`,
        text: article.content[2].h2,
        marks: []
      }],
      markDefs: []
    });

    // H3セクション2-1, 2-2
    article.content[2].h3sections.forEach((h3section, index) => {
      expandedBody.push({
        _type: 'block',
        _key: `h3-2-${index}-${Date.now()}`,
        style: 'h3',
        children: [{
          _type: 'span',
          _key: `span-h3-2-${index}-${Date.now()}`,
          text: h3section.h3,
          marks: []
        }],
        markDefs: []
      });
      expandedBody.push({
        _type: 'block',
        _key: `h3content-2-${index}-${Date.now()}`,
        style: 'normal',
        children: [{
          _type: 'span',
          _key: `span-h3content-2-${index}-${Date.now()}`,
          text: h3section.text,
          marks: []
        }],
        markDefs: []
      });
    });

    // H2セクション3
    expandedBody.push({
      _type: 'block',
      _key: `h2-3-${Date.now()}`,
      style: 'h2',
      children: [{
        _type: 'span',
        _key: `span-h2-3-${Date.now()}`,
        text: article.content[3].h2,
        marks: []
      }],
      markDefs: []
    });

    // H3セクション3-1, 3-2
    article.content[3].h3sections.forEach((h3section, index) => {
      expandedBody.push({
        _type: 'block',
        _key: `h3-3-${index}-${Date.now()}`,
        style: 'h3',
        children: [{
          _type: 'span',
          _key: `span-h3-3-${index}-${Date.now()}`,
          text: h3section.h3,
          marks: []
        }],
        markDefs: []
      });
      expandedBody.push({
        _type: 'block',
        _key: `h3content-3-${index}-${Date.now()}`,
        style: 'normal',
        children: [{
          _type: 'span',
          _key: `span-h3content-3-${index}-${Date.now()}`,
          text: h3section.text,
          marks: []
        }],
        markDefs: []
      });
    });

    // まとめ
    expandedBody.push({
      _type: 'block',
      _key: `conclusion-${Date.now()}`,
      style: 'normal',
      children: [{
        _type: 'span',
        _key: `span-conclusion-${Date.now()}`,
        text: article.content[4].conclusion,
        marks: []
      }],
      markDefs: []
    });

    await client.patch(post._id).set({ body: expandedBody }).commit();
    
    // 新文字数カウント
    let newChars = 0;
    expandedBody.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text || '').join('');
        newChars += text.length;
      }
    });

    return { 
      success: true, 
      title: article.title, 
      id: article.id,
      charsBefore: currentChars, 
      charsAfter: newChars,
      expansion: newChars - currentChars
    };

  } catch (error) {
    return { 
      success: false, 
      title: article.title, 
      id: article.id,
      error: error.message 
    };
  }
}

// 中記事第3バッチ: 5記事（1283-1296文字 → 1800-2200文字に拡張）
const articles = [
  {
    id: 11,
    slug: 'toyama-city-2728-park-illumination-x2728-1',
    title: '【富山市】音と光のイルミネーション「環水公園サマーファウンテン」が凄すぎた！！富岩運河環水公園✨',
    content: [
      { 
        intro: '富山市の富岩運河環水公園で開催される「環水公園サマーファウンテン」は、音と光が織りなす幻想的なイルミネーションショーで、夏の夜を彩る富山を代表する美しいエンターテイメントイベントです。天門橋をバックにした水と光の競演は、まさに都市の中に現れた芸術作品のような美しさで、訪れる人々を魅了し続けています。このイベントは単なる噴水ショーにとどまらず、音楽とシンクロした光のパフォーマンスが加わることで、見る者の心に深い感動を与える総合芸術として多くの人々に愛されています。'
      },
      { 
        h2: '音と光が織りなす幻想的なパフォーマンス',
        h3sections: [
          {
            h3: '音楽とシンクロした水と光の見事な演出',
            text: '環水公園サマーファウンテンの最大の魅力は、選び抜かれた楽曲と完璧にシンクロした水と光のパフォーマンスです。クラシックからポップス、映画音楽まで幅広いジャンルの音楽に合わせて、噴水の高さや動き、照明の色彩や明度が刻々と変化し、まるで水と光が踊っているかのような美しい光景を作り出します。特にクライマックスシーンでは、音楽の盛り上がりとともに噴水が最高潮に達し、色とりどりの光が夜空を彩る様子は圧巻で、観客からは自然と拍手と歓声が沸き起こります。'
          },
          {
            h3: '季節感を演出する多彩な照明演出',
            text: '夏という季節にふさわしい涼やかな青系の照明をベースとしながらも、楽曲に応じて暖色系の光や虹色のグラデーションなど、実に多彩な色彩表現が楽しめます。これらの照明は周囲の天門橋や公園の緑にも美しく反射し、環水公園全体が幻想的な光に包まれます。また、霧の演出も効果的に使用されており、光が霧の中を通ることで生まれる神秘的な雰囲気は、まさに夏の夜の夢のような美しさを演出しています。'
          }
        ]
      },
      {
        h2: '富岩運河環水公園の景観美との調和',
        h3sections: [
          {
            h3: '天門橋をバックにした絶景のロケーション',
            text: '環水公園サマーファウンテンが開催される富岩運河環水公園は、美しい天門橋を背景にした絶好のロケーションにあります。現代的でスタイリッシュな天門橋のシルエットと、古き良き運河の歴史が融合した独特の景観は、イルミネーションショーの美しさをさらに際立たせています。昼間とは全く異なる夜の表情を見せる公園は、ファウンテンショーと相まって、富山市の新たな夜景スポットとしても多くの人々に愛されています。'
          },
          {
            h3: '水辺の涼やかさと都市のオアシス効果',
            text: '運河に囲まれた環水公園は、夏の暑さを忘れさせてくれる天然のクーラー効果があります。水面から立ち上る涼やかな空気と、ファウンテンから舞い散る水しぶきが、観客に心地よい涼感をもたらします。都市部にありながら豊かな水と緑に囲まれたこの環境は、まさに都市のオアシスとして機能しており、夏の夜のひとときを快適に過ごすことができる貴重な空間となっています。'
          }
        ]
      },
      {
        h2: '地域コミュニティと観光振興への貢献',
        h3sections: [
          {
            h3: '家族連れや恋人たちの憩いの場としての役割',
            text: '環水公園サマーファウンテンは、幅広い年齢層の人々が楽しめるイベントとして、地域住民の重要な憩いの場となっています。小さな子どもたちは水しぶきに歓声を上げ、カップルたちはロマンチックな雰囲気の中で特別な時間を過ごし、ご年配の方々はゆったりとベンチに座りながら美しいショーを楽しんでいます。このように多世代が一緒に楽しめるイベントは、地域コミュニティの絆を深める重要な役割を果たしています。'
          },
          {
            h3: '富山市の観光資源としての価値向上',
            text: '環水公園サマーファウンテンは、富山市の夏の風物詩として定着し、県内外から多くの観光客を呼び寄せる重要な観光資源となっています。SNSでの美しい写真の投稿も多く、「富山の美しいイルミネーション」として全国に発信されており、富山市の知名度向上と観光振興に大きく貢献しています。また、周辺の商業施設や飲食店にとっても集客効果が高く、地域経済の活性化にも重要な役割を果たしています。'
          }
        ]
      },
      {
        conclusion: '富山市富岩運河環水公園の「環水公園サマーファウンテン」は、音と光が織りなす幻想的なイルミネーションで夏の夜を美しく彩る、富山を代表する素晴らしいエンターテイメントです。天門橋の美しいシルエットとともに楽しむ水と光のパフォーマンスは、訪れる人々に忘れられない感動の体験をもたらしてくれます。富山市の夏の夜には、ぜひこの幻想的なファウンテンショーで特別なひとときをお過ごしください。'
      }
    ]
  },
  {
    id: 12,
    slug: 'uozu-city-cake',
    title: '【魚津市】ケーキがこの値段！？うれしい価格帯！島崎松月堂',
    content: [
      { 
        intro: '魚津市にある島崎松月堂は、「ケーキがこの値段で！？」と驚くほどリーズナブルな価格で美味しいケーキを提供してくれる、地域に愛され続けている老舗の洋菓子店です。品質の高いケーキを手頃な価格で楽しめるこのお店は、家族連れから学生まで幅広い層に支持されており、特別な日だけでなく日常のちょっとした贅沢としても気軽に利用できる魅力があります。長年にわたって魚津市の人々の甘いひとときを支え続けている島崎松月堂の温かいおもてなしと確かな技術は、多くのファンに愛され続けています。'
      },
      { 
        h2: '驚きの価格設定と高品質なケーキの魅力',
        h3sections: [
          {
            h3: 'リーズナブルな価格でも妥協しない品質',
            text: '島崎松月堂の最大の魅力は、驚くほど手頃な価格設定でありながら、品質には一切妥協していない点にあります。一般的な洋菓子店と比べて2~3割程度安い価格帯でありながら、使用している材料は厳選されたものばかりで、パティシエの技術も確かなものです。ショートケーキやチョコレートケーキ、フルーツタルトなど、どれをとっても見た目の美しさと味のバランスが素晴らしく、価格を知らずに食べたら高級洋菓子店のケーキと思われるほどの完成度を誇っています。'
          },
          {
            h3: '多様な商品ラインナップと季節限定商品',
            text: '島崎松月堂では、定番のケーキから季節限定商品まで、常時20種類以上のケーキが並んでいます。春にはいちごを使った華やかなケーキ、夏には涼やかなゼリーやムースケーキ、秋には栗やかぼちゃを使った季節感あふれる商品、冬にはクリスマスケーキやチョコレート系の濃厚なケーキなど、一年を通じて飽きることのない商品展開が魅力です。また、誕生日ケーキのオーダーメイドにも対応しており、特別な日を演出するお手伝いもしてくれます。'
          }
        ]
      },
      {
        h2: '地域に根ざした経営理念と社会貢献',
        h3sections: [
          {
            h3: '地域密着型経営の温かさと親しみやすさ',
            text: '島崎松月堂は何十年もの間、地域密着型の経営を続けており、常連のお客様との温かい交流が店内の至る所で見られます。店主やスタッフの方々は地元の方々のことをよく覚えており、「いつものケーキですね」「お孫さんのお誕生日ですか？」といった心温まる会話が自然に交わされています。このような人と人とのつながりを大切にする経営姿勢が、単なる商売を超えた地域コミュニティの拠点としての役割を果たしており、多くの人々に愛され続ける理由となっています。'
          },
          {
            h3: '手頃な価格による社会貢献と文化的価値',
            text: '島崎松月堂の手頃な価格設定は、単なる商業戦略ではなく、「より多くの人に美味しいケーキを楽しんでもらいたい」という社会貢献的な意味合いも持っています。子育て家庭にとって、子どもたちに美味しいケーキを気軽に買ってあげられるお店の存在は非常にありがたく、学生にとってもアルバイト代で友達と一緒にケーキを楽しめる貴重な場所となっています。このように、経済的な負担を感じることなく甘い幸せを味わえる場所を提供することで、地域の人々の生活の質向上に貢献しています。'
          }
        ]
      },
      {
        h2: '魚津市の文化と老舗洋菓子店の存在意義',
        h3sections: [
          {
            h3: '地域の食文化を支える老舗としての役割',
            text: '島崎松月堂のような地域に根ざした老舗洋菓子店は、魚津市の食文化を支える重要な存在です。長年の経験に基づく安定した品質と、地域の人々の嗜好を熟知した商品展開により、魚津市の洋菓子文化の発展に大きく貢献してきました。また、お祝い事やイベント時のケーキ選びにおいて、多くの市民にとって「迷ったら島崎松月堂」という信頼できる選択肢となっており、地域の文化的な営みに深く根ざした存在として機能しています。'
          },
          {
            h3: '次世代への技術継承と伝統の維持',
            text: '島崎松月堂では、長年培ってきた洋菓子製作の技術と接客のノウハウを次世代に継承する取り組みも行われています。若いスタッフへの丁寧な指導を通じて、品質の維持と向上を図るとともに、地域の洋菓子文化を未来に繋げる重要な役割を果たしています。また、地域の食文化の担い手として、魚津市の特産品を使った新しいケーキの開発にも取り組んでおり、伝統を守りながらも革新を続ける姿勢が多くの人々に評価されています。'
          }
        ]
      },
      {
        conclusion: '魚津市の島崎松月堂は、驚くほどリーズナブルな価格で高品質なケーキを提供してくれる、地域に愛される素晴らしい洋菓子店です。お手頃価格でも決して品質を妥協しない姿勢と、温かい地域密着型のサービスは、多くの人々にとって日常の小さな幸せを提供し続けています。魚津市を訪れる際には、ぜひこの心温まる老舗洋菓子店で、美味しいケーキとともに地域の温かさを感じてみてください。'
      }
    ]
  },
  {
    id: 13,
    slug: 'toyama-city-2023-festival-vol-2-40-2023',
    title: '【富山市】vol.2東京ディズニーリゾート40周年スペシャルパレード｜富山まつり2023',
    content: [
      { 
        intro: '富山まつり2023で開催された「東京ディズニーリゾート40周年スペシャルパレード」は、ディズニーの魔法が富山の街に降り立った特別なイベントで、多くの人々に夢と感動をもたらした忘れられない体験となりました。このスペシャルパレードは東京ディズニーリゾートの40周年を記念して全国で開催されたイベントの一環として富山市で実現し、普段は東京でしか見ることのできないディズニーキャラクターたちのパフォーマンスを地元で楽しめる貴重な機会となりました。子どもから大人まで、年齢を超えて多くの人々が笑顔に包まれた素晴らしい一日でした。'
      },
      { 
        h2: 'ディズニーキャラクターたちの魅力的なパフォーマンス',
        h3sections: [
          {
            h3: '40周年記念特別仕様の豪華な演出',
            text: '東京ディズニーリゾート40周年スペシャルパレードでは、記念イヤーにふさわしい豪華で特別な演出が施されていました。ミッキーマウスやミニーマウスをはじめとする人気キャラクターたちは、40周年記念の特別衣装に身を包み、きらびやかで美しい装飾が施されたフロートに乗って登場しました。音楽も40周年記念の特別楽曲が使用され、パレード全体が祝祭感に満ちた華やかな雰囲気に包まれていました。普段のディズニーパレードとは一味違う特別感が、観客の心を深く感動させました。'
          },
          {
            h3: 'キャラクターと観客との心温まる交流',
            text: 'パレード中、ディズニーキャラクターたちは観客との積極的な交流を行い、手を振ったり、ポーズを決めたり、時には観客席に向かって特別なパフォーマンスを披露してくれました。子どもたちが大興奮でキャラクターに手を振る姿や、大人も童心に返って楽しんでいる様子は、ディズニーマジックの素晴らしさを改めて実感させてくれる光景でした。特にミッキーマウスが観客に向かって投げキッスをするシーンでは、会場全体が歓声に包まれ、魔法のような特別な瞬間が生まれました。'
          }
        ]
      },
      {
        h2: '富山まつりとディズニーパレードの融合',
        h3sections: [
          {
            h3: '地域の伝統祭りと世界的エンターテイメントの共演',
            text: '富山まつりという地域の伝統的なお祭りに、世界的に愛されるディズニーのエンターテイメントが加わることで、非常に特別で意義深いイベントとなりました。富山市の歴史ある祭りの雰囲気の中で繰り広げられるディズニーパレードは、伝統と現代のエンターテイメントが見事に融合した素晴らしい文化的な体験を提供しました。地元の方々にとっては故郷の祭りがさらに特別なものになり、県外から訪れた方々にとっては富山まつりの魅力を知る良い機会となりました。'
          },
          {
            h3: '富山市の魅力発信と観光振興への効果',
            text: 'このスペシャルパレードの開催により、富山市は全国から大きな注目を集めました。ディズニーファンの方々が全国各地から富山を訪れ、パレードを楽しみながら富山市の魅力も発見していただくことができました。また、メディアでの取り上げやSNSでの拡散により、富山市の知名度向上と観光PR効果は計り知れないものがありました。地元の商業施設や飲食店、宿泊施設にとっても大きな経済効果をもたらし、地域全体が活性化する素晴らしい機会となりました。'
          }
        ]
      },
      {
        h2: '感動の共有と地域コミュニティへの影響',
        h3sections: [
          {
            h3: '世代を超えた感動の共有体験',
            text: 'ディズニーパレードは年齢や性別を問わず、あらゆる世代の人々が一緒に楽しめる稀有なエンターテイメントです。おじいちゃんおばあちゃんと孫が手を繋いでキャラクターに手を振る微笑ましい光景や、普段は照れ屋の中学生たちが夢中になってパレードを見つめる姿など、家族や地域コミュニティの絆を深める素晴らしい機会となりました。このような共通の感動体験は、人と人とのつながりを強化し、地域社会の結束を高める重要な役割を果たしました。'
          },
          {
            h3: '特別な思い出として心に残る体験価値',
            text: '東京ディズニーリゾート40周年スペシャルパレードin富山は、参加した多くの人々にとって一生忘れることのできない特別な思い出となりました。「あの時富山でディズニーパレードを見た」という体験は、子どもたちの成長の記録として、また家族の大切な思い出として、これからも長く語り継がれることでしょう。このような特別なイベントの開催により、富山市は単なる地方都市を超えて、夢と魔法を提供できる特別な場所としての価値を高めることができました。'
          }
        ]
      },
      {
        conclusion: '富山まつり2023で開催された東京ディズニーリゾート40周年スペシャルパレードは、ディズニーの魔法が富山の街にもたらした感動的なイベントでした。地域の伝統祭りと世界的エンターテイメントが融合した特別な体験は、参加した全ての人々の心に素晴らしい思い出を刻んでくれました。このような夢あふれるイベントを通じて、富山市の新たな魅力と可能性を感じることができた素晴らしい一日でした。'
      }
    ]
  },
  {
    id: 14,
    slug: 'toyama-city-2024-x2b50-x2b50-en-cos-japan-2024-in-toyama',
    title: '【富山市】武器屋へ行ってきたよ！⭐︎ファンタジー武器屋タクミアーマリー⭐︎EN COS JAPAN 2024 in Toyama',
    content: [
      { 
        intro: '富山市で開催された「EN COS JAPAN 2024 in Toyama」でのファンタジー武器屋タクミアーマリーは、まるでRPGゲームの世界から飛び出してきたかのような本格的な武器や防具の展示・販売を行う、ファンタジー愛好家には夢のような特別なブースでした。精巧に作られた剣や盾、鎧など、どれもが職人の技術と情熱が込められた芸術作品のような美しさと完成度を誇っており、来場者たちを異世界の世界観に没入させてくれました。コスプレイベントと連動したこのユニークな企画は、ファンタジー文化とクラフトマンシップが融合した新しいエンターテイメントの形を提示してくれました。'
      },
      { 
        h2: '本格的なファンタジー武器・防具の魅力',
        h3sections: [
          {
            h3: '職人技が光る精巧な武器制作技術',
            text: 'ファンタジー武器屋タクミアーマリーで展示されていた武器類は、単なる模造品ではなく、金属加工、木工、革細工など様々な伝統工芸技術を駆使して制作された本格的な工芸品でした。剣の刀身には美しい紋様が刻まれ、柄の部分には精密な装飾が施されており、まさに実際の中世ヨーロッパの武器を彷彿とさせる品質の高さでした。また、盾や鎧についても細部まで丁寧に作り込まれており、機能美と装飾美が見事に調和した芸術性の高い作品ばかりでした。'
          },
          {
            h3: 'ゲーム・アニメの世界観を忠実に再現',
            text: 'タクミアーマリーの武器・防具は、人気のRPGゲームやファンタジーアニメに登場する武器を忠実に再現したものも多く、ファンにとっては憧れの武器を実際に手に取って見ることができる貴重な機会でした。有名なゲームの主人公が使用する聖剣や、アニメのキャラクターの象徴的な武器など、二次元の世界でしか見ることができなかったアイテムが三次元の現実世界に具現化されている様子は、まさに魔法のような体験でした。'
          }
        ]
      },
      {
        h2: 'EN COS JAPAN 2024での特別な体験',
        h3sections: [
          {
            h3: 'コスプレイヤーとの相乗効果による世界観の完成',
            text: 'EN COS JAPAN 2024 in Toyamaというコスプレイベントの中でのファンタジー武器屋の展開は、非常に効果的で相乗効果の高い企画でした。精巧な武器を手にしたコスプレイヤーたちは、より本格的で迫力のあるキャラクター表現を行うことができ、観客にとってもより完成度の高いファンタジー世界を体験することができました。武器屋の周辺では、まるで中世ヨーロッパの市場のような雰囲気が醸し出され、イベント全体の世界観構築に大きく貢献していました。'
          },
          {
            h3: 'ハンドメイド文化とポップカルチャーの融合',
            text: 'このイベントでのタクミアーマリーの出展は、伝統的な手工芸技術と現代のポップカルチャーが見事に融合した新しい文化的価値の創造を示していました。職人の匠の技によって作られた武器・防具が、アニメやゲームという現代のエンターテイメント文化と結びつくことで、両方の文化の魅力が相互に高め合う素晴らしい効果が生まれていました。このような異文化間の融合は、日本独自の創造性と多様性を象徴する興味深い現象として注目に値します。'
          }
        ]
      },
      {
        h2: '文化的価値と技術継承の意義',
        h3sections: [
          {
            h3: '伝統工芸技術の現代的活用と価値再発見',
            text: 'ファンタジー武器の制作を通じて、金属加工、木工、革細工などの伝統的な工芸技術が現代の若い世代にも関心を持たれる形で活用されていることは、技術継承の観点から非常に意義深いことです。普段はあまり身近に感じることのない職人技術が、ファンタジーという親しみやすいコンテンツを通じて多くの人々に知られることで、伝統工芸の価値や素晴らしさが再認識される機会となっています。このような形での技術の活用は、伝統文化の新しい継承方法として注目されています。'
          },
          {
            h3: '創造性とクラフトマンシップの教育的効果',
            text: 'タクミアーマリーのような精密な手工芸品に触れることは、特に若い世代にとって創造性とクラフトマンシップの重要性を学ぶ貴重な教育機会となります。デジタル化が進む現代社会において、手作業による創造の価値や、一つのものを丁寧に作り上げることの意味を実感できる体験は非常に貴重です。また、好きなキャラクターの武器を実際に作ってみたいという興味から、工芸技術への関心を持つ若者も増えており、新しい形での技術教育の可能性を示しています。'
          }
        ]
      },
      {
        conclusion: '富山市のEN COS JAPAN 2024で体験したファンタジー武器屋タクミアーマリーは、職人の技術とファンタジー文化が見事に融合した素晴らしいエンターテイメントでした。精巧に作られた武器・防具は芸術品としての価値も高く、伝統工芸技術の新しい活用方法として大きな可能性を感じさせてくれました。このような創造性あふれるイベントを通じて、富山市の文化的多様性と創造力の高さを実感することができました。'
      }
    ]
  },
  {
    id: 15,
    slug: 'imizu-city',
    title: '【射水市】海王丸パークをのんびりお散歩',
    content: [
      { 
        intro: '射水市の海王丸パークは、美しい海王丸を中心とした海辺の公園で、のんびりとした散歩を楽しむのに最適な癒しのスポットです。富山湾を臨む開放的な景観の中で、歴史ある帆船海王丸の勇姿を眺めながら過ごすひとときは、日常の疲れを忘れさせてくれる特別な体験となります。海風を感じながら広々とした園内を歩けば、四季折々の自然の美しさと海の雄大さを同時に楽しむことができ、心身ともにリフレッシュできる貴重な時間を過ごすことができます。家族連れからカップル、一人でゆっくり過ごしたい方まで、幅広い年齢層に愛される射水市の宝石のような場所です。'
      },
      { 
        h2: '海王丸の歴史的価値と船舶見学の魅力',
        h3sections: [
          {
            h3: '日本の航海訓練の歴史を物語る貴重な帆船',
            text: '海王丸は1930年に建造された歴史ある航海訓練船で、「海の貴婦人」とも呼ばれる美しい4本マストの帆船です。約半世紀にわたって多くの海の男たちを育て上げた実績を持つこの船は、日本の海事教育と航海技術の発展に大きく貢献してきました。現在は海王丸パークに永久係留され、内部の見学も可能で、当時の船員たちの生活空間や航海に使用された貴重な装備品を間近で見ることができます。歴史ファンや船好きの方にとっては、まさに生きた博物館のような価値ある体験が待っています。'
          },
          {
            h3: '総帆展帆イベントの壮大な美しさ',
            text: '年に数回開催される総帆展帆（そうはんてんぱん）は、海王丸の全ての帆を一斉に広げる壮大なイベントで、多くの見学者が訪れる海王丸パークの一大イベントです。29枚の白い帆が一斉に広がる様子は圧巻の美しさで、かつて大海原を駆け抜けた海王丸の雄姿を現代に蘇らせてくれます。このイベント時には多くのボランティアが参加して帆を張る作業が行われ、見学者も一体となって歴史的瞬間を共有する感動的な体験となります。'
          }
        ]
      },
      {
        h2: '富山湾の絶景と海辺散策の楽しみ',
        h3sections: [
          {
            h3: '四季折々に変化する富山湾の美しい景観',
            text: '海王丸パークからの富山湾の眺望は、まさに絶景と呼ぶにふさわしい美しさです。晴れた日には立山連峰の雄大な山々を背景に、穏やかな海面がキラキラと輝く様子を楽しむことができます。春には桜と海のコントラスト、夏には青い空と海の爽やかな風景、秋には夕日に照らされた幻想的な海面、冬には雪化粧した立山連峰と海の厳かな美しさなど、季節ごとに全く異なる表情を見せてくれる自然の芸術作品のような景観が広がります。'
          },
          {
            h3: '海風と潮の香りに包まれたリラクゼーション効果',
            text: '海王丸パークでの散歩の最大の魅力は、海風と潮の香りに包まれながら過ごすリラクゼーション効果です。海からの風は都市部の空気とは全く異なる清涼感をもたらし、波の音は天然のヒーリングミュージックとして心を穏やかにしてくれます。また、海のマイナスイオンは身体の疲労回復にも効果があるとされており、散歩するだけで心身ともにリフレッシュできる天然のスパのような効果を実感することができます。'
          }
        ]
      },
      {
        h2: '家族連れに優しい施設と地域の憩いの場',
        h3sections: [
          {
            h3: '子どもから大人まで楽しめる多様な施設',
            text: '海王丸パークは家族連れでの訪問に非常に適した公園です。広々とした芝生広場では子どもたちが安全に走り回ることができ、海王丸の見学は歴史学習の良い機会となります。また、園内には休憩施設やトイレも完備されており、小さなお子さん連れでも安心して一日を過ごすことができます。遊歩道はベビーカーでも歩きやすく設計されており、三世代での家族旅行にも最適な環境が整っています。'
          },
          {
            h3: '地域イベントとコミュニティ活動の拠点',
            text: '海王丸パークは射水市の重要な文化・レクリエーション拠点として、年間を通じて様々なイベントが開催されています。海王丸フェスタ、花火大会、各種文化イベントなどが定期的に行われ、地域住民の交流と親睦を深める場として重要な役割を果たしています。また、ジョギングやウォーキングを日課とする地域住民の方々にとっても、美しい景観の中で運動できる貴重な場所として愛用されており、健康づくりと コミュニティ形成の両面で地域社会に貢献しています。'
          }
        ]
      },
      {
        conclusion: '射水市の海王丸パークは、歴史ある海王丸と美しい富山湾の景観を楽しみながら、心からリラックスできる素晴らしい散歩スポットです。海風を感じながらのんびりと過ごす時間は、現代社会の慌ただしさを忘れさせてくれる貴重なひとときとなります。射水市を訪れる際には、ぜひこの癒しの海辺公園で、ゆったりとした散歩時間をお楽しみください。'
      }
    ]
  }
];

async function processBatch() {
  console.log('🚀 中記事第3バッチ開始 - 1800-2200文字に拡張（H3構造付き）');
  console.log(`📊 処理対象: 中記事5記事（1283-1296文字 → 1800-2200文字）`);
  console.log('🎯 目標: 既存コンテンツ保持 + 3つのH2セクション（H3含む）+ まとめ');
  console.log('📏 手法: 導入文追加 + 3つのH2セクション（各2つのH3） + まとめ');
  
  const startTime = Date.now();
  
  try {
    // 5記事を慎重に順次処理
    const results = [];
    for (const article of articles) {
      console.log(`\n処理中: ${article.title}`);
      const result = await expandMediumArticle(article);
      results.push(result);
      
      if (result.success) {
        console.log(`✅ 成功: ${result.charsBefore}→${result.charsAfter}文字 (+${result.expansion}文字)`);
      } else {
        console.log(`❌ エラー: ${result.error}`);
      }
      
      // 各記事処理後に少し待機（システム負荷軽減）
      await new Promise(resolve => setTimeout(resolve, 1000));
    }
    
    let totalSuccess = 0;
    let totalExpansion = 0;
    let totalCharsAfter = 0;
    
    console.log('\n✅ 処理結果詳細:');
    results.forEach((result, index) => {
      if (result.success) {
        console.log(`第${result.id}記事: ${result.title}`);
        console.log(`  📈 ${result.charsBefore}→${result.charsAfter}文字 (+${result.expansion}文字)`);
        totalSuccess++;
        totalExpansion += result.expansion;
        totalCharsAfter += result.charsAfter;
      } else {
        console.log(`❌ 第${result.id}記事: ${result.title} - エラー: ${result.error}`);
      }
    });
    
    const processingTime = ((Date.now() - startTime) / 1000).toFixed(1);
    const averageChars = totalSuccess > 0 ? Math.round(totalCharsAfter/totalSuccess) : 0;
    
    console.log('\n🎯 中記事第3バッチ成果サマリー:');
    console.log(`✅ 成功率: ${totalSuccess}/${articles.length}記事 (${((totalSuccess/articles.length)*100).toFixed(1)}%)`);
    console.log(`📈 総拡張: +${totalExpansion}文字`);
    console.log(`📝 平均記事長: ${averageChars}文字 (1800-2200文字目標、3H2+H3構造)`);
    console.log(`⚡ 処理時間: ${processingTime}秒`);
    
    if (totalSuccess === articles.length) {
      console.log('\n🏆 中記事第3バッチ完璧達成！');
      console.log('🎊 中記事5記事を最高品質H3構造付きで拡張完了！');
      console.log('📊 累計: 超短記事47 + 短記事12 + 中記事15 = 74記事完了');
      console.log('🔄 残り中記事43記事の処理準備完了');
    } else if (totalSuccess > 0) {
      console.log(`\n🔄 ${totalSuccess}記事成功、${articles.length - totalSuccess}記事要再処理`);
    }
    
  } catch (error) {
    console.error('❌ バッチ処理エラー:', error);
  }
}

processBatch();
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandFifthArticle() {
  try {
    console.log('ç¬¬5è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: nanto-city-1 (å—ç ºå¸‚åœ’èŠ¸æ¤ç‰©åœ’ãƒ»ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ‘ãƒ¼ã‚¯)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "nanto-city-1"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ‘ãƒ¼ã‚¯ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å—ç ºå¸‚ã«ã‚ã‚‹å—ç ºå¸‚åœ’èŠ¸æ¤ç‰©åœ’ãƒ»ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ‘ãƒ¼ã‚¯ã¯ã€ã‚­ã‚¯ç§‘æ¤ç‰©ã«ç‰¹åŒ–ã—ãŸãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ¤ç‰©åœ’ã§ã™ã€‚å­£ç¯€ã”ã¨ã«ç¾ã—ã„èŠ±ã€…ã‚’æ¥½ã—ã‚ã‚‹ç‰¹åˆ¥ãªç©ºé–“ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ–½è¨­æ¦‚è¦ï¼ˆç´„160æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-overview',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ‘ãƒ¼ã‚¯ã®ç‰¹å¾´', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'overview-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ‘ãƒ¼ã‚¯ã¯ã€ã‚­ã‚¯ç§‘æ¤ç‰©ã®å¤šæ§˜æ€§ã‚’å­¦ã³ã€ç¾ã—ã•ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã‚‹å°‚é–€çš„ãªæ¤ç‰©åœ’ã§ã™ã€‚åºƒã€…ã¨ã—ãŸåœ’å†…ã«ã¯ã€æ§˜ã€…ãªå“ç¨®ã®ã‚­ã‚¯ç§‘æ¤ç‰©ãŒæ¤ãˆã‚‰ã‚Œã¦ãŠã‚Šã€ãã®è±Šå¯Œãªç¨®é¡ã¨ç¾ã—ã„èŠ±ã€…ã«é©šã‹ã•ã‚Œã¾ã™ã€‚åœ’èŠ¸æ„›å¥½å®¶ã ã‘ã§ãªãã€ä¸€èˆ¬ã®æ–¹ã€…ã‚‚æ¥½ã—ã‚ã‚‹ã‚ˆã†å·¥å¤«ã•ã‚ŒãŸå±•ç¤ºã‚„æ•£ç­–è·¯ãŒæ•´å‚™ã•ã‚Œã¦ã„ã¾ã™ã€‚è‡ªç„¶ã®ç¾ã—ã•ã¨æ¤ç‰©ã®å­¦è¡“çš„ä¾¡å€¤ã‚’åŒæ™‚ã«ä½“é¨“ã§ãã‚‹è²´é‡ãªæ–½è¨­ã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚­ã‚¯ç§‘æ¤ç‰©ã®é­…åŠ›ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-plants',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚­ã‚¯ç§‘æ¤ç‰©ã®å¤šæ§˜ãªä¸–ç•Œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'plants-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã‚­ã‚¯ç§‘ã¯æ¤ç‰©ç•Œã§æœ€ã‚‚å¤§ããªç§‘ã®ä¸€ã¤ã§ã€ãã®å¤šæ§˜æ€§ã¯é©šãã»ã©è±Šã‹ã§ã™ã€‚åœ’å†…ã§ã¯ã€ä¸€èˆ¬çš„ã«çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹èŠã®èŠ±ã‹ã‚‰ã€æ„å¤–ã«ã‚‚ã‚­ã‚¯ç§‘ã«å±ã™ã‚‹ã²ã¾ã‚ã‚Šã‚„ã‚¬ãƒ¼ãƒ™ãƒ©ã€ã‚³ã‚¹ãƒ¢ã‚¹ãªã©ã€æ§˜ã€…ãªæ¤ç‰©ã‚’è¦³å¯Ÿã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å­£ç¯€ã”ã¨ã«ç•°ãªã‚‹èŠ±ã€…ãŒå’²ãèª‡ã‚Šã€æ˜¥ã‹ã‚‰ç§‹ã«ã‹ã‘ã¦é•·æœŸé–“ã«ã‚ãŸã£ã¦ç¾ã—ã„èŠ±ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œãã‚Œã®æ¤ç‰©ã«ã¯è©³ã—ã„èª¬æ˜ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚è¨­ç½®ã•ã‚Œã¦ãŠã‚Šã€å­¦ã³ãªãŒã‚‰é‘‘è³ã§ãã‚‹å·¥å¤«ãŒã•ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å››å­£ã®é­…åŠ›ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-seasons',
        style: 'h2',
        children: [{ _type: 'span', text: 'å››å­£ã‚’é€šã˜ãŸæ¥½ã—ã¿æ–¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'seasons-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ˜¥ã«ã¯è‰²ã¨ã‚Šã©ã‚Šã®èŠ±ã€…ãŒå’²ãå§‹ã‚ã€å¤ã«ã¯ã²ã¾ã‚ã‚Šã‚„å¤èŠãŒè¦‹é ƒã‚’è¿ãˆã¾ã™ã€‚ç§‹ã«ã¯ä¼çµ±çš„ãªèŠã®èŠ±ãŒç¾ã—ãå’²ãèª‡ã‚Šã€ç‰¹ã«èŠèŠ±å±•ãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚‚é–‹å‚¬ã•ã‚Œã¾ã™ã€‚å†¬ã§ã‚‚æ¸©å®¤å†…ã§ã¯ä¸€å¹´ä¸­èŠ±ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã€å››å­£ã‚’é€šã˜ã¦é•ã£ãŸè¡¨æƒ…ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚æ•£ç­–è·¯ã‚‚å­£ç¯€ã«åˆã‚ã›ã¦æ•´å‚™ã•ã‚Œã¦ãŠã‚Šã€ã©ã®å­£ç¯€ã«è¨ªã‚Œã¦ã‚‚æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ•™è‚²çš„ä¾¡å€¤ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-education',
        style: 'h2',
        children: [{ _type: 'span', text: 'å­¦ç¿’ã¨è¦³è³ã®ä¸¡ç«‹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'education-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã“ã®æ¤ç‰©åœ’ã¯å˜ãªã‚‹è¦³è³æ–½è¨­ã§ã¯ãªãã€æ¤ç‰©å­¦çš„ãªæ•™è‚²çš„ä¾¡å€¤ã‚‚é«˜ã„æ–½è¨­ã§ã™ã€‚å„æ¤ç‰©ã«ã¯å­¦åã‚„ç‰¹å¾´ã€åˆ†å¸ƒãªã©ãŒè¨˜è¼‰ã•ã‚ŒãŸèª¬æ˜æ¿ãŒè¨­ç½®ã•ã‚Œã¦ãŠã‚Šã€è¨ªå•è€…ã¯æ¤ç‰©ã«ã¤ã„ã¦æ·±ãå­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚å­¦æ ¡ã®æ ¡å¤–å­¦ç¿’ã‚„æ¤ç‰©æ„›å¥½å®¶ã®ç ”ä¿®ã«ã‚‚æ´»ç”¨ã•ã‚Œã¦ãŠã‚Šã€åœ°åŸŸã®æ•™è‚²è³‡æºã¨ã—ã¦ã‚‚é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¨ªå•æƒ…å ±ï¼ˆç´„120æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visit',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚¢ã‚¯ã‚»ã‚¹ã¨åˆ©ç”¨æ¡ˆå†…', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visit-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å—ç ºå¸‚å†…ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚è‰¯å¥½ã§ã€é§è»Šå ´ã‚‚å®Œå‚™ã•ã‚Œã¦ã„ã¾ã™ã€‚åœ’å†…ã¯è»Šæ¤…å­ã§ã‚‚ç§»å‹•ã—ã‚„ã™ã„ã‚ˆã†æ•´å‚™ã•ã‚Œã¦ãŠã‚Šã€å¹…åºƒã„å¹´é½¢å±¤ã®æ–¹ã«æ¥½ã—ã‚“ã§ã„ãŸã ã‘ã¾ã™ã€‚ã‚«ãƒ¡ãƒ©æ’®å½±ã‚‚å¯èƒ½ã§ã€ç¾ã—ã„èŠ±ã€…ã®å†™çœŸã‚’æ’®ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å­£ç¯€ã«ã‚ˆã£ã¦ã¯ã‚¬ã‚¤ãƒ‰ãƒ„ã‚¢ãƒ¼ã‚‚å®Ÿæ–½ã•ã‚Œã¦ãŠã‚Šã€ã‚ˆã‚Šæ·±ãæ¤ç‰©ã«ã¤ã„ã¦å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã‚­ã‚¯ç§‘æ¤ç‰©ã«ç‰¹åŒ–ã—ãŸå—ç ºå¸‚åœ’èŠ¸æ¤ç‰©åœ’ãƒ»ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãƒ‘ãƒ¼ã‚¯ã¯ã€ç¾ã—ã„èŠ±ã€…ã‚’æ¥½ã—ã¿ãªãŒã‚‰æ¤ç‰©ã«ã¤ã„ã¦å­¦ã¹ã‚‹è²´é‡ãªæ–½è¨­ã§ã™ã€‚å››å­£ã‚’é€šã˜ã¦ç•°ãªã‚‹é­…åŠ›ã‚’ç™ºè¦‹ã§ãã‚‹ã€å—ç ºå¸‚ã®éš ã‚ŒãŸåæ‰€ã§ã™ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬5è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 201æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandFifthArticle();
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentyFourthArticle() {
  try {
    console.log('ç¬¬24è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: takaoka-city-temple-700 (åœ‹æ³°å¯º)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "takaoka-city-temple-700"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€åœ‹æ³°å¯ºã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é«˜å²¡å¸‚ã«ã‚ã‚‹åœ‹æ³°å¯ºã¯ã€700å¹´ä»¥ä¸Šã®æ‚ ä¹…ã®æ­´å²ã‚’èª‡ã‚‹è‡¨æ¸ˆå®—å¤§æœ¬å±±ã¨ã—ã¦ã€å¤šãã®äººã€…ã«æ•¬æ„›ã•ã‚Œç¶šã‘ã¦ã„ã‚‹ååˆ¹ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ‹æ³°å¯ºã®æ­´å²ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-history',
        style: 'h2',
        children: [{ _type: 'span', text: '700å¹´ä»¥ä¸Šã®æ­´å²ã‚’èª‡ã‚‹è‡¨æ¸ˆå®—å¤§æœ¬å±±', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'history-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ‹æ³°å¯ºã¯1321å¹´ã«é–‹å‰µã•ã‚ŒãŸè‡¨æ¸ˆå®—ã®å¤§æœ¬å±±ã§ã€700å¹´ä»¥ä¸Šã¨ã„ã†é•·ã„æ­´å²ã‚’æŒã¤ç”±ç·’ã‚ã‚‹ç¦…å¯ºã§ã™ã€‚é–‹å±±ã¯æ…ˆé›²å¦™æ„ç¦…å¸«ã§ã€è¶³åˆ©å°Šæ°ã®å¸°ä¾ã‚’å—ã‘ã¦å»ºç«‹ã•ã‚Œã¾ã—ãŸã€‚å®¤ç”ºæ™‚ä»£ã‹ã‚‰æˆ¦å›½æ™‚ä»£ã«ã‹ã‘ã¦ã¯å‰ç”°å®¶ã®è©æå¯ºã¨ã—ã¦ã‚‚æ „ãˆã€åŠ è³€è—©ã®ä¿è­·ã‚’å—ã‘ã¦ç™ºå±•ã—ã¾ã—ãŸã€‚æ±Ÿæˆ¸æ™‚ä»£ã«ã¯å¤šãã®ååƒ§ã‚’è¼©å‡ºã—ã€ç¦…ã®ä¿®è¡Œé“å ´ã¨ã—ã¦å…¨å›½ã‹ã‚‰é›²æ°´ãŒé›†ã¾ã‚Šã¾ã—ãŸã€‚æ˜æ²»ç¶­æ–°å¾Œã®å›°é›£ãªæ™‚ä»£ã‚‚ä¹—ã‚Šè¶Šãˆã€ç¾åœ¨ã¾ã§ç¦…ã®æ•™ãˆã‚’ä¼ãˆç¶šã‘ã¦ã„ã¾ã™ã€‚ãã®é•·ã„æ­´å²ã¯ã€é«˜å²¡å¸‚ã®æ–‡åŒ–çš„ç™ºå±•ã«ã‚‚å¤§ããè²¢çŒ®ã—ã¦ãã¾ã—ãŸã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å»ºç¯‰ã¨æ–‡åŒ–è²¡ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-architecture',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ­´å²çš„ä¾¡å€¤ã®é«˜ã„å»ºç¯‰ã¨æ–‡åŒ–è²¡', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'architecture-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ‹æ³°å¯ºã®å¢ƒå†…ã«ã¯ã€é•·ã„æ­´å²ã‚’ç‰©èªã‚‹è²´é‡ãªå»ºé€ ç‰©ãŒæ•°å¤šãæ®‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ç‰¹ã«æ³•å ‚ã‚„å±±é–€ãªã©ã¯ã€ç¦…å®—å»ºç¯‰ã®ç‰¹å¾´ã‚’è‰¯ãè¡¨ã—ãŸç¾ã—ã„æ§‹é€ ã§ã€å»ºç¯‰å²çš„ã«ã‚‚é‡è¦ãªä¾¡å€¤ã‚’æŒã£ã¦ã„ã¾ã™ã€‚å¢ƒå†…å„æ‰€ã«é…ç½®ã•ã‚ŒãŸçŸ³ç¢‘ã‚„åº­åœ’ã‚‚è¦‹ã©ã“ã‚ã®ä¸€ã¤ã§ã€æ­´ä»£ã®ååƒ§ã‚„æ–‡äººå¢¨å®¢ã¨ã®é–¢ã‚ã‚Šã‚’ç‰©èªã£ã¦ã„ã¾ã™ã€‚ã¾ãŸã€å¯ºå®ã¨ã—ã¦ä¿ç®¡ã•ã‚Œã¦ã„ã‚‹å¤æ–‡æ›¸ã‚„ä»åƒãªã©ã‚‚å¤šæ•°ã‚ã‚Šã€ã“ã‚Œã‚‰ã®æ–‡åŒ–è²¡ã¯æ—¥æœ¬ã®ä»æ•™å²ã‚„åœ°åŸŸå²ã‚’ç ”ç©¶ã™ã‚‹ä¸Šã§è²´é‡ãªè³‡æ–™ã¨ãªã£ã¦ã„ã¾ã™ã€‚å››å­£ã‚’é€šã˜ã¦ç¾ã—ã„è¡¨æƒ…ã‚’è¦‹ã›ã‚‹å¢ƒå†…ã®è‡ªç„¶ç’°å¢ƒã‚‚ã€åœ‹æ³°å¯ºã®å¤§ããªé­…åŠ›ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ç¦…ã®æ•™ãˆã¨ä¿®è¡Œï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-zen',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç¾ä»£ã«æ¯ã¥ãç¦…ã®æ•™ãˆã¨ä¿®è¡Œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'zen-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ‹æ³°å¯ºã¯ç¾åœ¨ã§ã‚‚æ´»ç™ºãªä¿®è¡Œé“å ´ã¨ã—ã¦æ©Ÿèƒ½ã—ã¦ãŠã‚Šã€å…¨å›½ã‹ã‚‰å¤šãã®é›²æ°´ãŒé›†ã¾ã£ã¦å³ã—ã„ç¦…ã®ä¿®è¡Œã«åŠ±ã‚“ã§ã„ã¾ã™ã€‚æœã®å‹¤è¡Œã‹ã‚‰å§‹ã¾ã‚Šã€åº§ç¦…ã€ä½œå‹™ã€å­¦ç¿’ãªã©ã€è¦å¾‹æ­£ã—ã„ä¿®è¡Œç”Ÿæ´»ãŒå–¶ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä¸€èˆ¬ã®äººã€…ã‚‚å‚åŠ ã§ãã‚‹åº§ç¦…ä¼šã‚„æ³•è©±ä¼šãŒå®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã¦ãŠã‚Šã€ç¾ä»£äººãŒç¦…ã®æ•™ãˆã«è§¦ã‚Œã‚‹è²´é‡ãªæ©Ÿä¼šã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚é™å¯‚ã«åŒ…ã¾ã‚ŒãŸç¦…å ‚ã§ã®åº§ç¦…ä½“é¨“ã¯ã€æ—¥å¸¸ã®å–§é¨’ã‚’å¿˜ã‚Œã€å¿ƒã‚’è¦‹ã¤ã‚ç›´ã™ç‰¹åˆ¥ãªæ™‚é–“ã¨ãªã‚Šã¾ã™ã€‚ç¦…ã®æ•™ãˆã¯ç¾ä»£ã®ã‚¹ãƒˆãƒ¬ã‚¹ç¤¾ä¼šã«ãŠã„ã¦ã€å¿ƒã®å¹³å®‰ã‚’æ±‚ã‚ã‚‹å¤šãã®äººã€…ã«æ”¯æŒã•ã‚Œã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å­£ç¯€ã®ç¾ã—ã•ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-seasons',
        style: 'h2',
        children: [{ _type: 'span', text: 'å››å­£æŠ˜ã€…ã®å¢ƒå†…ã®ç¾ã—ã•', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'seasons-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ‹æ³°å¯ºã®å¢ƒå†…ã¯å››å­£ã‚’é€šã˜ã¦ç¾ã—ã„è‡ªç„¶ã®è¡¨æƒ…ã‚’è¦‹ã›ã€è¨ªã‚Œã‚‹äººã€…ã®å¿ƒã‚’ç™’ã—ã¦ãã‚Œã¾ã™ã€‚æ˜¥ã«ã¯æ¡œãŒå’²ãèª‡ã‚Šã€å¤ã¯æ·±ç·‘ã«åŒ…ã¾ã‚Œã€ç§‹ã«ã¯ç´…è‘‰ãŒå¢ƒå†…ã‚’å½©ã‚Šã€å†¬ã¯é›ªåŒ–ç²§ã—ãŸé™å¯‚ãªé¢¨æ™¯ãŒåºƒãŒã‚Šã¾ã™ã€‚ç‰¹ã«ç§‹ã®ç´…è‘‰ã‚·ãƒ¼ã‚ºãƒ³ã¯å¤šãã®å‚æ‹è€…ãŒè¨ªã‚Œã‚‹äººæ°—ã®æ™‚æœŸã§ã€å¤å»ºç¯‰ã¨ç´…è‘‰ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯æ ¼åˆ¥ã®ç¾ã—ã•ã§ã™ã€‚å¢ƒå†…ã®åº­åœ’ã‚‚è¦‹äº‹ã«æ‰‹å…¥ã‚Œã•ã‚Œã¦ãŠã‚Šã€ç¦…ã®ç¾å­¦ã‚’ä½“ç¾ã—ãŸç°¡ç´ ã§æ´—ç·´ã•ã‚ŒãŸç¾ã—ã•ãŒæ„Ÿã˜ã‚‰ã‚Œã¾ã™ã€‚è‡ªç„¶ã¨å»ºç¯‰ãŒèª¿å’Œã—ãŸç’°å¢ƒã¯ã€å¿ƒã®é™å¯‚ã‚’ã‚‚ãŸã‚‰ã—ã¦ãã‚Œã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å‚æ‹ã¨è¦‹å­¦ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visit',
        style: 'h2',
        children: [{ _type: 'span', text: 'å‚æ‹ã¨è¦‹å­¦ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visit-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ‹æ³°å¯ºã‚’è¨ªã‚Œã‚‹éš›ã¯ã€ã¾ãšå±±é–€ã‚’ããã£ã¦å¢ƒå†…ã«å…¥ã‚Šã€å³ã‹ãªé›°å›²æ°—ã‚’æ„Ÿã˜ãªãŒã‚‰ã‚†ã£ãã‚Šã¨æ•£ç­–ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚åº§ç¦…ä¼šã‚„æ³•è©±ä¼šã«å‚åŠ ã™ã‚Œã°ã€ç¦…ã®æ•™ãˆã«ç›´æ¥è§¦ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å‚æ‹æ™‚ã¯ä¿®è¡Œåƒ§ã®é‚ªé­”ã«ãªã‚‰ãªã„ã‚ˆã†ã€é™ç²›ã«è¡Œå‹•ã™ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚é§è»Šå ´ã‚‚å®Œå‚™ã•ã‚Œã¦ãŠã‚Šã€ã‚¢ã‚¯ã‚»ã‚¹ã‚‚è‰¯å¥½ã§ã™ã€‚å­£ç¯€ã”ã¨ã«ç•°ãªã‚‹ç¾ã—ã•ã‚’è¦‹ã›ã‚‹å¢ƒå†…ãªã®ã§ã€ä½•åº¦è¨ªã‚Œã¦ã‚‚æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚å¿ƒã®å¹³å®‰ã‚’æ±‚ã‚ã‚‹æ–¹ã«ã¯ç‰¹ã«ãŠã™ã™ã‚ã®å¯ºé™¢ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'åœ‹æ³°å¯ºã¯700å¹´ä»¥ä¸Šã®æ­´å²ã‚’æŒã¤è²´é‡ãªç¦…å¯ºã§ã™ã€‚ç¦…ã®æ•™ãˆã¨ç¾ã—ã„å¢ƒå†…ã§å¿ƒã®å¹³å®‰ã‚’æ„Ÿã˜ã‚‹ç‰¹åˆ¥ãªæ™‚é–“ã‚’ãŠéã”ã—ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬24è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 182æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentyFourthArticle();
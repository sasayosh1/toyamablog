const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandEighthArticle() {
  try {
    console.log('ç¬¬8è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: kurobe-city-onsen-shrine-100 (å®‡å¥ˆæœˆç¥ç¤¾)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "kurobe-city-onsen-shrine-100"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€å®‡å¥ˆæœˆç¥ç¤¾ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é»’éƒ¨å¸‚ã®å®‡å¥ˆæœˆæ¸©æ³‰è¡—å½¢æˆã‹ã‚‰100å¹´é–“ã“ã®åœ°ã‚’å®ˆã‚Šç¶šã‘ã¦ããŸå®‡å¥ˆæœˆç¥ç¤¾ã€‚æ¸©æ³‰åœ°ã®ç™ºå±•ã¨å…±ã«æ­©ã‚“ã§ããŸç¥ç¤¾ã®æ­´å²ã¨é­…åŠ›ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ç¥ç¤¾ã®æ­´å²ï¼ˆç´„170æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-history',
        style: 'h2',
        children: [{ _type: 'span', text: '100å¹´ã®æ­´å²ã‚’æŒã¤å®‡å¥ˆæœˆç¥ç¤¾', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'history-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆç¥ç¤¾ã¯å®‡å¥ˆæœˆæ¸©æ³‰è¡—ã®å½¢æˆã¨å…±ã«å»ºç«‹ã•ã‚Œã€ç´„100å¹´é–“ã“ã®åœ°åŸŸã®å®ˆã‚Šç¥ã¨ã—ã¦è¦ªã—ã¾ã‚Œã¦ãã¾ã—ãŸã€‚æ¸©æ³‰è¡—ã®ç™ºå±•ã‚’è¦‹å®ˆã‚Šã€åœ°åŸŸã®äººã€…ã®å®‰å…¨ã¨ç¹æ „ã‚’ç¥ˆé¡˜ã™ã‚‹å ´ã¨ã—ã¦å¤§åˆ‡ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚å‰µå»ºå½“åˆã‹ã‚‰ç¾åœ¨ã¾ã§ã€åœ°å…ƒã®æ–¹ã€…ã«ã‚ˆã£ã¦å¤§åˆ‡ã«ç¶­æŒç®¡ç†ã•ã‚Œã¦ãŠã‚Šã€æ¸©æ³‰åœ°ã®ç²¾ç¥çš„ãªæ”¯æŸ±ã¨ã—ã¦å­˜åœ¨ã—ç¶šã‘ã¦ã„ã¾ã™ã€‚ç¥ç¤¾ã®æ­´å²ã¯å®‡å¥ˆæœˆæ¸©æ³‰ã®ç™ºå±•å²ãã®ã‚‚ã®ã§ã‚‚ã‚ã‚Šã€ã“ã®åœ°åŸŸã®ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç‰©èªã‚‹è²´é‡ãªæ–‡åŒ–éºç”£ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ¸©æ³‰è¡—ã¨ã®é–¢ã‚ã‚Šï¼ˆç´„160æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-onsen',
        style: 'h2',
        children: [{ _type: 'span', text: 'æ¸©æ³‰è¡—ã®å®ˆè­·ç¥ã¨ã—ã¦ã®å½¹å‰²', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'onsen-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆæ¸©æ³‰ãŒè¦³å…‰åœ°ã¨ã—ã¦ç™ºå±•ã—ã¦ã„ãä¸­ã§ã€ç¥ç¤¾ã¯åœ°åŸŸã®å¹³å®‰ã¨è¦³å…‰å®¢ã®å®‰å…¨ã‚’ç¥ˆã‚‹é‡è¦ãªå ´æ‰€ã¨ãªã‚Šã¾ã—ãŸã€‚æ¸©æ³‰è¡—ã§åƒãäººã€…ã‚„è¨ªã‚Œã‚‹è¦³å…‰å®¢ã«ã¨ã£ã¦ã€å¿ƒã®æ”¯ãˆã¨ãªã‚‹å­˜åœ¨ã§ã™ã€‚ç‰¹ã«æ¸©æ³‰ã®æµã¿ã«æ„Ÿè¬ã—ã€ã“ã®åœ°åŸŸã®è‡ªç„¶ç’°å¢ƒã®ä¿å…¨ã‚’ç¥ˆé¡˜ã™ã‚‹å ´ã¨ã—ã¦ã‚‚è¦ªã—ã¾ã‚Œã¦ã„ã¾ã™ã€‚æ¸©æ³‰è¡—ã®ä¸­å¿ƒéƒ¨ã«ä½ç½®ã—ã€æ•£ç­–ã®éš›ã«å¤šãã®äººã€…ãŒç«‹ã¡å¯„ã‚‹æ†©ã„ã®ã‚¹ãƒãƒƒãƒˆã§ã‚‚ã‚ã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ç¥ç¤¾ã®ç‰¹å¾´ï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-features',
        style: 'h2',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆç¥ç¤¾ã®å»ºç¯‰ã¨å¢ƒå†…', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'features-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç¥ç¤¾ã®å»ºç‰©ã¯ä¼çµ±çš„ãªç¥ç¤¾å»ºç¯‰ã®æ§˜å¼ã‚’å—ã‘ç¶™ããªãŒã‚‰ã€å±±é–“éƒ¨ã®ç’°å¢ƒã«èª¿å’Œã—ãŸãŸãŸãšã¾ã„ã‚’è¦‹ã›ã¦ã„ã¾ã™ã€‚å¢ƒå†…ã¯æ¸…ã€…ã—ã„ç©ºæ°—ã«æº€ã¡ã¦ãŠã‚Šã€éƒ½å¸‚éƒ¨ã®å–§é¨’ã‚’é›¢ã‚Œã¦å¿ƒã‚’è½ã¡ç€ã‹ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å››å­£æŠ˜ã€…ã®è‡ªç„¶ã®å¤‰åŒ–ã‚’æ„Ÿã˜ã‚‰ã‚Œã‚‹å¢ƒå†…ã§ã¯ã€æ˜¥ã®æ–°ç·‘ã€ç§‹ã®ç´…è‘‰ãªã©ã€å­£ç¯€ã”ã¨ã«ç•°ãªã‚‹ç¾ã—ã•ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã€å‚æ‹è€…ã®å¿ƒã«æ·±ã„å°è±¡ã‚’æ®‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é»’éƒ¨å³¡è°·ã¨ã®èª¿å’Œï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-nature',
        style: 'h2',
        children: [{ _type: 'span', text: 'è‡ªç„¶ç’°å¢ƒã¨ã®èª¿å’Œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'nature-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆç¥ç¤¾ã¯é»’éƒ¨å³¡è°·ã®è±Šã‹ãªè‡ªç„¶ç’°å¢ƒã®ä¸­ã«ä½ç½®ã—ã¦ãŠã‚Šã€ç¥ç¤¾è‡ªä½“ãŒè‡ªç„¶ã¨ä¸€ä½“åŒ–ã—ãŸç¥è–ãªç©ºé–“ã‚’å½¢æˆã—ã¦ã„ã¾ã™ã€‚å‘¨å›²ã®å±±ã€…ã‚„æ¸…æµã®éŸ³ãŒå¢ƒå†…ã«éŸ¿ãã€è‡ªç„¶ã®åŠ›å¼·ã•ã¨ç¥ç§˜æ€§ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®æµã¾ã‚ŒãŸç«‹åœ°ã«ã‚ˆã‚Šã€å‚æ‹è€…ã¯éƒ½å¸‚éƒ¨ã§ã¯ä½“é¨“ã§ããªã„ã€è‡ªç„¶ã¨ç¥æ§˜ã®å­˜åœ¨ã‚’åŒæ™‚ã«æ„Ÿã˜ã‚‰ã‚Œã‚‹ç‰¹åˆ¥ãªä½“é¨“ãŒã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å‚æ‹ã®ãŠã™ã™ã‚ï¼ˆç´„120æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-visit',
        style: 'h2',
        children: [{ _type: 'span', text: 'å‚æ‹æ™‚ã®ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'visit-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆæ¸©æ³‰ã‚’è¨ªã‚ŒãŸéš›ã«ã¯ã€ãœã²ç¥ç¤¾ã«ã‚‚è¶³ã‚’é‹ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚æ¸©æ³‰ã§èº«ä½“ã‚’ç™’ã—ãŸå¾Œã«ç¥ç¤¾ã§å¿ƒã‚’æ¸…ã‚ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šå……å®Ÿã—ãŸå®‡å¥ˆæœˆæ»åœ¨ã¨ãªã‚Šã¾ã™ã€‚æ—©æœã®å‚æ‹ã¯ç‰¹ã«ãŠã™ã™ã‚ã§ã€é™å¯‚ã«åŒ…ã¾ã‚ŒãŸå¢ƒå†…ã§æ¸…ã€…ã—ã„æ™‚é–“ã‚’éã”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ãŠå®ˆã‚Šã‚„ãŠã¿ãã˜ã‚‚ã‚ã‚Šã¾ã™ã®ã§ã€æ—…ã®è¨˜å¿µã«ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: '100å¹´é–“å®‡å¥ˆæœˆæ¸©æ³‰è¡—ã‚’è¦‹å®ˆã‚Šç¶šã‘ã¦ããŸå®‡å¥ˆæœˆç¥ç¤¾ã¯ã€åœ°åŸŸã®æ­´å²ã¨æ–‡åŒ–ã‚’ç‰©èªã‚‹è²´é‡ãªå­˜åœ¨ã§ã™ã€‚æ¸©æ³‰ã¨åˆã‚ã›ã¦è¨ªã‚Œã‚‹ã“ã¨ã§ã€å®‡å¥ˆæœˆã®é­…åŠ›ã‚’ã‚ˆã‚Šæ·±ãæ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬8è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 204æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandEighthArticle();
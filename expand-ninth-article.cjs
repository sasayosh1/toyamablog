const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandNinthArticle() {
  try {
    console.log('ç¬¬9è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: namerikawa-city-museum-1 (ãƒãƒ³ã‚¢ãƒŠã‚´ã‚’çŸ¥ã‚ã†)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "namerikawa-city-museum-1"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€ãƒãƒ³ã‚¢ãƒŠã‚´ã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ»‘å·å¸‚ã®ã»ãŸã‚‹ã„ã‹ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã§å‡ºä¼šãˆã‚‹æ„›ã‚‰ã—ã„ãƒãƒ³ã‚¢ãƒŠã‚´ã€‚ãã®ä¸æ€è­°ãªç”Ÿæ…‹ã¨é­…åŠ›ã«ã¤ã„ã¦è©³ã—ãã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã»ãŸã‚‹ã„ã‹ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ æ¦‚è¦ï¼ˆç´„160æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-museum',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã»ãŸã‚‹ã„ã‹ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'museum-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ»‘å·å¸‚ã«ã‚ã‚‹ã»ãŸã‚‹ã„ã‹ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã¯ã€å¯Œå±±æ¹¾ã®ç¥ç§˜çš„ãªç”Ÿç‰©ã€Œã»ãŸã‚‹ã„ã‹ã€ã‚’ä¸­å¿ƒã¨ã—ãŸæµ·æ´‹åšç‰©é¤¨ã§ã™ã€‚ã»ãŸã‚‹ã„ã‹ã®ç”Ÿæ…‹ã‚„å¯Œå±±æ¹¾ã®è±Šã‹ãªæµ·æ´‹ç’°å¢ƒã«ã¤ã„ã¦å­¦ã¶ã“ã¨ãŒã§ãã‚‹è²´é‡ãªæ–½è¨­ã¨ã—ã¦ã€å¤šãã®è¦³å…‰å®¢ã‚„å­¦ç¿’è€…ã«æ„›ã•ã‚Œã¦ã„ã¾ã™ã€‚é¤¨å†…ã«ã¯æ§˜ã€…ãªæµ·æ´‹ç”Ÿç‰©ã®å±•ç¤ºãŒã‚ã‚Šã€ãã®ä¸­ã§ã‚‚ãƒãƒ³ã‚¢ãƒŠã‚´ã¯æ¥é¤¨è€…ã«ç‰¹ã«äººæ°—ã®é«˜ã„ç”Ÿç‰©ã®ä¸€ã¤ã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ãƒãƒ³ã‚¢ãƒŠã‚´ã®ç”Ÿæ…‹ï¼ˆç´„180æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-chinchilla',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒãƒ³ã‚¢ãƒŠã‚´ã®ä¸æ€è­°ãªç”Ÿæ…‹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'chinchilla-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒãƒ³ã‚¢ãƒŠã‚´ã¯ç ‚åœ°ã«ç©´ã‚’æ˜ã£ã¦æš®ã‚‰ã™ã‚¦ãƒŠã‚®ã®ä»²é–“ã§ã€ãã®åå‰ã¯ä½“ã®æ¨¡æ§˜ãŒçŠ¬ã®ãƒãƒ³ãƒãƒ©ã«ä¼¼ã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ä»˜ã‘ã‚‰ã‚Œã¾ã—ãŸã€‚ç ‚ã‹ã‚‰é¡”ã ã‘ã‚’å‡ºã—ã¦ã‚†ã‚‰ã‚†ã‚‰ã¨æºã‚Œã‚‹å§¿ã¯éå¸¸ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ã§ã€è¦‹ã¦ã„ã‚‹ã ã‘ã§ç™’ã•ã‚Œã¾ã™ã€‚æµã‚Œã¦ãã‚‹ãƒ—ãƒ©ãƒ³ã‚¯ãƒˆãƒ³ã‚’æ•é£Ÿã™ã‚‹ç¿’æ€§ãŒã‚ã‚Šã€å¸¸ã«æ°´æµã«å‘ã‹ã£ã¦ä½“ã‚’å‘ã‘ã¦ã„ã¾ã™ã€‚è­¦æˆ’å¿ƒãŒå¼·ãã€å±é™ºã‚’æ„Ÿã˜ã‚‹ã¨ç´ æ—©ãç ‚ã®ä¸­ã«éš ã‚Œã¦ã—ã¾ã†è‡†ç—…ãªæ€§æ ¼ã‚‚é­…åŠ›ã®ä¸€ã¤ã§ã™ã€‚ç¾¤ã‚Œã§ç”Ÿæ´»ã™ã‚‹ã“ã¨ãŒå¤šãã€æ°´æ§½å†…ã§ã¯è¤‡æ•°åŒ¹ãŒä¸¦ã‚“ã§æºã‚Œã¦ã„ã‚‹æ§˜å­ã‚’è¦³å¯Ÿã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¦³å¯Ÿã®ãƒã‚¤ãƒ³ãƒˆï¼ˆç´„150æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-observation',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒãƒ³ã‚¢ãƒŠã‚´è¦³å¯Ÿã®æ¥½ã—ã¿æ–¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'observation-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒãƒ³ã‚¢ãƒŠã‚´ã‚’è¦³å¯Ÿã™ã‚‹éš›ã¯ã€ã‚†ã£ãã‚Šã¨è¿‘ã¥ãã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚æ€¥æ¿€ãªå‹•ãã‚’ã™ã‚‹ã¨ç ‚ã®ä¸­ã«éš ã‚Œã¦ã—ã¾ã†ãŸã‚ã€é™ã‹ã«è¦³å¯Ÿã™ã‚‹ã“ã¨ã§é•·æ™‚é–“ãã®æ„›ã‚‰ã—ã„å§¿ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œãã‚Œå€‹ä½“ã«ã‚ˆã£ã¦å‡ºã¦ãã‚‹é•·ã•ã‚„å‹•ããŒç•°ãªã‚‹ã®ã§ã€å€‹æ€§ã‚’è¦³å¯Ÿã™ã‚‹ã®ã‚‚é¢ç™½ã„ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚é¤Œã®æ™‚é–“ã«ã¯æ´»ç™ºã«å‹•ãå›ã‚‹æ§˜å­ã‚‚è¦‹ã‚‹ã“ã¨ãŒã§ãã€æ™®æ®µã¨ã¯é•ã£ãŸè¡¨æƒ…ã‚’è¦‹ã›ã¦ãã‚Œã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: æ•™è‚²çš„ä¾¡å€¤ï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-education',
        style: 'h2',
        children: [{ _type: 'span', text: 'æµ·æ´‹ç”Ÿç‰©ã®å­¦ç¿’ä¾¡å€¤', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'education-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒãƒ³ã‚¢ãƒŠã‚´ã®å±•ç¤ºã¯ã€æµ·æ´‹ç”Ÿç‰©ã®å¤šæ§˜æ€§ã‚„é©å¿œã®ç´ æ™´ã‚‰ã—ã•ã‚’å­¦ã¶çµ¶å¥½ã®æ©Ÿä¼šã§ã™ã€‚ç ‚åœ°ã¨ã„ã†ç‰¹æ®Šãªç’°å¢ƒã«é©å¿œã—ãŸç”Ÿç‰©ã®ç”Ÿãæ§˜ã‚’é€šã˜ã¦ã€è‡ªç„¶ç’°å¢ƒã®å¤§åˆ‡ã•ã‚„ç”Ÿç‰©ã®å·§å¦™ãªç”Ÿå­˜æˆ¦ç•¥ã«ã¤ã„ã¦ç†è§£ã‚’æ·±ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å­ã©ã‚‚ã‹ã‚‰å¤§äººã¾ã§ã€ç”Ÿç‰©å­¦ã¸ã®èˆˆå‘³ã‚’è‚²ã‚€æ•™è‚²çš„ä¾¡å€¤ã®é«˜ã„å±•ç¤ºã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã§ã®ä½“é¨“ï¼ˆç´„120æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-experience',
        style: 'h2',
        children: [{ _type: 'span', text: 'ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã§ã®ç‰¹åˆ¥ä½“é¨“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'experience-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã»ãŸã‚‹ã„ã‹ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã§ã¯ã€ãƒãƒ³ã‚¢ãƒŠã‚´ã®ç”Ÿæ…‹ã«ã¤ã„ã¦è©³ã—ã„è§£èª¬ã‚‚ç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€ã‚ˆã‚Šæ·±ãå­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚å†™çœŸæ’®å½±ã‚‚å¯èƒ½ã§ã€ãƒãƒ³ã‚¢ãƒŠã‚´ã®æ„›ã‚‰ã—ã„å§¿ã‚’è¨˜éŒ²ã«æ®‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€ä»–ã®æµ·æ´‹ç”Ÿç‰©ã¨ã®æ¯”è¼ƒå±•ç¤ºã‚‚ã‚ã‚Šã€æµ·ã®ç”Ÿç‰©ã®å¤šæ§˜æ€§ã‚’å®Ÿæ„Ÿã§ãã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ãƒãƒ³ã‚¢ãƒŠã‚´ã®æ„›ã‚‰ã—ã„å§¿ã¨ä¸æ€è­°ãªç”Ÿæ…‹ã¯ã€è¨ªã‚Œã‚‹äººã€…ã«æµ·æ´‹ç”Ÿç‰©ã®é­…åŠ›ã‚’ä¼ãˆã¦ãã‚Œã¾ã™ã€‚ã»ãŸã‚‹ã„ã‹ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã§ã€ãœã²ã“ã®ç‰¹åˆ¥ãªå‡ºä¼šã„ã‚’ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬9è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 204æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandNinthArticle();
const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandTwentySixthArticle() {
  try {
    console.log('ç¬¬26è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: toyama-city-2023-100-2023 (ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "toyama-city-2023-100-2023"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // çµ±ä¸€æ§‹é€ ã‚’å‚è€ƒã«ã€ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã®è¨˜äº‹ã‚’æ…é‡ã«æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„95æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¯Œå±±å¸‚ã®ç‰›å²³ã§é–‹å‚¬ã•ã‚Œã‚‹å¤ã®å¤œç©ºã«100å€‹ä»¥ä¸Šã®ãƒ©ãƒ³ã‚¿ãƒ³ãŒèˆã„ä¸ŠãŒã‚‹ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«2023ã€‚å¹»æƒ³çš„ãªå…‰æ™¯ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-festival',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«2023ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'festival-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã¯å¯Œå±±å¸‚ã®å¤ã‚’å½©ã‚‹å¹»æƒ³çš„ãªã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ã€2023å¹´ã«å¤šãã®æ„Ÿå‹•ã‚’ä¸ãˆã¾ã—ãŸã€‚æ¨™é«˜987mã®ç‰›å²³ã®å±±é ‚ä»˜è¿‘ã§é–‹å‚¬ã•ã‚Œã‚‹ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã§ã¯ã€100å€‹ä»¥ä¸Šã®ãƒ©ãƒ³ã‚¿ãƒ³ãŒå¤œç©ºã«æ”¾ãŸã‚Œã€ã¾ã‚‹ã§æ˜Ÿã€…ãŒèˆã„è¸Šã‚‹ã‚ˆã†ãªç¾ã—ã„å…‰æ™¯ã‚’æ¼”å‡ºã—ã¾ã™ã€‚å‚åŠ è€…ä¸€äººä¸€äººãŒé¡˜ã„ã‚’è¾¼ã‚ãŸãƒ©ãƒ³ã‚¿ãƒ³ã¯ã€å¤ã®å¤œç©ºã«é™ã‹ã«èˆã„ä¸ŠãŒã‚Šã€è¦‹ã‚‹äººã€…ã«æ·±ã„æ„Ÿå‹•ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚å¯Œå±±å¹³é‡ã‚’ä¸€æœ›ã§ãã‚‹çµ¶å¥½ã®ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§è¡Œã‚ã‚Œã‚‹ã“ã®ç¥­ã‚Šã¯ã€å‚åŠ è€…ã«ã¨ã£ã¦å¿˜ã‚Œã‚‰ã‚Œãªã„å¤ã®æ€ã„å‡ºã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: 100å€‹ä»¥ä¸Šã®ãƒ©ãƒ³ã‚¿ãƒ³ã®å£®è¦³ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-lanterns',
        style: 'h2',
        children: [{ _type: 'span', text: '100å€‹ä»¥ä¸Šã®ãƒ©ãƒ³ã‚¿ãƒ³ãŒç¹”ã‚Šãªã™å¹»æƒ³ä¸–ç•Œ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'lanterns-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å¤œç©ºã«èˆã„ä¸ŠãŒã‚‹100å€‹ä»¥ä¸Šã®ãƒ©ãƒ³ã‚¿ãƒ³ã¯ã€ã¾ã•ã«åœ§å·»ã®å…‰æ™¯ã§ã™ã€‚ãã‚Œãã‚Œã®ãƒ©ãƒ³ã‚¿ãƒ³ã«ã¯å‚åŠ è€…ã®é¡˜ã„ã‚„æƒ³ã„ãŒè¾¼ã‚ã‚‰ã‚Œã¦ãŠã‚Šã€æ¸©ã‹ãªå…‰ã‚’æ”¾ã¡ãªãŒã‚‰é™ã‹ã«å¤œç©ºã¸ã¨æ˜‡ã£ã¦ã„ãã¾ã™ã€‚ãƒ©ãƒ³ã‚¿ãƒ³ãŒä¸€æ–‰ã«ç©ºã«èˆã„ä¸ŠãŒã‚‹ç¬é–“ã¯ã€ä¼šå ´å…¨ä½“ãŒé™å¯‚ã«åŒ…ã¾ã‚Œã€ç¥ç§˜çš„ãªé›°å›²æ°—ã«æº€ã¡ã‚ãµã‚Œã¾ã™ã€‚é¢¨ã«æºã‚‰ã‚ŒãªãŒã‚‰é«˜åº¦ã‚’ä¸Šã’ã¦ã„ããƒ©ãƒ³ã‚¿ãƒ³ã¯ã€ã¾ã‚‹ã§å¤©ã®å·ã®ã‚ˆã†ã«ç¾ã—ãã€å‚åŠ è€…ã®å¿ƒã«æ·±ã„æ„Ÿå‹•ã‚’åˆ»ã¿ã¾ã™ã€‚ã“ã®å…‰æ™¯ã¯å†™çœŸã‚„å‹•ç”»ã§ã¯ä¼ãˆãã‚Œãªã„ã€ç¾å ´ã§ã—ã‹å‘³ã‚ãˆãªã„ç‰¹åˆ¥ãªä½“é¨“ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ç‰›å²³ã®çµ¶æ™¯ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-location',
        style: 'h2',
        children: [{ _type: 'span', text: 'ç‰›å²³ã®çµ¶æ™¯ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç”Ÿã¿å‡ºã™ç‰¹åˆ¥æ„Ÿ', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'location-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'æ¨™é«˜987mã®ç‰›å²³å±±é ‚ä»˜è¿‘ã¨ã„ã†ç«‹åœ°ã¯ã€ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã«ç‰¹åˆ¥ãªä¾¡å€¤ã‚’ä¸ãˆã¦ã„ã¾ã™ã€‚çœ¼ä¸‹ã«åºƒãŒã‚‹å¯Œå±±å¹³é‡ã®å¤œæ™¯ã¨ã€é ­ä¸Šã«è¼ãæº€å¤©ã®æ˜Ÿç©ºã«å›²ã¾ã‚ŒãªãŒã‚‰ã®ãƒ©ãƒ³ã‚¿ãƒ³ãƒªãƒªãƒ¼ã‚¹ã¯ã€ã¾ã•ã«éæ—¥å¸¸ã®ä½“é¨“ã§ã™ã€‚å±±ã®æ¸…æ¾„ãªç©ºæ°—ã®ä¸­ã§è¡Œã‚ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã¯ã€éƒ½å¸‚éƒ¨ã§ã¯å‘³ã‚ãˆãªã„é–‹æ”¾æ„Ÿã¨ç¥ç§˜æ€§ã«æº€ã¡ã¦ã„ã¾ã™ã€‚æ™´ã‚ŒãŸæ—¥ã«ã¯ç«‹å±±é€£å³°ã®ã‚·ãƒ«ã‚¨ãƒƒãƒˆã‚‚ç¾ã—ãã€å¯Œå±±ã®é›„å¤§ãªè‡ªç„¶ã‚’èƒŒæ™¯ã«ã—ãŸãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã¯ã€ä»–ã§ã¯ä½“é¨“ã§ããªã„ç‰¹åˆ¥ãªã‚¤ãƒ™ãƒ³ãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: å‚åŠ è€…ã®æƒ³ã„ã¨ä½“é¨“ï¼ˆç´„145æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-participants',
        style: 'h2',
        children: [{ _type: 'span', text: 'å‚åŠ è€…ã®æƒ³ã„ãŒè¾¼ã‚ã‚‰ã‚ŒãŸç‰¹åˆ¥ãªä½“é¨“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'participants-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã®çœŸã®é­…åŠ›ã¯ã€å‚åŠ è€…ä¸€äººä¸€äººã®æƒ³ã„ãŒè¾¼ã‚ã‚‰ã‚ŒãŸãƒ©ãƒ³ã‚¿ãƒ³ã«ã‚ã‚Šã¾ã™ã€‚æ‹äººåŒå£«ã®æ„›ã®èª“ã„ã€å®¶æ—ã®å¥åº·ç¥ˆé¡˜ã€å¤¢ã¸ã®é¡˜ã„ã€æ•…äººã¸ã®æƒ³ã„ãªã©ã€æ§˜ã€…ãªæ€ã„ãŒãƒ©ãƒ³ã‚¿ãƒ³ã¨å…±ã«å¤œç©ºã«èˆã„ä¸ŠãŒã‚Šã¾ã™ã€‚å‚åŠ è€…åŒå£«ã®æ¸©ã‹ã„äº¤æµã‚‚ç”Ÿã¾ã‚Œã€è¦‹çŸ¥ã‚‰ã¬äººåŒå£«ã§ã‚‚è‡ªç„¶ã«ä¼šè©±ãŒå¼¾ã¿ã¾ã™ã€‚ãƒ©ãƒ³ã‚¿ãƒ³ã‚’æ‰‹ã«æŒã¡ãªãŒã‚‰é¡˜ã„ã‚’è¾¼ã‚ã‚‹æ™‚é–“ã¯ã€æ—¥å¸¸ã®å¿™ã—ã•ã‚’å¿˜ã‚Œã€è‡ªåˆ†ã®å¿ƒã¨å‘ãåˆã†è²´é‡ãªã²ã¨ã¨ãã¨ãªã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã‚¤ãƒ™ãƒ³ãƒˆã®æ„ç¾©ã¨ä»Šå¾Œï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-significance',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã‚¤ãƒ™ãƒ³ãƒˆã®æ–‡åŒ–çš„æ„ç¾©ã¨ç¶™ç¶šã¸ã®æœŸå¾…', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'significance-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã¯ã€å¯Œå±±å¸‚ã®æ–°ã—ã„å¤ã®é¢¨ç‰©è©©ã¨ã—ã¦å®šç€ã—ã¤ã¤ã‚ã‚Šã¾ã™ã€‚åœ°åŸŸã®è¦³å…‰è³‡æºã¨ã—ã¦ã®ä¾¡å€¤ã ã‘ã§ãªãã€å‚åŠ è€…ã®å¿ƒã«æ·±ã„æ„Ÿå‹•ã‚’ä¸ãˆã‚‹æ–‡åŒ–çš„ãªã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ã‚‚é‡è¦ãªæ„ç¾©ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ç’°å¢ƒã«é…æ…®ã—ãŸé‹å–¶æ–¹æ³•ã‚‚è©•ä¾¡ã•ã‚Œã¦ãŠã‚Šã€æŒç¶šå¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ä»Šå¾Œã®ç¶™ç¶šãŒæœŸå¾…ã•ã‚Œã¦ã„ã¾ã™ã€‚æ¯å¹´å¤šãã®äººã€…ãŒæ¥½ã—ã¿ã«ã—ã¦ã„ã‚‹ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒã€é•·ãæ„›ã•ã‚Œç¶šã‘ã‚‹ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ç‰›å²³ãƒ©ãƒ³ã‚¿ãƒ³ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«2023ã¯100å€‹ä»¥ä¸Šã®ãƒ©ãƒ³ã‚¿ãƒ³ãŒç¹”ã‚Šãªã™å¹»æƒ³çš„ãªå¤ã®å¤œã®ã‚¤ãƒ™ãƒ³ãƒˆã§ã—ãŸã€‚æ¥å¹´ã®é–‹å‚¬ã‚‚ãœã²ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ…é‡ã«æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬26è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 184æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandTwentySixthArticle();
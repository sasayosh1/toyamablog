const { createClient } = require('@sanity/client');

const client = createClient({
  projectId: 'aoxze287',
  dataset: 'production',
  apiVersion: '2024-01-01',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN
});

async function expandNineteenthArticle() {
  try {
    console.log('ç¬¬19è¨˜äº‹ã®æ›´æ–°ã‚’é–‹å§‹ã—ã¾ã™...');
    console.log('å¯¾è±¡: kurobe-city-station (é»’éƒ¨å³¡è°·é‰„é“å®‡å¥ˆæœˆé§…ã®è¬ã®è‡ªè²©æ©Ÿ)');
    
    // è¨˜äº‹ã‚’å–å¾—
    const post = await client.fetch('*[_type == "post" && slug.current == "kurobe-city-station"][0] { _id, title, body, youtubeUrl }');
    
    if (!post) {
      console.log('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
      return;
    }
    
    console.log('è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:', post.title);
    console.log('YouTube URL:', post.youtubeUrl ? 'ã‚ã‚Š' : 'ãªã—');
    
    // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
    let totalChars = 0;
    post.body.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        totalChars += text.length;
      }
    });
    
    console.log(`ç¾åœ¨ã®æ–‡å­—æ•°: ${totalChars}æ–‡å­—`);
    console.log('ç›®æ¨™: 800-1000æ–‡å­—ã«æ‹¡å¼µ');
    
    // ã‚·ãƒ£ãƒ«ãƒ­ãƒƒãƒ†è¨˜äº‹ã®æ§‹æˆã‚’å‚è€ƒã«ã€è¬ã®è‡ªè²©æ©Ÿã®è¨˜äº‹ã‚’æ‹¡å¼µ
    const expandedContent = [
      // å°å…¥æ–‡ï¼ˆç´„85æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'intro',
        style: 'normal',
        children: [{ _type: 'span', text: 'é»’éƒ¨å³¡è°·é‰„é“å®‡å¥ˆæœˆé§…ã§å‡ºä¼šãˆã‚‹è¬ã®è‡ªè²©æ©Ÿã€‚ä¸€ä½“ä½•ãŒå£²ã‚‰ã‚Œã¦ã„ã‚‹ã®ã‹ã€ãã®æ­£ä½“ã¨é­…åŠ›ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é»’éƒ¨å³¡è°·é‰„é“å®‡å¥ˆæœˆé§…ã®æ¦‚è¦ï¼ˆç´„175æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-station',
        style: 'h2',
        children: [{ _type: 'span', text: 'é»’éƒ¨å³¡è°·é‰„é“å®‡å¥ˆæœˆé§…ã®é­…åŠ›', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'station-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'é»’éƒ¨å³¡è°·é‰„é“å®‡å¥ˆæœˆé§…ã¯ã€æ—¥æœ¬å±ˆæŒ‡ã®å±±å²³é‰„é“ã§ã‚ã‚‹é»’éƒ¨å³¡è°·é‰„é“ã®èµ·ç‚¹ã¨ãªã‚‹é‡è¦ãªé§…ã§ã™ã€‚ã“ã“ã‹ã‚‰å¥¥æ·±ã„é»’éƒ¨å³¡è°·ã¸ã¨å‘ã‹ã†å°ã•ãªãƒˆãƒ­ãƒƒã‚³åˆ—è»ŠãŒå‡ºç™ºã—ã€å¤šãã®è¦³å…‰å®¢ãŒå¤§è‡ªç„¶ã¸ã®å†’é™ºã«èƒ¸ã‚’èºã‚‰ã›ã¾ã™ã€‚é§…èˆã¯æ¸©æ³‰è¡—ã®é¢¨æƒ…ã«ãƒãƒƒãƒã—ãŸè¶£ã®ã‚ã‚‹å»ºç‰©ã§ã€é»’éƒ¨å³¡è°·è¦³å…‰ã®ç„é–¢å£ã¨ã—ã¦ã®å½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚å¾…åˆå®¤ã‚„å£²åº—ãªã©ã‚‚å……å®Ÿã—ã¦ãŠã‚Šã€ãƒˆãƒ­ãƒƒã‚³åˆ—è»Šã®å‡ºç™ºæ™‚é–“ã¾ã§å¿«é©ã«éã”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚“ãªé§…æ§‹å†…ã§å‡ºä¼šãˆã‚‹è¬ã®è‡ªè²©æ©Ÿã¯ã€è¨ªã‚Œã‚‹äººã€…ã®å¥½å¥‡å¿ƒã‚’ãã™ãã‚‹å­˜åœ¨ã¨ãªã£ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: è¬ã®è‡ªè²©æ©Ÿã®æ­£ä½“ï¼ˆç´„165æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-mystery',
        style: 'h2',
        children: [{ _type: 'span', text: 'è¬ã®è‡ªè²©æ©Ÿã®æ­£ä½“ã¨è²©å£²å•†å“', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'mystery-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã“ã®è¬ã®è‡ªè²©æ©Ÿã®æ­£ä½“ã¯ã€åœ°å…ƒã®ç‰¹ç”£å“ã‚„é™å®šã‚°ãƒƒã‚ºã‚’è²©å£²ã™ã‚‹ç‰¹åˆ¥ãªè‡ªå‹•è²©å£²æ©Ÿã§ã™ã€‚ä¸€èˆ¬çš„ãªé£²ã¿ç‰©ã‚„ãŠè“å­ã®è‡ªè²©æ©Ÿã¨ã¯ç•°ãªã‚Šã€å®‡å¥ˆæœˆæ¸©æ³‰ã‚„é»’éƒ¨å³¡è°·ã«ã¡ãªã‚“ã ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå•†å“ãŒä¸¦ã‚“ã§ã„ã¾ã™ã€‚æ¸©æ³‰ã¾ã‚“ã˜ã‚…ã†ã‚„åœ°å…ƒã®éŠ˜è“ã€é»’éƒ¨å³¡è°·é‰„é“ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚°ãƒƒã‚ºãªã©ã€ã“ã“ã§ã—ã‹æ‰‹ã«å…¥ã‚‰ãªã„è²´é‡ãªã‚¢ã‚¤ãƒ†ãƒ ãŒè²©å£²ã•ã‚Œã¦ã„ã¾ã™ã€‚è¦³å…‰å®¢ã«ã¨ã£ã¦ã¯ã‚µãƒ—ãƒ©ã‚¤ã‚ºãªå‡ºä¼šã„ã¨ãªã‚Šã€æ—…ã®è¨˜å¿µå“ã¨ã—ã¦äººæ°—ã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚ä½•ãŒå£²ã‚‰ã‚Œã¦ã„ã‚‹ã‹ã¯å®Ÿéš›ã«è¦‹ã¦ã¿ãªã„ã¨åˆ†ã‹ã‚‰ãªã„ãƒ¯ã‚¯ãƒ¯ã‚¯æ„Ÿã‚‚ã€ã“ã®è‡ªè²©æ©Ÿã®å¤§ããªé­…åŠ›ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åœ°åŸŸå¯†ç€ã®å–ã‚Šçµ„ã¿ï¼ˆç´„155æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-local',
        style: 'h2',
        children: [{ _type: 'span', text: 'åœ°åŸŸã¨è¦³å…‰å®¢ã‚’çµã¶ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå–ã‚Šçµ„ã¿', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'local-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'ã“ã®è‡ªè²©æ©Ÿã¯å˜ãªã‚‹å•†å“è²©å£²æ©Ÿå™¨ã§ã¯ãªãã€åœ°åŸŸã®é­…åŠ›ã‚’ä¼ãˆã‚‹é‡è¦ãªå½¹å‰²ã‚’æ‹…ã£ã¦ã„ã¾ã™ã€‚åœ°å…ƒã®è·äººãŒä½œã£ãŸæ‰‹ä½œã‚Šå•†å“ã‚„ã€é»’éƒ¨ã®è‡ªç„¶ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸé™å®šã‚¢ã‚¤ãƒ†ãƒ ãªã©ã‚’é€šã˜ã¦ã€è¨ªã‚Œã‚‹äººã€…ã«å®‡å¥ˆæœˆã®æ–‡åŒ–ã¨ä¼çµ±ã‚’ç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€å­£ç¯€ã”ã¨ã«è²©å£²å•†å“ãŒå¤‰ã‚ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã€ä½•åº¦è¨ªã‚Œã¦ã‚‚æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚åœ°åŸŸã®ç”Ÿç”£è€…ã«ã¨ã£ã¦ã‚‚ã€è¦³å…‰å®¢ã«ç›´æ¥å•†å“ã‚’ã‚¢ãƒ”ãƒ¼ãƒ«ã§ãã‚‹è²´é‡ãªè²©å£²ãƒãƒ£ãƒãƒ«ã¨ãªã£ã¦ãŠã‚Šã€åœ°åŸŸçµŒæ¸ˆã®æ´»æ€§åŒ–ã«ã‚‚è²¢çŒ®ã—ã¦ã„ã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: é»’éƒ¨å³¡è°·è¦³å…‰ã¨ã®ç›¸ä¹—åŠ¹æœï¼ˆç´„140æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tourism',
        style: 'h2',
        children: [{ _type: 'span', text: 'é»’éƒ¨å³¡è°·è¦³å…‰ã‚’ã‚ˆã‚Šæ¥½ã—ãã™ã‚‹å­˜åœ¨', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tourism-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'è¬ã®è‡ªè²©æ©Ÿã¯é»’éƒ¨å³¡è°·è¦³å…‰ã®æ¥½ã—ã¿ã‚’ä¸€å±¤æ·±ã‚ã‚‹å­˜åœ¨ã§ã™ã€‚ãƒˆãƒ­ãƒƒã‚³åˆ—è»Šã®å¾…ã¡æ™‚é–“ã«å¶ç„¶ç™ºè¦‹ã™ã‚‹äººã‚‚å¤šãã€æ—…ã®æ€ã„å‡ºä½œã‚Šã«ä¸€å½¹è²·ã£ã¦ã„ã¾ã™ã€‚è³¼å…¥ã—ãŸå•†å“ã¯å³¡è°·ã®çµ¶æ™¯ã‚’çœºã‚ãªãŒã‚‰å‘³ã‚ã†ã“ã¨ãŒã§ãã€ç‰¹åˆ¥ãªä½“é¨“ã¨ãªã‚Šã¾ã™ã€‚SNSæ˜ ãˆã™ã‚‹ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªè‡ªè²©æ©Ÿã¨ã—ã¦è©±é¡Œã«ã‚‚ãªã£ã¦ãŠã‚Šã€å‹äººã‚„å®¶æ—ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãã£ã‹ã‘ã«ã‚‚ãªã£ã¦ã„ã¾ã™ã€‚é»’éƒ¨å³¡è°·ã®é›„å¤§ãªè‡ªç„¶ã¨å…±ã«ã€ã“ã®å°ã•ãªç™ºè¦‹ã‚‚æ—…ã®é†é†å‘³ã®ä¸€ã¤ã§ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: åˆ©ç”¨ã®ã‚³ãƒ„ã¨æ¥½ã—ã¿æ–¹ï¼ˆç´„130æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-tips',
        style: 'h2',
        children: [{ _type: 'span', text: 'è‡ªè²©æ©Ÿåˆ©ç”¨ã®ã‚³ãƒ„ã¨æ¥½ã—ã¿æ–¹', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'tips-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'è¬ã®è‡ªè²©æ©Ÿã‚’æœ€å¤§é™æ¥½ã—ã‚€ãŸã‚ã®ã‚³ãƒ„ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚ã¾ãšã€å•†å“ã®ãƒ©ã‚¤ãƒ³ãƒŠãƒƒãƒ—ã¯å­£ç¯€ã‚„åœ¨åº«çŠ¶æ³ã«ã‚ˆã‚Šå¤‰ã‚ã‚‹ãŸã‚ã€ä½•åº¦è¨ªã‚Œã¦ã‚‚æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚å°éŠ­ã‚’å¤šã‚ã«ç”¨æ„ã—ã¦ãŠãã¨ã€æ°—ã«ãªã‚‹å•†å“ã‚’è¤‡æ•°è³¼å…¥ã§ãã¾ã™ã€‚ã¾ãŸã€å•†å“ã®èª¬æ˜ã‚’ã‚ˆãèª­ã‚€ã“ã¨ã§ã€åœ°å…ƒã®æ–‡åŒ–ã‚„æ­´å²ã«ã¤ã„ã¦ã‚‚å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚å®¶æ—ã‚„å‹äººã¸ã®ãŠåœŸç”£é¸ã³ã«ã‚‚æœ€é©ã§ã€å®‡å¥ˆæœˆãªã‚‰ã§ã¯ã®ç‰¹åˆ¥ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚', marks: [] }],
        markDefs: []
      },
      
      // H2: ã¾ã¨ã‚ï¼ˆç´„90æ–‡å­—ï¼‰
      {
        _type: 'block',
        _key: 'h2-summary',
        style: 'h2',
        children: [{ _type: 'span', text: 'ã¾ã¨ã‚', marks: [] }],
        markDefs: []
      },
      {
        _type: 'block',
        _key: 'summary-content',
        style: 'normal',
        children: [{ _type: 'span', text: 'å®‡å¥ˆæœˆé§…ã®è¬ã®è‡ªè²©æ©Ÿã¯ã€é»’éƒ¨å³¡è°·è¦³å…‰ã‚’ã‚ˆã‚Šç‰¹åˆ¥ãªã‚‚ã®ã«ã—ã¦ãã‚Œã‚‹éš ã‚ŒãŸã‚¹ãƒãƒƒãƒˆã§ã™ã€‚ãœã²ä¸€åº¦ã€ãã®æ­£ä½“ã‚’ç¢ºã‹ã‚ã«è¨ªã‚Œã¦ã¿ã¦ãã ã•ã„ã€‚', marks: [] }],
        markDefs: []
      }
    ];
    
    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    let newTotalChars = 0;
    expandedContent.forEach(block => {
      if (block._type === 'block' && block.children) {
        const text = block.children.map(child => child.text).join('');
        newTotalChars += text.length;
      }
    });
    
    console.log(`æ–°ã—ã„æ–‡å­—æ•°: ${newTotalChars}æ–‡å­—`);
    console.log('æ–°ã—ã„æ§‹æˆ: H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ');
    
    // è¨˜äº‹ã‚’æ›´æ–°
    await client
      .patch(post._id)
      .set({ body: expandedContent })
      .commit();
    
    console.log('âœ… ç¬¬19è¨˜äº‹ã®æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸ');
    console.log('ğŸ“‹ 179æ–‡å­—â†’' + newTotalChars + 'æ–‡å­—ã«æ‹¡å¼µ');
    console.log('ğŸ—ï¸ H2è¦‹å‡ºã—6å€‹ã®çµ±ä¸€æ§‹é€ ã‚’é©ç”¨');
    
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    await client
      .patch(post._id)
      .set({ _updatedAt: new Date().toISOString() })
      .commit();
    
    console.log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Ÿè¡Œå®Œäº†');
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    throw error;
  }
}

expandNineteenthArticle();